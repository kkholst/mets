<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulation of recurrent events data based on cumulative hazards: Two-stage model — simRecurrentTS • mets</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation of recurrent events data based on cumulative hazards: Two-stage model — simRecurrentTS"><meta name="description" content="Simulation of recurrent events data based on cumulative hazards"><meta property="og:description" content="Simulation of recurrent events data based on cumulative hazards"><meta property="og:image" content="http://kkholst.github.io/mets/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/basic-dutils.html">dUtility data-frame manipulations</a></li>
    <li><a class="dropdown-item" href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a></li>
    <li><a class="dropdown-item" href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a></li>
    <li><a class="dropdown-item" href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/binreg-TRS.html">Two-Stage Randomization for for Competing risks and Survival outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/binreg.html">Binomial Regression for Survival and Competing Risks Data</a></li>
    <li><a class="dropdown-item" href="../articles/cifreg.html">Cumulative Incidence Regression</a></li>
    <li><a class="dropdown-item" href="../articles/cooking-survival-data.html">WIP: Cooking survival data, 5 minute recipes</a></li>
    <li><a class="dropdown-item" href="../articles/glm-utility.html">GEE cluster standard errors and predictions for glm objects</a></li>
    <li><a class="dropdown-item" href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a></li>
    <li><a class="dropdown-item" href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a></li>
    <li><a class="dropdown-item" href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a></li>
    <li><a class="dropdown-item" href="../articles/mediation-survival.html">Mediation Analysis for survival data</a></li>
    <li><a class="dropdown-item" href="../articles/phreg_rct.html">Randomization for Cox Type rate models </a></li>
    <li><a class="dropdown-item" href="../articles/quantitative-twin.html">Twin models</a></li>
    <li><a class="dropdown-item" href="../articles/recurrent-events.html">Recurrent events</a></li>
    <li><a class="dropdown-item" href="../articles/rmst-ate.html">Average treatment effect (ATE) for Restricted mean survival and years lost of Competing risks</a></li>
    <li><a class="dropdown-item" href="../articles/survival-ate.html">G-Computation or standardization for the Cox, Fine-Gray and binomial regression models for survival data</a></li>
    <li><a class="dropdown-item" href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a></li>
    <li><a class="dropdown-item" href="../articles/twostage-survival.html">Analysis of multivariate survival data</a></li>
    <li><a class="dropdown-item" href="../articles/while-alive.html">While Alive estimands for Recurrent Events</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kkholst/mets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simulation of recurrent events data based on cumulative hazards: Two-stage model</h1>
      <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/main/R/recurrent.marginal.R" class="external-link"><code>R/recurrent.marginal.R</code></a></small>
      <div class="d-none name"><code>simRecurrentTS.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulation of recurrent events data based on cumulative hazards</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simRecurrentTS</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">cumhaz</span>,</span>
<span>  <span class="va">cumhaz2</span>,</span>
<span>  death.cumhaz <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  share1 <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  vargamD <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  vargam12 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  gap.time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max.recurrent <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  cens <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>number of id's</p></dd>


<dt id="arg-cumhaz">cumhaz<a class="anchor" aria-label="anchor" href="#arg-cumhaz"></a></dt>
<dd><p>cumulative hazard of recurrent events</p></dd>


<dt id="arg-cumhaz-">cumhaz2<a class="anchor" aria-label="anchor" href="#arg-cumhaz-"></a></dt>
<dd><p>cumulative hazard of recurrent events  of type 2</p></dd>


<dt id="arg-death-cumhaz">death.cumhaz<a class="anchor" aria-label="anchor" href="#arg-death-cumhaz"></a></dt>
<dd><p>cumulative hazard of death</p></dd>


<dt id="arg-nu">nu<a class="anchor" aria-label="anchor" href="#arg-nu"></a></dt>
<dd><p>powers of random effects where nu &gt; -1/shape</p></dd>


<dt id="arg-share-">share1<a class="anchor" aria-label="anchor" href="#arg-share-"></a></dt>
<dd><p>how random effect for death splits into two parts</p></dd>


<dt id="arg-vargamd">vargamD<a class="anchor" aria-label="anchor" href="#arg-vargamd"></a></dt>
<dd><p>variance of random effect  for death</p></dd>


<dt id="arg-vargam-">vargam12<a class="anchor" aria-label="anchor" href="#arg-vargam-"></a></dt>
<dd><p>shared random effect for N1 and N2</p></dd>


<dt id="arg-gap-time">gap.time<a class="anchor" aria-label="anchor" href="#arg-gap-time"></a></dt>
<dd><p>if true simulates gap-times with specified cumulative hazard</p></dd>


<dt id="arg-max-recurrent">max.recurrent<a class="anchor" aria-label="anchor" href="#arg-max-recurrent"></a></dt>
<dd><p>limits number recurrent events to 100</p></dd>


<dt id="arg-cens">cens<a class="anchor" aria-label="anchor" href="#arg-cens"></a></dt>
<dd><p>rate of censoring exponential distribution</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to lower level funtions</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Model is constructed such that marginals are on specified form by linear approximations
of cumulative hazards that are on a specific form to make them equivalent to marginals
after integrating out over survivors. Therefore E(dN_1 | D&gt;t) = cumhaz,
E(dN_2 | D&gt;t) = cumhaz2,  and hazard of death is death.cumhazard</p>
<p>Must give hazard of death and two recurrent events.  Hazard of death is death.cumhazard  two
event types and their dependence can be specified but the two recurrent events need
to share random effect.</p>
<p>Random effect for  death Z.death=(Zd1+Zd2), Z1=(Zd1^nu1) Z12,  Z2=(Zd2^nu2) Z12^nu3
$$Z.death=Zd1+Zd2$$  gamma distributions
$$Zdj$$  gamma distribution  with mean parameters (sharej), vargamD,  share2=1-share1
$$Z12$$  gamma distribution with mean 1 and variance vargam12</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Scheike</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">########################################</span></span></span>
<span class="r-in"><span><span class="co">## getting some rates to mimick </span></span></span>
<span class="r-in"><span><span class="co">########################################</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">CPH_HPN_CRBSI</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="va">CPH_HPN_CRBSI</span><span class="op">$</span><span class="va">terminal</span></span></span>
<span class="r-in"><span><span class="va">base1</span> <span class="op">&lt;-</span> <span class="va">CPH_HPN_CRBSI</span><span class="op">$</span><span class="va">crbsi</span> </span></span>
<span class="r-in"><span><span class="va">base4</span> <span class="op">&lt;-</span> <span class="va">CPH_HPN_CRBSI</span><span class="op">$</span><span class="va">mechanical</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu">simRecurrentTS</span><span class="op">(</span><span class="fl">1000</span>,<span class="va">base1</span>,<span class="va">base4</span>,death.cumhaz<span class="op">=</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dtable.html">dtable</a></span><span class="op">(</span><span class="va">rr</span>,<span class="op">~</span><span class="va">death</span><span class="op">+</span><span class="va">status</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       status    0    1    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> death                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0             138 2394  384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             861    0    0</span>
<span class="r-in"><span><span class="fu"><a href="simRecurrentII.html">showfitsim</a></span><span class="op">(</span>causes<span class="op">=</span><span class="fl">2</span>,<span class="va">rr</span>,<span class="va">dr</span>,<span class="va">base1</span>,<span class="va">base4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="simRecurrentTS-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="simRecurrentTS-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>


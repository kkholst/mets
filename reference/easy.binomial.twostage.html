<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fits two-stage binomial for describing depdendence in binomial data
using marginals that are on logistic form using the binomial.twostage funcion, but
call is different and easier and the data manipulation is build into the function.
Useful in particular for family design data. — easy.binomial.twostage • mets</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fits two-stage binomial for describing depdendence in binomial data
using marginals that are on logistic form using the binomial.twostage funcion, but
call is different and easier and the data manipulation is build into the function.
Useful in particular for family design data. — easy.binomial.twostage" />
<meta property="og:description" content="If clusters contain more than two times, the algoritm uses a compososite likelihood
based on the pairwise bivariate models." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a>
    </li>
    <li>
      <a href="../articles/binreg.html">Binomial Regression</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kkholst/mets/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fits two-stage binomial for describing depdendence in binomial data
using marginals that are on logistic form using the binomial.twostage funcion, but
call is different and easier and the data manipulation is build into the function.
Useful in particular for family design data.</h1>
    <small class="dont-index">Source: <a href='https://github.com/kkholst/mets/blob/master/R/binomial.twostage.R'><code>R/binomial.twostage.R</code></a></small>
    <div class="hidden name"><code>easy.binomial.twostage.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>If clusters contain more than two times, the algoritm uses a compososite likelihood
based on the pairwise bivariate models.</p>
    </div>

    <pre class="usage"><span class='fu'>easy.binomial.twostage</span><span class='op'>(</span>
  margbin <span class='op'>=</span> <span class='cn'>NULL</span>,
  data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame</a></span><span class='op'>(</span><span class='op'>)</span>,
  method <span class='op'>=</span> <span class='st'>"nr"</span>,
  response <span class='op'>=</span> <span class='st'>"response"</span>,
  id <span class='op'>=</span> <span class='st'>"id"</span>,
  Nit <span class='op'>=</span> <span class='fl'>60</span>,
  detail <span class='op'>=</span> <span class='fl'>0</span>,
  silent <span class='op'>=</span> <span class='fl'>1</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  theta <span class='op'>=</span> <span class='cn'>NULL</span>,
  theta.formula <span class='op'>=</span> <span class='cn'>NULL</span>,
  desnames <span class='op'>=</span> <span class='cn'>NULL</span>,
  deshelp <span class='op'>=</span> <span class='fl'>0</span>,
  var.link <span class='op'>=</span> <span class='fl'>1</span>,
  iid <span class='op'>=</span> <span class='fl'>1</span>,
  step <span class='op'>=</span> <span class='fl'>1</span>,
  model <span class='op'>=</span> <span class='st'>"plackett"</span>,
  marginal.p <span class='op'>=</span> <span class='cn'>NULL</span>,
  strata <span class='op'>=</span> <span class='cn'>NULL</span>,
  max.clust <span class='op'>=</span> <span class='cn'>NULL</span>,
  se.clusters <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>margbin</th>
      <td><p>Marginal binomial model</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data frame</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Scoring method</p></td>
    </tr>
    <tr>
      <th>response</th>
      <td><p>name of response variable in data frame</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>name of cluster variable in data frame</p></td>
    </tr>
    <tr>
      <th>Nit</th>
      <td><p>Number of iterations</p></td>
    </tr>
    <tr>
      <th>detail</th>
      <td><p>Detail for more output for iterations</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>Debug information</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Weights for log-likelihood, can be used for each type of outcome in 2x2 tables.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>Optimization arguments</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>Starting values for variance components</p></td>
    </tr>
    <tr>
      <th>theta.formula</th>
      <td><p>design for depedence, either formula or design function</p></td>
    </tr>
    <tr>
      <th>desnames</th>
      <td><p>names for dependence parameters</p></td>
    </tr>
    <tr>
      <th>deshelp</th>
      <td><p>if 1 then prints out some data sets that are used, on on which the design function operates</p></td>
    </tr>
    <tr>
      <th>var.link</th>
      <td><p>Link function for variance</p></td>
    </tr>
    <tr>
      <th>iid</th>
      <td><p>Calculate i.i.d. decomposition</p></td>
    </tr>
    <tr>
      <th>step</th>
      <td><p>Step size</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>model</p></td>
    </tr>
    <tr>
      <th>marginal.p</th>
      <td><p>vector of marginal probabilities</p></td>
    </tr>
    <tr>
      <th>strata</th>
      <td><p>strata for fitting</p></td>
    </tr>
    <tr>
      <th>max.clust</th>
      <td><p>max clusters used for i.i.d. decompostion</p></td>
    </tr>
    <tr>
      <th>se.clusters</th>
      <td><p>clusters for iid decomposition for roubst standard errors</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The reported standard errors are based on the estimated information from the
likelihood assuming that the marginals are known. This gives correct standard errors
in the case of the plackett distribution (OR model for dependence), but incorrect for
the clayton-oakes types model. The OR model is often known as the ALR model.
Our fitting procedures gives correct standard errors due to the ortogonality and is
fast.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>twinstut</span><span class='op'>)</span>
<span class='va'>twinstut0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>twinstut</span>, <span class='va'>tvparnr</span><span class='op'>&lt;</span><span class='fl'>10000</span><span class='op'>)</span>
<span class='va'>twinstut</span> <span class='op'>&lt;-</span> <span class='va'>twinstut0</span>
<span class='va'>twinstut</span><span class='op'>$</span><span class='va'>binstut</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>twinstut</span><span class='op'>$</span><span class='va'>stutter</span><span class='op'>==</span><span class='st'>"yes"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
<span class='va'>theta.des</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span> <span class='op'>~</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>zyg</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>twinstut</span><span class='op'>)</span>
<span class='va'>margbin</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>binstut</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sex</span><span class='op'>)</span><span class='op'>+</span><span class='va'>age</span>,data<span class='op'>=</span><span class='va'>twinstut</span>,family<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>bin</span> <span class='op'>&lt;-</span> <span class='fu'><a href='binomial.twostage.html'>binomial.twostage</a></span><span class='op'>(</span><span class='va'>margbin</span>,data<span class='op'>=</span><span class='va'>twinstut</span>,var.link<span class='op'>=</span><span class='fl'>1</span>,
             clusters<span class='op'>=</span><span class='va'>twinstut</span><span class='op'>$</span><span class='va'>tvparnr</span>,theta.des<span class='op'>=</span><span class='va'>theta.des</span>,detail<span class='op'>=</span><span class='fl'>0</span>,
                   method<span class='op'>=</span><span class='st'>"nr"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>bin</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Dependence parameter for Odds-Ratio (Plackett) model 
#&gt; With log-link </div><div class='output co'>#&gt; $estimates
#&gt;                   theta        se
#&gt; factor(zyg)dz 0.4592786 0.3724594
#&gt; factor(zyg)mz 3.3313275 0.3219407
#&gt; factor(zyg)os 0.5097220 0.4815677
#&gt; 
#&gt; $or
#&gt;               Estimate Std.Err     2.5%  97.5%  P-value
#&gt; factor(zyg)dz    1.583  0.5896  0.42738  2.738 0.007256
#&gt; factor(zyg)mz   27.975  9.0064 10.32316 45.628 0.001895
#&gt; factor(zyg)os    1.665  0.8017  0.09347  3.236 0.037843
#&gt; 
#&gt; $type
#&gt; [1] "plackett"
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "summary.mets.twostage"</div><div class='input'><span class='fu'>lava</span><span class='fu'>::</span><span class='fu'><a href='https://kkholst.github.io/lava/reference/estimate.default.html'>estimate</a></span><span class='op'>(</span>coef<span class='op'>=</span><span class='va'>bin</span><span class='op'>$</span><span class='va'>theta</span>,vcov<span class='op'>=</span><span class='va'>bin</span><span class='op'>$</span><span class='va'>var.theta</span>,f<span class='op'>=</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      Estimate Std.Err     2.5%  97.5%  P-value
#&gt; NA      1.583  0.5896  0.42738  2.738 0.007256
#&gt; NA.1   27.975  9.0064 10.32316 45.628 0.001895
#&gt; NA.2    1.665  0.8017  0.09347  3.236 0.037843</div><div class='input'>
<span class='va'>twinstut</span><span class='op'>$</span><span class='va'>cage</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>twinstut</span><span class='op'>$</span><span class='va'>age</span><span class='op'>)</span>
<span class='va'>theta.des</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span> <span class='op'>~</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>zyg</span><span class='op'>)</span><span class='op'>+</span><span class='va'>cage</span>,data<span class='op'>=</span><span class='va'>twinstut</span><span class='op'>)</span>
<span class='va'>bina</span> <span class='op'>&lt;-</span> <span class='fu'><a href='binomial.twostage.html'>binomial.twostage</a></span><span class='op'>(</span><span class='va'>margbin</span>,data<span class='op'>=</span><span class='va'>twinstut</span>,var.link<span class='op'>=</span><span class='fl'>1</span>,
             clusters<span class='op'>=</span><span class='va'>twinstut</span><span class='op'>$</span><span class='va'>tvparnr</span>,theta.des<span class='op'>=</span><span class='va'>theta.des</span>,detail<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>bina</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Dependence parameter for Odds-Ratio (Plackett) model 
#&gt; With log-link </div><div class='output co'>#&gt; $estimates
#&gt;                   theta        se
#&gt; factor(zyg)dz 0.5059022 0.3880797
#&gt; factor(zyg)mz 3.3650106 0.3263683
#&gt; factor(zyg)os 0.5070644 0.4882211
#&gt; cage          0.1501763 0.2551689
#&gt; 
#&gt; $or
#&gt;               Estimate Std.Err     2.5%  97.5%   P-value
#&gt; factor(zyg)dz    1.658  0.6436  0.39700  2.920 9.972e-03
#&gt; factor(zyg)mz   28.934  9.4431 10.42572 47.442 2.184e-03
#&gt; factor(zyg)os    1.660  0.8106  0.07157  3.249 4.054e-02
#&gt; cage             1.162  0.2965  0.58088  1.743 8.893e-05
#&gt; 
#&gt; $type
#&gt; [1] "plackett"
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "summary.mets.twostage"</div><div class='input'>
<span class='va'>theta.des</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span> <span class='op'>~</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>zyg</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>zyg</span><span class='op'>)</span><span class='op'>*</span><span class='va'>cage</span>,data<span class='op'>=</span><span class='va'>twinstut</span><span class='op'>)</span>
<span class='va'>bina</span> <span class='op'>&lt;-</span> <span class='fu'><a href='binomial.twostage.html'>binomial.twostage</a></span><span class='op'>(</span><span class='va'>margbin</span>,data<span class='op'>=</span><span class='va'>twinstut</span>,var.link<span class='op'>=</span><span class='fl'>1</span>,
             clusters<span class='op'>=</span><span class='va'>twinstut</span><span class='op'>$</span><span class='va'>tvparnr</span>,theta.des<span class='op'>=</span><span class='va'>theta.des</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>bina</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Dependence parameter for Odds-Ratio (Plackett) model 
#&gt; With log-link </div><div class='output co'>#&gt; $estimates
#&gt;                         theta        se
#&gt; factor(zyg)dz       0.3037310 0.4586524
#&gt; factor(zyg)mz       3.4143434 0.3301659
#&gt; factor(zyg)os       0.4804629 0.5073920
#&gt; cage               -0.3547975 0.5124653
#&gt; factor(zyg)mz:cage  0.7245451 0.6254771
#&gt; factor(zyg)os:cage  0.6798778 0.7714539
#&gt; 
#&gt; $or
#&gt;                    Estimate Std.Err      2.5%  97.5%  P-value
#&gt; factor(zyg)dz        1.3549  0.6214  0.136924  2.573 0.029235
#&gt; factor(zyg)mz       30.3970 10.0360 10.726691 50.067 0.002455
#&gt; factor(zyg)os        1.6168  0.8204  0.008941  3.225 0.048740
#&gt; cage                 0.7013  0.3594 -0.003095  1.406 0.051015
#&gt; factor(zyg)mz:cage   2.0638  1.2909 -0.466236  4.594 0.109870
#&gt; factor(zyg)os:cage   1.9736  1.5226 -1.010545  4.958 0.194888
#&gt; 
#&gt; $type
#&gt; [1] "plackett"
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "summary.mets.twostage"</div><div class='input'>
<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'>easy.binomial.twostage</span><span class='op'>(</span><span class='va'>stutter</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sex</span><span class='op'>)</span><span class='op'>+</span><span class='va'>age</span>,data<span class='op'>=</span><span class='va'>twinstut</span>,
                              response<span class='op'>=</span><span class='st'>"binstut"</span>,id<span class='op'>=</span><span class='st'>"tvparnr"</span>,var.link<span class='op'>=</span><span class='fl'>1</span>,
                theta.formula<span class='op'>=</span><span class='op'>~</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>zyg1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Dependence parameter for Odds-Ratio (Plackett) model 
#&gt; With log-link </div><div class='output co'>#&gt; $estimates
#&gt;                    theta        se
#&gt; factor(zyg1)dz 0.4592786 0.3724594
#&gt; factor(zyg1)mz 3.3313275 0.3219407
#&gt; factor(zyg1)os 0.5097220 0.4815677
#&gt; 
#&gt; $or
#&gt;                Estimate Std.Err     2.5%  97.5%  P-value
#&gt; factor(zyg1)dz    1.583  0.5896  0.42738  2.738 0.007256
#&gt; factor(zyg1)mz   27.975  9.0064 10.32316 45.628 0.001895
#&gt; factor(zyg1)os    1.665  0.8017  0.09347  3.236 0.037843
#&gt; 
#&gt; $type
#&gt; [1] "plackett"
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "summary.mets.twostage"</div><div class='input'>
<span class='co'>## refers to zygosity of first subject in eash pair : zyg1</span>
<span class='co'>## could also use zyg2 (since zyg2=zyg1 within twinpair's))</span>
<span class='va'>desfs</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>num1</span><span class='op'>=</span><span class='st'>"zyg1"</span>,<span class='va'>namesdes</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mz"</span>,<span class='st'>"dz"</span>,<span class='st'>"os"</span><span class='op'>)</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"mz"</span>,<span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"dz"</span>,<span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"os"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>

<span class='va'>out3</span> <span class='op'>&lt;-</span> <span class='fu'>easy.binomial.twostage</span><span class='op'>(</span><span class='va'>binstut</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sex</span><span class='op'>)</span><span class='op'>+</span><span class='va'>age</span>,
                               data<span class='op'>=</span><span class='va'>twinstut</span>, response<span class='op'>=</span><span class='st'>"binstut"</span>,id<span class='op'>=</span><span class='st'>"tvparnr"</span>,
                               var.link<span class='op'>=</span><span class='fl'>1</span>,theta.formula<span class='op'>=</span><span class='va'>desfs</span>,
                               desnames<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mz"</span>,<span class='st'>"dz"</span>,<span class='st'>"os"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>out3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Dependence parameter for Odds-Ratio (Plackett) model 
#&gt; With log-link </div><div class='output co'>#&gt; $estimates
#&gt;        theta        se
#&gt; mz 3.3313275 0.3219407
#&gt; dz 0.4592786 0.3724594
#&gt; os 0.5097220 0.4815677
#&gt; 
#&gt; $or
#&gt;    Estimate Std.Err     2.5%  97.5%  P-value
#&gt; mz   27.975  9.0064 10.32316 45.628 0.001895
#&gt; dz    1.583  0.5896  0.42738  2.738 0.007256
#&gt; os    1.665  0.8017  0.09347  3.236 0.037843
#&gt; 
#&gt; $type
#&gt; [1] "plackett"
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "summary.mets.twostage"</div><div class='input'>
 <span class='co'>## Reduce Ex.Timings</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>5000</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>dd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='npc.html'>simBinFam</a></span><span class='op'>(</span><span class='va'>n</span>,beta<span class='op'>=</span><span class='fl'>0.3</span><span class='op'>)</span>
<span class='va'>binfam</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fast.reshape.html'>fast.reshape</a></span><span class='op'>(</span><span class='va'>dd</span>,varying<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"age"</span>,<span class='st'>"x"</span>,<span class='st'>"y"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>## mother, father, children  (ordered)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>binfam</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   id      age x y num
#&gt; 1  1 29.10523 0 1   m
#&gt; 2  1 29.41385 0 1   f
#&gt; 3  1 11.03423 1 1  b1
#&gt; 4  1 13.72128 1 1  b2
#&gt; 5  2 24.19918 0 1   m
#&gt; 6  2 26.54858 1 1   f</div><div class='input'>
<span class='co'>########### ########### ########### ########### ########### ###########</span>
<span class='co'>####  simple analyses of binomial family data</span>
<span class='co'>########### ########### ########### ########### ########### ###########</span>
<span class='va'>desfs</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>num1</span><span class='op'>=</span><span class='st'>"num1"</span>,<span class='va'>num2</span><span class='op'>=</span><span class='st'>"num2"</span><span class='op'>)</span>
<span class='op'>{</span>
     <span class='va'>pp</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>*</span><span class='op'>(</span><span class='op'>(</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"m"</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"f"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>|</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"f"</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"m"</span><span class='op'>)</span><span class='op'>)</span>
     <span class='va'>pc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"m"</span> <span class='op'>|</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"f"</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b1"</span> <span class='op'>|</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b2"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
     <span class='va'>cc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b1"</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b1"</span> <span class='op'>|</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b2"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
     <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>pp</span>,<span class='va'>pc</span>,<span class='va'>cc</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>ud</span> <span class='op'>&lt;-</span> <span class='fu'>easy.binomial.twostage</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='op'>+</span><span class='fl'>1</span>,data<span class='op'>=</span><span class='va'>binfam</span>,
     response<span class='op'>=</span><span class='st'>"y"</span>,id<span class='op'>=</span><span class='st'>"id"</span>,
     theta.formula<span class='op'>=</span><span class='va'>desfs</span>,desnames<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pp"</span>,<span class='st'>"pc"</span>,<span class='st'>"cc"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ud</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Dependence parameter for Odds-Ratio (Plackett) model 
#&gt; With log-link </div><div class='output co'>#&gt; $estimates
#&gt;          theta         se
#&gt; pp -0.03760497 0.11475447
#&gt; pc  0.40400558 0.05108072
#&gt; cc  0.72782925 0.09233881
#&gt; 
#&gt; $or
#&gt;    Estimate Std.Err   2.5% 97.5%   P-value
#&gt; pp   0.9631 0.11052 0.7465 1.180 2.927e-18
#&gt; pc   1.4978 0.07651 1.3479 1.648 2.436e-85
#&gt; cc   2.0706 0.19119 1.6958 2.445 2.490e-27
#&gt; 
#&gt; $type
#&gt; [1] "plackett"
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "summary.mets.twostage"</div><div class='input'>
<span class='va'>udx</span> <span class='op'>&lt;-</span> <span class='fu'>easy.binomial.twostage</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='op'>+</span><span class='va'>x</span>,data<span class='op'>=</span><span class='va'>binfam</span>,
     response<span class='op'>=</span><span class='st'>"y"</span>,id<span class='op'>=</span><span class='st'>"id"</span>,
     theta.formula<span class='op'>=</span><span class='va'>desfs</span>,desnames<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pp"</span>,<span class='st'>"pc"</span>,<span class='st'>"cc"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>udx</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Dependence parameter for Odds-Ratio (Plackett) model 
#&gt; With log-link </div><div class='output co'>#&gt; $estimates
#&gt;          theta         se
#&gt; pp -0.04739133 0.11503577
#&gt; pc  0.40679702 0.05124946
#&gt; cc  0.73709599 0.09257276
#&gt; 
#&gt; $or
#&gt;    Estimate Std.Err   2.5% 97.5%   P-value
#&gt; pp   0.9537 0.10971 0.7387 1.169 3.532e-18
#&gt; pc   1.5020 0.07698 1.3511 1.653 8.614e-85
#&gt; cc   2.0899 0.19346 1.7107 2.469 3.356e-27
#&gt; 
#&gt; $type
#&gt; [1] "plackett"
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "summary.mets.twostage"</div><div class='input'>
<span class='co'>########### ########### ########### ########### ########### ###########</span>
<span class='co'>####  now allowing parent child POR to be different for mother and father</span>
<span class='co'>########### ########### ########### ########### ########### ###########</span>

<span class='va'>desfsi</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>num1</span><span class='op'>=</span><span class='st'>"num1"</span>,<span class='va'>num2</span><span class='op'>=</span><span class='st'>"num2"</span><span class='op'>)</span>
<span class='op'>{</span>
    <span class='va'>pp</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"m"</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"f"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
    <span class='va'>mc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"m"</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b1"</span> <span class='op'>|</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b2"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
    <span class='va'>fc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"f"</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b1"</span> <span class='op'>|</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b2"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
    <span class='va'>cc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b1"</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b1"</span> <span class='op'>|</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b2"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>pp</span>,<span class='va'>mc</span>,<span class='va'>fc</span>,<span class='va'>cc</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>udi</span> <span class='op'>&lt;-</span> <span class='fu'>easy.binomial.twostage</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='op'>+</span><span class='fl'>1</span>,data<span class='op'>=</span><span class='va'>binfam</span>,
     response<span class='op'>=</span><span class='st'>"y"</span>,id<span class='op'>=</span><span class='st'>"id"</span>,
     theta.formula<span class='op'>=</span><span class='va'>desfsi</span>,desnames<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pp"</span>,<span class='st'>"mother-child"</span>,<span class='st'>"father-child"</span>,<span class='st'>"cc"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>udi</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Dependence parameter for Odds-Ratio (Plackett) model 
#&gt; With log-link </div><div class='output co'>#&gt; $estimates
#&gt;                    theta         se
#&gt; pp           -0.03760497 0.11475447
#&gt; mother-child  0.61962950 0.07061574
#&gt; father-child  0.16483867 0.07637147
#&gt; cc            0.72782925 0.09233881
#&gt; 
#&gt; $or
#&gt;              Estimate Std.Err   2.5% 97.5%   P-value
#&gt; pp             0.9631 0.11052 0.7465 1.180 2.927e-18
#&gt; mother-child   1.8582 0.13122 1.6011 2.115 1.594e-45
#&gt; father-child   1.1792 0.09006 1.0027 1.356 3.568e-39
#&gt; cc             2.0706 0.19119 1.6958 2.445 2.490e-27
#&gt; 
#&gt; $type
#&gt; [1] "plackett"
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "summary.mets.twostage"</div><div class='input'>
<span class='co'>##now looking to see if interactions with age or age influences marginal models</span>
<span class='co'>##converting factors to numeric to make all involved covariates numeric</span>
<span class='co'>##to use desfai2 rather then desfai that works on binfam</span>

<span class='va'>nbinfam</span> <span class='op'>&lt;-</span> <span class='va'>binfam</span>
<span class='va'>nbinfam</span><span class='op'>$</span><span class='va'>num</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>binfam</span><span class='op'>$</span><span class='va'>num</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>nbinfam</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   id      age x y num
#&gt; 1  1 29.10523 0 1   1
#&gt; 2  1 29.41385 0 1   2
#&gt; 3  1 11.03423 1 1   3
#&gt; 4  1 13.72128 1 1   4
#&gt; 5  2 24.19918 0 1   1
#&gt; 6  2 26.54858 1 1   2</div><div class='input'>
<span class='va'>desfsai</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>num1</span><span class='op'>=</span><span class='st'>"num1"</span>,<span class='va'>num2</span><span class='op'>=</span><span class='st'>"num2"</span><span class='op'>)</span>
<span class='op'>{</span>
    <span class='va'>pp</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"m"</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"f"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
<span class='co'>### av age for pp=1 i.e parent pairs</span>
    <span class='va'>agepp</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='st'>"age1"</span><span class='op'>]</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='st'>"age2"</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>-</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>*</span><span class='va'>pp</span>
    <span class='va'>mc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"m"</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b1"</span> <span class='op'>|</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b2"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
    <span class='va'>fc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"f"</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b1"</span> <span class='op'>|</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b2"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
    <span class='va'>cc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b1"</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b1"</span> <span class='op'>|</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='st'>"b2"</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
    <span class='va'>agecc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='st'>"age1"</span><span class='op'>]</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='st'>"age2"</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>-</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>*</span><span class='va'>cc</span>
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>pp</span>,<span class='va'>agepp</span>,<span class='va'>mc</span>,<span class='va'>fc</span>,<span class='va'>cc</span>,<span class='va'>agecc</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>desfsai2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>num1</span><span class='op'>=</span><span class='st'>"num1"</span>,<span class='va'>num2</span><span class='op'>=</span><span class='st'>"num2"</span><span class='op'>)</span>
<span class='op'>{</span>
    <span class='va'>pp</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
    <span class='va'>agepp</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>(</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='st'>"age1"</span><span class='op'>]</span><span class='op'>+</span><span class='va'>x</span><span class='op'>[</span><span class='st'>"age2"</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>-</span><span class='fl'>30</span><span class='op'>)</span><span class='op'>*</span><span class='va'>pp</span> <span class='co'>### av age for pp=1 i.e parent pairs</span>
    <span class='va'>mc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>3</span> <span class='op'>|</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
    <span class='va'>fc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>3</span> <span class='op'>|</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
    <span class='va'>cc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num1</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>3</span> <span class='op'>|</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>num2</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>1</span>
    <span class='va'>agecc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='st'>"age1"</span><span class='op'>]</span><span class='op'>+</span><span class='va'>x</span><span class='op'>[</span><span class='st'>"age2"</span><span class='op'>]</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>-</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>*</span><span class='va'>cc</span> <span class='co'>### av age for children</span>
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>pp</span>,<span class='va'>agepp</span>,<span class='va'>mc</span>,<span class='va'>fc</span>,<span class='va'>cc</span>,<span class='va'>agecc</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>udxai2</span> <span class='op'>&lt;-</span> <span class='fu'>easy.binomial.twostage</span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='op'>+</span><span class='va'>x</span><span class='op'>+</span><span class='va'>age</span>,data<span class='op'>=</span><span class='va'>binfam</span>,
     response<span class='op'>=</span><span class='st'>"y"</span>,id<span class='op'>=</span><span class='st'>"id"</span>,
     theta.formula<span class='op'>=</span><span class='va'>desfsai</span>,
     desnames<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pp"</span>,<span class='st'>"pp-age"</span>,<span class='st'>"mother-child"</span>,<span class='st'>"father-child"</span>,<span class='st'>"cc"</span>,<span class='st'>"cc-age"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>udxai2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Dependence parameter for Odds-Ratio (Plackett) model 
#&gt; With log-link </div><div class='output co'>#&gt; $estimates
#&gt;                      theta         se
#&gt; pp           -0.1347520605 0.17968233
#&gt; pp-age       -0.0235331410 0.03696640
#&gt; mother-child  0.6223360756 0.07091609
#&gt; father-child  0.1698829179 0.07659981
#&gt; cc            0.7368848713 0.09526400
#&gt; cc-age        0.0009801409 0.03213098
#&gt; 
#&gt; $or
#&gt;              Estimate Std.Err   2.5% 97.5%    P-value
#&gt; pp             0.8739 0.15703 0.5662 1.182  2.616e-08
#&gt; pp-age         0.9767 0.03611 0.9060 1.048 3.658e-161
#&gt; mother-child   1.8633 0.13214 1.6043 2.122  3.735e-45
#&gt; father-child   1.1852 0.09078 1.0072 1.363  5.962e-39
#&gt; cc             2.0894 0.19905 1.6993 2.480  8.903e-26
#&gt; cc-age         1.0010 0.03216 0.9379 1.064 1.191e-212
#&gt; 
#&gt; $type
#&gt; [1] "plackett"
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "summary.mets.twostage"</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



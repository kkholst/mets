<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fits two-stage binomial for describing depdendence in binomial data using marginals that are on logistic form using the binomial.twostage funcion, but call is different and easier and the data manipulation is build into the function. Useful in particular for family design data. — easy.binomial.twostage • mets</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fits two-stage binomial for describing depdendence in binomial data using marginals that are on logistic form using the binomial.twostage funcion, but call is different and easier and the data manipulation is build into the function. Useful in particular for family design data. — easy.binomial.twostage"><meta property="og:description" content="If clusters contain more than two times, the algoritm uses a compososite likelihood
based on the pairwise bivariate models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a>
    </li>
    <li>
      <a href="../articles/binreg-TRS.html">Two-Stage Randomization for for Competing risks and Survival outcomes</a>
    </li>
    <li>
      <a href="../articles/binreg.html">Binomial Regression for Survival and Competing Risks Data</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/cooking-survival-data.html">WIP: Cooking survival data, 5 minute recipes</a>
    </li>
    <li>
      <a href="../articles/glm-utility.html">GEE cluster standard errors and predictions for glm objects</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/mediation-survival.html">Mediation Analysis for survival data</a>
    </li>
    <li>
      <a href="../articles/phreg_rct.html">Two-Stage Randomization for Cox Type rate models </a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/rmst-ate.html">Average treatment effect (ATE) for Restricted mean survival and years lost of Competing risks</a>
    </li>
    <li>
      <a href="../articles/survival-ate.html">G-Computation or standardization for the Cox, Fine-Gray and binomial regression models for survival data</a>
    </li>
    <li>
      <a href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
    <li>
      <a href="../articles/while-alive.html">While Alive estimands for Recurrent Events</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kkholst/mets/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fits two-stage binomial for describing depdendence in binomial data using marginals that are on logistic form using the binomial.twostage funcion, but call is different and easier and the data manipulation is build into the function. Useful in particular for family design data.</h1>
    <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/main/R/binomial.twostage.R" class="external-link"><code>R/binomial.twostage.R</code></a></small>
    <div class="hidden name"><code>easy.binomial.twostage.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>If clusters contain more than two times, the algoritm uses a compososite likelihood
based on the pairwise bivariate models.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">easy.binomial.twostage</span><span class="op">(</span></span>
<span>  margbin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"nr"</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  Nit <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  detail <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  silent <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta.formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  desnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  deshelp <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  var.link <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  iid <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"plackett"</span>,</span>
<span>  marginal.p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max.clust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  se.clusters <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-margbin">margbin<a class="anchor" aria-label="anchor" href="#arg-margbin"></a></dt>
<dd><p>Marginal binomial model</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>data frame</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Scoring method</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>name of response variable in data frame</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>name of cluster variable in data frame</p></dd>


<dt id="arg-nit">Nit<a class="anchor" aria-label="anchor" href="#arg-nit"></a></dt>
<dd><p>Number of iterations</p></dd>


<dt id="arg-detail">detail<a class="anchor" aria-label="anchor" href="#arg-detail"></a></dt>
<dd><p>Detail for more output for iterations</p></dd>


<dt id="arg-silent">silent<a class="anchor" aria-label="anchor" href="#arg-silent"></a></dt>
<dd><p>Debug information</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Weights for log-likelihood, can be used for each type of outcome in 2x2 tables.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>Optimization arguments</p></dd>


<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>Starting values for variance components</p></dd>


<dt id="arg-theta-formula">theta.formula<a class="anchor" aria-label="anchor" href="#arg-theta-formula"></a></dt>
<dd><p>design for depedence, either formula or design function</p></dd>


<dt id="arg-desnames">desnames<a class="anchor" aria-label="anchor" href="#arg-desnames"></a></dt>
<dd><p>names for dependence parameters</p></dd>


<dt id="arg-deshelp">deshelp<a class="anchor" aria-label="anchor" href="#arg-deshelp"></a></dt>
<dd><p>if 1 then prints out some data sets that are used, on on which the design function operates</p></dd>


<dt id="arg-var-link">var.link<a class="anchor" aria-label="anchor" href="#arg-var-link"></a></dt>
<dd><p>Link function for variance</p></dd>


<dt id="arg-iid">iid<a class="anchor" aria-label="anchor" href="#arg-iid"></a></dt>
<dd><p>Calculate i.i.d. decomposition</p></dd>


<dt id="arg-step">step<a class="anchor" aria-label="anchor" href="#arg-step"></a></dt>
<dd><p>Step size</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>model</p></dd>


<dt id="arg-marginal-p">marginal.p<a class="anchor" aria-label="anchor" href="#arg-marginal-p"></a></dt>
<dd><p>vector of marginal probabilities</p></dd>


<dt id="arg-strata">strata<a class="anchor" aria-label="anchor" href="#arg-strata"></a></dt>
<dd><p>strata for fitting</p></dd>


<dt id="arg-max-clust">max.clust<a class="anchor" aria-label="anchor" href="#arg-max-clust"></a></dt>
<dd><p>max clusters used for i.i.d. decompostion</p></dd>


<dt id="arg-se-clusters">se.clusters<a class="anchor" aria-label="anchor" href="#arg-se-clusters"></a></dt>
<dd><p>clusters for iid decomposition for roubst standard errors</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The reported standard errors are based on the estimated information from the
likelihood assuming that the marginals are known. This gives correct standard errors
in the case of the plackett distribution (OR model for dependence), but incorrect for
the clayton-oakes types model. The OR model is often known as the ALR model.
Our fitting procedures gives correct standard errors due to the ortogonality and is
fast.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">twinstut</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">twinstut0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">twinstut</span>, <span class="va">tvparnr</span><span class="op">&lt;</span><span class="fl">4000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">twinstut</span> <span class="op">&lt;-</span> <span class="va">twinstut0</span></span></span>
<span class="r-in"><span><span class="va">twinstut</span><span class="op">$</span><span class="va">binstut</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">twinstut</span><span class="op">$</span><span class="va">stutter</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span> <span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span>,data<span class="op">=</span><span class="va">twinstut</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">margbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">binstut</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">+</span><span class="va">age</span>,data<span class="op">=</span><span class="va">twinstut</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">margbin</span>,data<span class="op">=</span><span class="va">twinstut</span>,var.link<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>             clusters<span class="op">=</span><span class="va">twinstut</span><span class="op">$</span><span class="va">tvparnr</span>,theta.des<span class="op">=</span><span class="va">theta.des</span>,detail<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>                   method<span class="op">=</span><span class="st">"nr"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bin</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> With log-link </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    theta        se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)dz -0.2853738 0.9894082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)mz  3.3391390 0.5590195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)os  0.4920396 0.7634939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $or</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std.Err   2.5%  97.5% P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)dz   0.7517  0.7438 -0.706  2.209 0.31216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)mz  28.1948 15.7615 -2.697 59.087 0.07364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)os   1.6356  1.2488 -0.812  4.083 0.19027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "plackett"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "summary.mets.twostage"</span>
<span class="r-in"><span><span class="fu">lava</span><span class="fu">::</span><span class="fu"><a href="https://kkholst.github.io/lava/reference/estimate.default.html" class="external-link">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">bin</span><span class="op">$</span><span class="va">theta</span>,vcov<span class="op">=</span><span class="va">bin</span><span class="op">$</span><span class="va">var.theta</span>,f<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Estimate Std.Err   2.5%  97.5% P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA     0.7517  0.7438 -0.706  2.209 0.31216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA.1  28.1948 15.7615 -2.697 59.087 0.07364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA.2   1.6356  1.2488 -0.812  4.083 0.19027</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">twinstut</span><span class="op">$</span><span class="va">cage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">twinstut</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span> <span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="va">cage</span>,data<span class="op">=</span><span class="va">twinstut</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bina</span> <span class="op">&lt;-</span> <span class="fu"><a href="binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">margbin</span>,data<span class="op">=</span><span class="va">twinstut</span>,var.link<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>             clusters<span class="op">=</span><span class="va">twinstut</span><span class="op">$</span><span class="va">tvparnr</span>,theta.des<span class="op">=</span><span class="va">theta.des</span>,detail<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bina</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> With log-link </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    theta        se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)dz -0.2684851 0.9930894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)mz  3.4239727 0.5773886</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)os  0.4778091 0.7628390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cage           0.2519096 0.4821619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $or</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std.Err     2.5%  97.5% P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)dz   0.7645  0.7593 -0.72357  2.253 0.31395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)mz  30.6911 17.7207 -4.04082 65.423 0.08328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)os   1.6125  1.2301 -0.79843  4.024 0.18989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cage            1.2865  0.6203  0.07073  2.502 0.03808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "plackett"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "summary.mets.twostage"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span> <span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">*</span><span class="va">cage</span>,data<span class="op">=</span><span class="va">twinstut</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bina</span> <span class="op">&lt;-</span> <span class="fu"><a href="binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">margbin</span>,data<span class="op">=</span><span class="va">twinstut</span>,var.link<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>             clusters<span class="op">=</span><span class="va">twinstut</span><span class="op">$</span><span class="va">tvparnr</span>,theta.des<span class="op">=</span><span class="va">theta.des</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bina</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> With log-link </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          theta        se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)dz      -0.27701246 1.0713974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)mz       3.52484148 0.5951743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)os       0.48859941 0.7644050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cage                0.06420907 3.6225641</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)mz:cage  0.49441325 3.6865646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)os:cage -0.12312666 3.6921748</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $or</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Estimate Std.Err     2.5%  97.5% P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)dz        0.7580  0.8122  -0.8338  2.350 0.35063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)mz       33.9484 20.2052  -5.6531 73.550 0.09292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)os        1.6300  1.2460  -0.8121  4.072 0.19080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cage                 1.0663  3.8628  -6.5046  8.637 0.78251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)mz:cage   1.6395  6.0443 -10.2070 13.486 0.78619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)os:cage   0.8842  3.2644  -5.5140  7.282 0.78651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "plackett"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "summary.mets.twostage"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">easy.binomial.twostage</span><span class="op">(</span><span class="va">stutter</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">+</span><span class="va">age</span>,data<span class="op">=</span><span class="va">twinstut</span>,</span></span>
<span class="r-in"><span>                              response<span class="op">=</span><span class="st">"binstut"</span>,id<span class="op">=</span><span class="st">"tvparnr"</span>,var.link<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                theta.formula<span class="op">=</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> With log-link </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     theta        se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg1)dz -0.2853738 0.9894082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg1)mz  3.3391390 0.5590195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg1)os  0.4920396 0.7634939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $or</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Estimate Std.Err   2.5%  97.5% P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg1)dz   0.7517  0.7438 -0.706  2.209 0.31216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg1)mz  28.1948 15.7615 -2.697 59.087 0.07364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg1)os   1.6356  1.2488 -0.812  4.083 0.19027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "plackett"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "summary.mets.twostage"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## refers to zygosity of first subject in eash pair : zyg1</span></span></span>
<span class="r-in"><span><span class="co">## could also use zyg2 (since zyg2=zyg1 within twinpair's))</span></span></span>
<span class="r-in"><span><span class="co">## do not run t save time</span></span></span>
<span class="r-in"><span><span class="co"># desfs &lt;- function(x,num1="zyg1",namesdes=c("mz","dz","os"))</span></span></span>
<span class="r-in"><span><span class="co">#     c(x[num1]=="mz",x[num1]=="dz",x[num1]=="os")*1</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#out3 &lt;- easy.binomial.twostage(binstut~factor(sex)+age,</span></span></span>
<span class="r-in"><span><span class="co">#                               data=twinstut, response="binstut",id="tvparnr",</span></span></span>
<span class="r-in"><span><span class="co">#                               var.link=1,theta.formula=desfs,</span></span></span>
<span class="r-in"><span><span class="co">#                               desnames=c("mz","dz","os"))</span></span></span>
<span class="r-in"><span><span class="co">#summary(out3)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">## Reduce Ex.Timings</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="internal.html">simBinFam</a></span><span class="op">(</span><span class="va">n</span>,beta<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">binfam</span> <span class="op">&lt;-</span> <span class="fu"><a href="fast.reshape.html">fast.reshape</a></span><span class="op">(</span><span class="va">dd</span>,varying<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>,<span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## mother, father, children  (ordered)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">binfam</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id      age x y num</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 26.68147 1 1   m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1 32.93535 0 1   f</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1  9.09635 0 1  b1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1 11.05365 1 1  b2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2 26.06935 1 1   m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2 28.33452 0 1   f</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">########### ########### ########### ########### ########### ###########</span></span></span>
<span class="r-in"><span><span class="co">####  simple analyses of binomial family data</span></span></span>
<span class="r-in"><span><span class="co">########### ########### ########### ########### ########### ###########</span></span></span>
<span class="r-in"><span><span class="va">desfs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">num1</span><span class="op">=</span><span class="st">"num1"</span>,<span class="va">num2</span><span class="op">=</span><span class="st">"num2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="va">pp</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"m"</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"f"</span><span class="op">)</span><span class="op">)</span><span class="op">|</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"f"</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"m"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">pc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"m"</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"f"</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b1"</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b2"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>     <span class="va">cc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"b1"</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b1"</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b2"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pp</span>,<span class="va">pc</span>,<span class="va">cc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ud</span> <span class="op">&lt;-</span> <span class="fu">easy.binomial.twostage</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="op">+</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">binfam</span>,</span></span>
<span class="r-in"><span>     response<span class="op">=</span><span class="st">"y"</span>,id<span class="op">=</span><span class="st">"id"</span>,</span></span>
<span class="r-in"><span>     theta.formula<span class="op">=</span><span class="va">desfs</span>,desnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pp"</span>,<span class="st">"pc"</span>,<span class="st">"cc"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ud</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> With log-link </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        theta        se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pp 0.6561647 0.2508517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pc 0.5022035 0.1393882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cc 0.8892008 0.2124875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $or</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std.Err   2.5% 97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pp    1.927  0.4835 0.9798 2.875 6.708e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pc    1.652  0.2303 1.2009 2.104 7.273e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cc    2.433  0.5170 1.4198 3.447 2.524e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "plackett"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "summary.mets.twostage"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">udx</span> <span class="op">&lt;-</span> <span class="fu">easy.binomial.twostage</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="op">+</span><span class="va">x</span>,data<span class="op">=</span><span class="va">binfam</span>,</span></span>
<span class="r-in"><span>     response<span class="op">=</span><span class="st">"y"</span>,id<span class="op">=</span><span class="st">"id"</span>,</span></span>
<span class="r-in"><span>     theta.formula<span class="op">=</span><span class="va">desfs</span>,desnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pp"</span>,<span class="st">"pc"</span>,<span class="st">"cc"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">udx</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> With log-link </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        theta        se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pp 0.5704932 0.2541853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pc 0.5125353 0.1410238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cc 0.8840448 0.2153984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $or</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std.Err   2.5% 97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pp    1.769  0.4497 0.8878 2.651 8.350e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pc    1.670  0.2354 1.2081 2.131 1.331e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cc    2.421  0.5214 1.3987 3.443 3.441e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "plackett"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "summary.mets.twostage"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">########### ########### ########### ########### ########### ###########</span></span></span>
<span class="r-in"><span><span class="co">####  now allowing parent child POR to be different for mother and father</span></span></span>
<span class="r-in"><span><span class="co">########### ########### ########### ########### ########### ###########</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">desfsi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">num1</span><span class="op">=</span><span class="st">"num1"</span>,<span class="va">num2</span><span class="op">=</span><span class="st">"num2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">pp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"m"</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"f"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">mc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"m"</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b1"</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b2"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">fc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"f"</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b1"</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b2"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">cc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"b1"</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b1"</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b2"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pp</span>,<span class="va">mc</span>,<span class="va">fc</span>,<span class="va">cc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">udi</span> <span class="op">&lt;-</span> <span class="fu">easy.binomial.twostage</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="op">+</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">binfam</span>,</span></span>
<span class="r-in"><span>     response<span class="op">=</span><span class="st">"y"</span>,id<span class="op">=</span><span class="st">"id"</span>,</span></span>
<span class="r-in"><span>     theta.formula<span class="op">=</span><span class="va">desfsi</span>,desnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pp"</span>,<span class="st">"mother-child"</span>,<span class="st">"father-child"</span>,<span class="st">"cc"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">udi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> With log-link </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  theta        se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pp           0.6561647 0.2508517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mother-child 0.7897223 0.1715685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> father-child 0.1784171 0.1944482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cc           0.8892008 0.2124875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $or</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std.Err   2.5% 97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pp              1.927  0.4835 0.9798 2.875 6.708e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mother-child    2.203  0.3779 1.4621 2.944 5.590e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> father-child    1.195  0.2324 0.7398 1.651 2.707e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cc              2.433  0.5170 1.4198 3.447 2.524e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "plackett"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "summary.mets.twostage"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##now looking to see if interactions with age or age influences marginal models</span></span></span>
<span class="r-in"><span><span class="co">##converting factors to numeric to make all involved covariates numeric</span></span></span>
<span class="r-in"><span><span class="co">##to use desfai2 rather then desfai that works on binfam</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nbinfam</span> <span class="op">&lt;-</span> <span class="va">binfam</span></span></span>
<span class="r-in"><span><span class="va">nbinfam</span><span class="op">$</span><span class="va">num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">binfam</span><span class="op">$</span><span class="va">num</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nbinfam</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id      age x y num</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 26.68147 1 1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1 32.93535 0 1   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1  9.09635 0 1   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1 11.05365 1 1   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2 26.06935 1 1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2 28.33452 0 1   2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">desfsai</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">num1</span><span class="op">=</span><span class="st">"num1"</span>,<span class="va">num2</span><span class="op">=</span><span class="st">"num2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">pp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"m"</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"f"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="co">### av age for pp=1 i.e parent pairs</span></span></span>
<span class="r-in"><span>    <span class="va">agepp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"age1"</span><span class="op">]</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"age2"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">*</span><span class="va">pp</span></span></span>
<span class="r-in"><span>    <span class="va">mc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"m"</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b1"</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b2"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">fc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"f"</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b1"</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b2"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">cc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"b1"</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b1"</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="st">"b2"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">agecc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"age1"</span><span class="op">]</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"age2"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">-</span><span class="fl">12</span><span class="op">)</span><span class="op">*</span><span class="va">cc</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pp</span>,<span class="va">agepp</span>,<span class="va">mc</span>,<span class="va">fc</span>,<span class="va">cc</span>,<span class="va">agecc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">desfsai2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">num1</span><span class="op">=</span><span class="st">"num1"</span>,<span class="va">num2</span><span class="op">=</span><span class="st">"num2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">pp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">agepp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"age1"</span><span class="op">]</span><span class="op">+</span><span class="va">x</span><span class="op">[</span><span class="st">"age2"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">*</span><span class="va">pp</span> <span class="co">### av age for pp=1 i.e parent pairs</span></span></span>
<span class="r-in"><span>    <span class="va">mc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="fl">3</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">fc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="fl">3</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">cc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="fl">3</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="va">num2</span><span class="op">]</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">agecc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"age1"</span><span class="op">]</span><span class="op">+</span><span class="va">x</span><span class="op">[</span><span class="st">"age2"</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">-</span><span class="fl">12</span><span class="op">)</span><span class="op">*</span><span class="va">cc</span> <span class="co">### av age for children</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pp</span>,<span class="va">agepp</span>,<span class="va">mc</span>,<span class="va">fc</span>,<span class="va">cc</span>,<span class="va">agecc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">udxai2</span> <span class="op">&lt;-</span> <span class="fu">easy.binomial.twostage</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="op">+</span><span class="va">x</span><span class="op">+</span><span class="va">age</span>,data<span class="op">=</span><span class="va">binfam</span>,</span></span>
<span class="r-in"><span>     response<span class="op">=</span><span class="st">"y"</span>,id<span class="op">=</span><span class="st">"id"</span>,</span></span>
<span class="r-in"><span>     theta.formula<span class="op">=</span><span class="va">desfsai</span>,</span></span>
<span class="r-in"><span>     desnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pp"</span>,<span class="st">"pp-age"</span>,<span class="st">"mother-child"</span>,<span class="st">"father-child"</span>,<span class="st">"cc"</span>,<span class="st">"cc-age"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">udxai2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> With log-link </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    theta         se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pp            0.38859947 0.40359602</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pp-age       -0.05025909 0.08249533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mother-child  0.80559724 0.17583430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> father-child  0.18500933 0.19599386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cc            0.85277851 0.22046314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cc-age       -0.04548620 0.07212976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $or</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std.Err   2.5% 97.5%   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pp             1.4749 0.59527 0.3082 2.642 1.322e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pp-age         0.9510 0.07845 0.7972 1.105 8.086e-34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mother-child   2.2380 0.39352 1.4667 3.009 1.292e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> father-child   1.2032 0.23583 0.7410 1.665 3.357e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cc             2.3462 0.51724 1.3324 3.360 5.736e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cc-age         0.9555 0.06892 0.8204 1.091 1.048e-43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "plackett"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "summary.mets.twostage"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>


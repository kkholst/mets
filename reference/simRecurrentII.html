<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulation of recurrent events data based on cumulative hazards with two types of recurrent events — simRecurrentII • mets</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation of recurrent events data based on cumulative hazards with two types of recurrent events — simRecurrentII"><meta name="description" content="Simulation of recurrent events data based on cumulative hazards"><meta property="og:description" content="Simulation of recurrent events data based on cumulative hazards"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/basic-dutils.html">dUtility data-frame manipulations</a></li>
    <li><a class="dropdown-item" href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a></li>
    <li><a class="dropdown-item" href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a></li>
    <li><a class="dropdown-item" href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/binreg-TRS.html">Two-Stage Randomization for for Competing risks and Survival outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/binreg.html">Binomial Regression for Survival and Competing Risks Data</a></li>
    <li><a class="dropdown-item" href="../articles/cifreg.html">Cumulative Incidence Regression</a></li>
    <li><a class="dropdown-item" href="../articles/cooking-survival-data.html">WIP: Cooking survival data, 5 minute recipes</a></li>
    <li><a class="dropdown-item" href="../articles/glm-utility.html">GEE cluster standard errors and predictions for glm objects</a></li>
    <li><a class="dropdown-item" href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a></li>
    <li><a class="dropdown-item" href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a></li>
    <li><a class="dropdown-item" href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a></li>
    <li><a class="dropdown-item" href="../articles/mediation-survival.html">Mediation Analysis for survival data</a></li>
    <li><a class="dropdown-item" href="../articles/phreg_rct.html">Randomization for Cox Type rate models </a></li>
    <li><a class="dropdown-item" href="../articles/quantitative-twin.html">Twin models</a></li>
    <li><a class="dropdown-item" href="../articles/recurrent-events.html">Recurrent events</a></li>
    <li><a class="dropdown-item" href="../articles/rmst-ate.html">Average treatment effect (ATE) for Restricted mean survival and years lost of Competing risks</a></li>
    <li><a class="dropdown-item" href="../articles/survival-ate.html">G-Computation or standardization for the Cox, Fine-Gray and binomial regression models for survival data</a></li>
    <li><a class="dropdown-item" href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a></li>
    <li><a class="dropdown-item" href="../articles/twostage-survival.html">Analysis of multivariate survival data</a></li>
    <li><a class="dropdown-item" href="../articles/while-alive.html">While Alive estimands for Recurrent Events</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kkholst/mets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulation of recurrent events data based on cumulative hazards with two types of recurrent events</h1>
      <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/main/R/recurrent.marginal.R" class="external-link"><code>R/recurrent.marginal.R</code></a></small>
      <div class="d-none name"><code>simRecurrentII.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulation of recurrent events data based on cumulative hazards</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simRecurrentII</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">cumhaz</span>,</span>
<span>  <span class="va">cumhaz2</span>,</span>
<span>  death.cumhaz <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  r1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  r2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dependence <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  var.z <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cor.mat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cens <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gap.time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max.recurrent <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>number of id's</p></dd>


<dt id="arg-cumhaz">cumhaz<a class="anchor" aria-label="anchor" href="#arg-cumhaz"></a></dt>
<dd><p>cumulative hazard of recurrent events</p></dd>


<dt id="arg-cumhaz-">cumhaz2<a class="anchor" aria-label="anchor" href="#arg-cumhaz-"></a></dt>
<dd><p>cumulative hazard of recurrent events  of type 2</p></dd>


<dt id="arg-death-cumhaz">death.cumhaz<a class="anchor" aria-label="anchor" href="#arg-death-cumhaz"></a></dt>
<dd><p>cumulative hazard of death</p></dd>


<dt id="arg-r-">r1<a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>potential relative risk adjustment of rate</p></dd>


<dt id="arg-r-">r2<a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>potential relative risk adjustment of rate</p></dd>


<dt id="arg-rd">rd<a class="anchor" aria-label="anchor" href="#arg-rd"></a></dt>
<dd><p>potential relative risk adjustment of rate</p></dd>


<dt id="arg-rc">rc<a class="anchor" aria-label="anchor" href="#arg-rc"></a></dt>
<dd><p>potential relative risk adjustment of rate</p></dd>


<dt id="arg-dependence">dependence<a class="anchor" aria-label="anchor" href="#arg-dependence"></a></dt>
<dd><p>0:independence; 1:all share same random effect with variance var.z; 2:random effect exp(normal) with correlation structure from cor.mat; 3:additive gamma distributed random effects, z1= (z11+ z12)/2 such that mean is 1 , z2= (z11^cor.mat(1,2)+ z13)/2, z3= (z12^(cor.mat(2,3)+z13^cor.mat(1,3))/2, with z11 z12 z13 are gamma with mean and variance 1 , first random effect is z1 and for N1 second random effect is z2 and for N2 third random effect is for death</p></dd>


<dt id="arg-var-z">var.z<a class="anchor" aria-label="anchor" href="#arg-var-z"></a></dt>
<dd><p>variance of random effects</p></dd>


<dt id="arg-cor-mat">cor.mat<a class="anchor" aria-label="anchor" href="#arg-cor-mat"></a></dt>
<dd><p>correlation matrix for var.z variance of random effects</p></dd>


<dt id="arg-cens">cens<a class="anchor" aria-label="anchor" href="#arg-cens"></a></dt>
<dd><p>rate of censoring exponential distribution</p></dd>


<dt id="arg-gap-time">gap.time<a class="anchor" aria-label="anchor" href="#arg-gap-time"></a></dt>
<dd><p>if true simulates gap-times with specified cumulative hazard</p></dd>


<dt id="arg-max-recurrent">max.recurrent<a class="anchor" aria-label="anchor" href="#arg-max-recurrent"></a></dt>
<dd><p>limits number recurrent events to 100</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to lower level funtions</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Must give hazard of death and two recurrent events.  Possible with two
event types and their dependence can be specified but the two recurrent events need
to share random effect. Based on drawing the from cumhaz and cumhaz2 and
taking the first event rather
the cumulative and then distributing it out. Key advantage of this is that
there is  more flexibility wrt random effects</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Scheike</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">########################################</span></span></span>
<span class="r-in"><span><span class="co">## getting some rates to mimick </span></span></span>
<span class="r-in"><span><span class="co">########################################</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">CPH_HPN_CRBSI</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="va">CPH_HPN_CRBSI</span><span class="op">$</span><span class="va">terminal</span></span></span>
<span class="r-in"><span><span class="va">base1</span> <span class="op">&lt;-</span> <span class="va">CPH_HPN_CRBSI</span><span class="op">$</span><span class="va">crbsi</span> </span></span>
<span class="r-in"><span><span class="va">base4</span> <span class="op">&lt;-</span> <span class="va">CPH_HPN_CRBSI</span><span class="op">$</span><span class="va">mechanical</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################################################################</span></span></span>
<span class="r-in"><span><span class="co">### simulating simple model that mimicks data </span></span></span>
<span class="r-in"><span><span class="co">######################################################################</span></span></span>
<span class="r-in"><span><span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu">simRecurrent</span><span class="op">(</span><span class="fl">5</span>,<span class="va">base1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dprint.html">dlist</a></span><span class="op">(</span><span class="va">rr</span>,<span class="va">.</span><span class="op">~</span><span class="va">id</span>,n<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        entry      time status dtime fdeath death     start      stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     0.0000  963.6768      1  5110      0     0    0.0000  963.6768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   963.6768 3119.5944      1  5110      0     0  963.6768 3119.5944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 3119.5944 4161.9661      1  5110      0     0 3119.5944 4161.9661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 4161.9661 5110.0000      0  5110      0     0 4161.9661 5110.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       entry     time status dtime fdeath death    start     stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     0.000 2945.791      1  5110      0     0    0.000 2945.791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2945.791 4728.124      1  5110      0     0 2945.791 4728.124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 4728.124 4792.550      1  5110      0     0 4728.124 4792.550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 4792.550 4825.609      1  5110      0     0 4792.550 4825.609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 4825.609 5110.000      0  5110      0     0 4825.609 5110.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        entry      time status dtime fdeath death     start      stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     0.0000  581.1952      1  5110      0     0    0.0000  581.1952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   581.1952 3271.9495      1  5110      0     0  581.1952 3271.9495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 3271.9495 3426.2055      1  5110      0     0 3271.9495 3426.2055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 3426.2055 3460.4209      1  5110      0     0 3426.2055 3460.4209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 3460.4209 3640.4782      1  5110      0     0 3460.4209 3640.4782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 3640.4782 3964.2281      1  5110      0     0 3640.4782 3964.2281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 3964.2281 5110.0000      0  5110      0     0 3964.2281 5110.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         entry       time status dtime fdeath death      start       stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     0.00000   24.71568      1  5110      0     0    0.00000   24.71568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    24.71568  163.29496      1  5110      0     0   24.71568  163.29496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  163.29496  557.93512      1  5110      0     0  163.29496  557.93512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  557.93512  568.32318      1  5110      0     0  557.93512  568.32318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  568.32318  937.08625      1  5110      0     0  568.32318  937.08625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  937.08625 1189.38612      1  5110      0     0  937.08625 1189.38612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 1189.38612 2836.08064      1  5110      0     0 1189.38612 2836.08064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 2836.08064 3387.68824      1  5110      0     0 2836.08064 3387.68824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 3387.68824 3915.63445      1  5110      0     0 3387.68824 3915.63445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 3915.63445 4198.26243      1  5110      0     0 3915.63445 4198.26243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 4198.26243 5110.00000      0  5110      0     0 4198.26243 5110.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       entry     time status dtime fdeath death    start     stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     0.000 1898.229      1  5110      0     0    0.000 1898.229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1898.229 2121.722      1  5110      0     0 1898.229 2121.722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 2121.722 2537.183      1  5110      0     0 2121.722 2537.183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 2537.183 2686.916      1  5110      0     0 2537.183 2686.916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 2686.916 4163.187      1  5110      0     0 2686.916 4163.187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 4163.187 4208.363      1  5110      0     0 4163.187 4208.363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 4208.363 4251.102      1  5110      0     0 4208.363 4251.102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 4251.102 5110.000      0  5110      0     0 4251.102 5110.000</span>
<span class="r-in"><span><span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu">simRecurrent</span><span class="op">(</span><span class="fl">5</span>,<span class="va">base1</span>,death.cumhaz<span class="op">=</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dprint.html">dlist</a></span><span class="op">(</span><span class="va">rr</span>,<span class="va">.</span><span class="op">~</span><span class="va">id</span>,n<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      entry     time status    dtime fdeath death    start     stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.0000 152.2163      1 435.3706      1     0   0.0000 152.2163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 152.2163 296.2847      1 435.3706      1     0 152.2163 296.2847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 296.2847 435.3706      0 435.3706      1     1 296.2847 435.3706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   entry     time status    dtime fdeath death start     stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     0 327.8463      0 327.8463      1     1     0 327.8463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   entry     time status    dtime fdeath death start     stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     0 244.4292      0 244.4292      1     1     0 244.4292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        entry      time status    dtime fdeath death     start      stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     0.0000  398.9114      1 4068.001      1     0    0.0000  398.9114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   398.9114 1338.1707      1 4068.001      1     0  398.9114 1338.1707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  1338.1707 1752.8511      1 4068.001      1     0 1338.1707 1752.8511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1752.8511 2447.4908      1 4068.001      1     0 1752.8511 2447.4908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 2447.4908 2771.2826      1 4068.001      1     0 2447.4908 2771.2826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 2771.2826 3153.4447      1 4068.001      1     0 2771.2826 3153.4447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 3153.4447 3560.7620      1 4068.001      1     0 3153.4447 3560.7620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 3560.7620 3631.8290      1 4068.001      1     0 3560.7620 3631.8290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 3631.8290 3831.3708      1 4068.001      1     0 3631.8290 3831.3708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 3831.3708 3987.6291      1 4068.001      1     0 3831.3708 3987.6291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 3987.6291 3997.3036      1 4068.001      1     0 3987.6291 3997.3036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 3997.3036 4068.0012      0 4068.001      1     1 3997.3036 4068.0012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   entry    time status   dtime fdeath death start    stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     0 162.112      0 162.112      1     1     0 162.112</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu">simRecurrent</span><span class="op">(</span><span class="fl">100</span>,<span class="va">base1</span>,death.cumhaz<span class="op">=</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">showfitsim</span><span class="op">(</span>causes<span class="op">=</span><span class="fl">1</span>,<span class="va">rr</span>,<span class="va">dr</span>,<span class="va">base1</span>,<span class="va">base1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">######################################################################</span></span></span>
<span class="r-in"><span><span class="co">### simulating simple model </span></span></span>
<span class="r-in"><span><span class="co">### random effect for all causes (Z shared for death and recurrent) </span></span></span>
<span class="r-in"><span><span class="co">######################################################################</span></span></span>
<span class="r-in"><span><span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu">simRecurrent</span><span class="op">(</span><span class="fl">100</span>,<span class="va">base1</span>,death.cumhaz<span class="op">=</span><span class="va">dr</span>,dependence<span class="op">=</span><span class="fl">1</span>,var.gamma<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dtable.html">dtable</a></span><span class="op">(</span><span class="va">rr</span>,<span class="op">~</span><span class="va">death</span><span class="op">+</span><span class="va">status</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       status   0   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> death               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0             30 270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             70   0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################################################################</span></span></span>
<span class="r-in"><span><span class="co">### simulating simple model that mimicks data </span></span></span>
<span class="r-in"><span><span class="co">### now with two event types and second type has same rate as death rate</span></span></span>
<span class="r-in"><span><span class="co">######################################################################</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu">simRecurrentII</span><span class="op">(</span><span class="fl">100</span>,<span class="va">base1</span>,<span class="va">base4</span>,death.cumhaz<span class="op">=</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dtable.html">dtable</a></span><span class="op">(</span><span class="va">rr</span>,<span class="op">~</span><span class="va">death</span><span class="op">+</span><span class="va">status</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       status   0   1   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> death                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0             10 295  39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             90   0   0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="simRecurrentII-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">showfitsim</span><span class="op">(</span>causes<span class="op">=</span><span class="fl">2</span>,<span class="va">rr</span>,<span class="va">dr</span>,<span class="va">base1</span>,<span class="va">base4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## general case, 3 recurrent events and 2 causes of death</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cumhaz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">base1</span>,<span class="va">base1</span>,<span class="va">base4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">drl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dr</span>,<span class="va">base4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu">simRecurrentList</span><span class="op">(</span><span class="fl">100</span>,<span class="va">cumhaz</span>,death.cumhaz<span class="op">=</span><span class="va">drl</span>,dependence<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dtable.html">dtable</a></span><span class="op">(</span><span class="va">rr</span>,<span class="op">~</span><span class="va">death</span><span class="op">+</span><span class="va">status</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       status   0   1   2   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> death                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0              4 232 268  33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             70   0   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             26   0   0   0</span>
<span class="r-in"><span><span class="fu">showfitsimList</span><span class="op">(</span><span class="va">rr</span>,<span class="va">cumhaz</span>,<span class="va">drl</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="simRecurrentII-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-plt img"><img src="simRecurrentII-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>


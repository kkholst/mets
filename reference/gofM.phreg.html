<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>GOF for Cox covariates in  PH regression — gofM.phreg • mets</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="GOF for Cox covariates in  PH regression — gofM.phreg" />
<meta property="og:description" content="Cumulative residuals after model matrix for Cox PH regression
p-values based on Lin, Wei, Ying resampling." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.8.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kkholst/mets/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>GOF for Cox covariates in  PH regression</h1>
    <small class="dont-index">Source: <a href='https://github.com/kkholst/mets/blob/master/R/gof-phreg.R'><code>R/gof-phreg.R</code></a></small>
    <div class="hidden name"><code>gofM.phreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Cumulative residuals after model matrix for Cox PH regression
p-values based on Lin, Wei, Ying resampling.</p>
    </div>

    <pre class="usage"><span class='fu'>gofM.phreg</span>(
  <span class='kw'>formula</span>,
  <span class='kw'>data</span>,
  offset = <span class='kw'>NULL</span>,
  weights = <span class='kw'>NULL</span>,
  modelmatrix = <span class='kw'>NULL</span>,
  n.sim = <span class='fl'>1000</span>,
  silent = <span class='fl'>1</span>,
  <span class='kw'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>formula for cox regression</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data for model</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>offset</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>weights</p></td>
    </tr>
    <tr>
      <th>modelmatrix</th>
      <td><p>matrix for cumulating residuals</p></td>
    </tr>
    <tr>
      <th>n.sim</th>
      <td><p>number of simulations for score processes</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>to keep it absolutely silent, otherwise timing estimate will be prduced for longer jobs.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to lower level funtions</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>That is, computes 
$$
 U(t) = \int_0^t M^t d \hat M 
$$
and resamples its asymptotic distribution.</p>
<p>This will show if the residuals are consistent with the model. Typically,
M will be a design matrix for the continous covariates that gives for example
the quartiles, and then the plot will show if for the different quartiles of the covariate the risk
prediction is consistent over time  (time x covariate interaction).</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Thomas Scheike and Klaus K. Holst</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='kw'><a href='https://kkholst.github.io/mets'>mets</a></span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='kw'>TRACE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='kw'>TRACEsam</span> <span class='op'>&lt;-</span> <span class='fu'><a href='blocksample.html'>blocksample</a></span>(<span class='kw'>TRACE</span>,idvar=<span class='st'>"id"</span>,replace=<span class='fl'>FALSE</span>,<span class='fl'>100</span>)

<span class='fu'><a href='dcut.html'>dcut</a></span>(<span class='kw'>TRACEsam</span>)  <span class='op'>&lt;-</span> <span class='op'>~</span><span class='kw'>.</span> 
<span class='kw'>mm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span>(<span class='op'>~</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='kw'>wmicat.4</span>),data=<span class='kw'>TRACEsam</span>)
<span class='kw'>m1</span> <span class='op'>&lt;-</span> <span class='fu'>gofM.phreg</span>(<span class='fu'>Surv</span>(<span class='kw'>time</span>,<span class='kw'>status</span><span class='op'>==</span><span class='fl'>9</span>)<span class='op'>~</span><span class='kw'>vf</span><span class='op'>+</span><span class='kw'>chf</span><span class='op'>+</span><span class='kw'>wmi</span>,data=<span class='kw'>TRACEsam</span>,modelmatrix=<span class='kw'>mm</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>m1</span>)
</div><div class='output co'>#&gt; Cumulative residuals versus modelmatrix :
#&gt;                            Sup_t |U(t)|  pval
#&gt; factor(wmicat.4)[0.4,1.1]      5.788752 0.021
#&gt; factor(wmicat.4)(1.1,1.4]      2.633143 0.591
#&gt; factor(wmicat.4)(1.4,1.72]     5.657370 0.038
#&gt; factor(wmicat.4)(1.72,2]       1.227485 0.948
#&gt; 
#&gt; Cumulative score process versus covariates (discrete z via model.matrix):
#&gt;         Sup_z |U(tau,z)|  pval
#&gt; matrixZ         1.801626 0.812</div><div class='input'><span class='co'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span>()) {
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(mfrow=<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>m1</span>)
}

<span class='kw'>m1</span> <span class='op'>&lt;-</span> <span class='fu'>gofM.phreg</span>(<span class='fu'>Surv</span>(<span class='kw'>time</span>,<span class='kw'>status</span><span class='op'>==</span><span class='fl'>9</span>)<span class='op'>~</span><span class='fu'>strata</span>(<span class='kw'>vf</span>)<span class='op'>+</span><span class='kw'>chf</span><span class='op'>+</span><span class='kw'>wmi</span>,data=<span class='kw'>TRACEsam</span>,modelmatrix=<span class='kw'>mm</span>) 
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>m1</span>)
</div><div class='output co'>#&gt; Cumulative residuals versus modelmatrix :
#&gt;                            Sup_t |U(t)|  pval
#&gt; factor(wmicat.4)[0.4,1.1]      6.049754 0.022
#&gt; factor(wmicat.4)(1.1,1.4]      2.211031 0.757
#&gt; factor(wmicat.4)(1.4,1.72]     5.040704 0.085
#&gt; factor(wmicat.4)(1.72,2]       1.482109 0.890
#&gt; 
#&gt; Cumulative score process versus covariates (discrete z via model.matrix):
#&gt;         Sup_z |U(tau,z)|  pval
#&gt; matrixZ         1.228032 0.934</div><div class='input'>
<span class='co'>## cumulative sums in covariates, via design matrix mm </span>
<span class='kw'>mm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='gofZ.phreg.html'>cumContr</a></span>(<span class='kw'>TRACEsam</span><span class='op'>$</span><span class='kw'>wmi</span>,breaks=<span class='fl'>10</span>,equi=<span class='fl'>TRUE</span>)
<span class='kw'>m1</span> <span class='op'>&lt;-</span> <span class='fu'>gofM.phreg</span>(<span class='fu'>Surv</span>(<span class='kw'>time</span>,<span class='kw'>status</span><span class='op'>==</span><span class='fl'>9</span>)<span class='op'>~</span><span class='fu'>strata</span>(<span class='kw'>vf</span>)<span class='op'>+</span><span class='kw'>chf</span><span class='op'>+</span><span class='kw'>wmi</span>,data=<span class='kw'>TRACEsam</span>,
      modelmatrix=<span class='kw'>mm</span>,silent=<span class='fl'>0</span>)
</div><div class='output co'>#&gt; Cumulative score process test for modelmatrix:
#&gt;        Sup_t |U(t)| pval
#&gt; &lt;=0.56         0.84 0.35
#&gt; &lt;=0.72         1.93 0.39
#&gt; &lt;=0.88         5.06 0.04
#&gt; &lt;=1.04         2.63 0.58
#&gt; &lt;=1.2          4.27 0.17
#&gt; &lt;=1.36         4.04 0.17
#&gt; &lt;=1.52         3.20 0.29
#&gt; &lt;=1.68         1.83 0.81
#&gt; &lt;=1.84         1.25 0.82
#&gt; &lt;=2            0.00 1.00</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>m1</span>)
</div><div class='output co'>#&gt; Cumulative residuals versus modelmatrix :
#&gt;        Sup_t |U(t)|  pval
#&gt; &lt;=0.56    0.8423856 0.352
#&gt; &lt;=0.72    1.9258405 0.394
#&gt; &lt;=0.88    5.0552596 0.037
#&gt; &lt;=1.04    2.6334412 0.579
#&gt; &lt;=1.2     4.2747875 0.174
#&gt; &lt;=1.36    4.0393945 0.169
#&gt; &lt;=1.52    3.2004455 0.292
#&gt; &lt;=1.68    1.8330704 0.810
#&gt; &lt;=1.84    1.2509429 0.823
#&gt; &lt;=2       0.0000000 1.000
#&gt; 
#&gt; Cumulative score process versus covariates (discrete z via model.matrix):
#&gt;         Sup_z |U(tau,z)|  pval
#&gt; matrixZ          3.73439 0.283</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



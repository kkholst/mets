<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>CIF regression — cifreg • mets</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="CIF regression — cifreg" />
<meta property="og:description" content="CIF logistic for propodds=1 default
CIF Fine-Gray (cloglog) regression for propodds=NULL" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a>
    </li>
    <li>
      <a href="../articles/binreg.html">Binomial Regression</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kkholst/mets/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>CIF regression</h1>
    <small class="dont-index">Source: <a href='https://github.com/kkholst/mets/blob/master/R/cifreg.R'><code>R/cifreg.R</code></a></small>
    <div class="hidden name"><code>cifreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>CIF logistic for propodds=1 default
CIF Fine-Gray (cloglog) regression for propodds=NULL</p>
    </div>

    <pre class="usage"><span class='fu'>cifreg</span><span class='op'>(</span>
  <span class='va'>formula</span>,
  data <span class='op'>=</span> <span class='va'>data</span>,
  cause <span class='op'>=</span> <span class='fl'>1</span>,
  cens.code <span class='op'>=</span> <span class='fl'>0</span>,
  cens.model <span class='op'>=</span> <span class='op'>~</span><span class='fl'>1</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  offset <span class='op'>=</span> <span class='cn'>NULL</span>,
  Gc <span class='op'>=</span> <span class='cn'>NULL</span>,
  propodds <span class='op'>=</span> <span class='fl'>1</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>formula with 'Event' outcome</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data frame</p></td>
    </tr>
    <tr>
      <th>cause</th>
      <td><p>of interest</p></td>
    </tr>
    <tr>
      <th>cens.code</th>
      <td><p>code of censoring</p></td>
    </tr>
    <tr>
      <th>cens.model</th>
      <td><p>for stratified Cox model without covariates</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>weights for FG score equations</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>offsets for FG  model</p></td>
    </tr>
    <tr>
      <th>Gc</th>
      <td><p>censoring weights for time argument, default is to calculate these with a Kaplan-Meier estimator, should then give G_c(T_i-)</p></td>
    </tr>
    <tr>
      <th>propodds</th>
      <td><p>1 is logistic model, NULL is fine-gray model</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to lower level funtions</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For FG model:
$$
\int (X - E ) Y_1(t) w(t) dM_1
$$
is computed and summed over clusters  and returned multiplied with inverse
of second derivative as iid.naive. Where $$w(t) = G(t) (I(T_i \wedge t &lt; C_i)/G_c(T_i \wedge t))$$ and
$$E(t) = S_1(t)/S_0(t)$$ and $$S_j(t) = \sum X_i^j Y_{i1}(t) w_i(t) \exp(X_i^T \beta)$$</p>

<p>The iid decomposition of the beta's, however, also have a censoring term that is also
is computed and added to UUiid (still scaled with inverse second derivative)
$$
\int (X - E ) Y_1(t) w(t) dM_1 + \int q(s)/p(s) dM_c
$$
and returned as iid</p>
<p>For logistic link standard errors are slightly to small since uncertainty from recursive baseline is not considered, so for smaller
data-sets it is recommended to use the prop.odds.subdist of timereg that is also more efficient due to use of different weights for
the estimating equations. Alternatively, one can also bootstrap the standard errors.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Thomas Scheike</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## data with no ties</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>bmt</span>,package<span class='op'>=</span><span class='st'>"timereg"</span><span class='op'>)</span>
<span class='va'>bmt</span><span class='op'>$</span><span class='va'>time</span> <span class='op'>&lt;-</span> <span class='va'>bmt</span><span class='op'>$</span><span class='va'>time</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>bmt</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>0.01</span>
<span class='va'>bmt</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>bmt</span><span class='op'>)</span>

<span class='co'>## logistic link  OR interpretation</span>
<span class='va'>ll</span><span class='op'>=</span><span class='fu'>cifreg</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/timereg/man/Event.html'>Event</a></span><span class='op'>(</span><span class='va'>time</span>,<span class='va'>cause</span><span class='op'>)</span><span class='op'>~</span><span class='va'>tcell</span><span class='op'>+</span><span class='va'>platelet</span><span class='op'>+</span><span class='va'>age</span>,data<span class='op'>=</span><span class='va'>bmt</span>,cause<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ll</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;    n events
#&gt;  408    161
#&gt; 
#&gt;  408 clusters
#&gt; coeffients:
#&gt;           Estimate      S.E.   dU^-1/2 P-value
#&gt; tcell    -0.709620  0.331983  0.274927  0.0326
#&gt; platelet -0.455296  0.236020  0.187921  0.0537
#&gt; age       0.391176  0.098036  0.083670  0.0001
#&gt; 
#&gt; exp(coeffients):
#&gt;          Estimate    2.5%  97.5%
#&gt; tcell     0.49183 0.25658 0.9428
#&gt; platelet  0.63426 0.39936 1.0073
#&gt; age       1.47872 1.22022 1.7920
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ll</span><span class='op'>)</span>
</div><div class='img'><img src='cifreg-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>nd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>tcell<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,platelet<span class='op'>=</span><span class='fl'>0</span>,age<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>
<span class='va'>pll</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ll</span>,<span class='va'>nd</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pll</span><span class='op'>)</span>
</div><div class='img'><img src='cifreg-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Fine-Gray model</span>
<span class='va'>fg</span><span class='op'>=</span><span class='fu'>cifreg</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/timereg/man/Event.html'>Event</a></span><span class='op'>(</span><span class='va'>time</span>,<span class='va'>cause</span><span class='op'>)</span><span class='op'>~</span><span class='va'>tcell</span><span class='op'>+</span><span class='va'>platelet</span><span class='op'>+</span><span class='va'>age</span>,data<span class='op'>=</span><span class='va'>bmt</span>,cause<span class='op'>=</span><span class='fl'>1</span>,propodds<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fg</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;    n events
#&gt;  408    161
#&gt; 
#&gt;  408 clusters
#&gt; coeffients:
#&gt;           Estimate      S.E.   dU^-1/2 P-value
#&gt; tcell    -0.596632  0.270518  0.275783  0.0274
#&gt; platelet -0.425976  0.180709  0.187721  0.0184
#&gt; age       0.343783  0.080261  0.086282  0.0000
#&gt; 
#&gt; exp(coeffients):
#&gt;          Estimate    2.5%  97.5%
#&gt; tcell     0.55066 0.32406 0.9357
#&gt; platelet  0.65313 0.45833 0.9307
#&gt; age       1.41027 1.20499 1.6505
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fg</span><span class='op'>)</span>
</div><div class='img'><img src='cifreg-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>nd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>tcell<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,platelet<span class='op'>=</span><span class='fl'>0</span>,age<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>
<span class='va'>pfg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>fg</span>,<span class='va'>nd</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>pfg</span><span class='op'>)</span>
</div><div class='img'><img src='cifreg-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>sfg</span> <span class='op'>&lt;-</span> <span class='fu'>cifreg</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/timereg/man/Event.html'>Event</a></span><span class='op'>(</span><span class='va'>time</span>,<span class='va'>cause</span><span class='op'>)</span><span class='op'>~</span><span class='fu'>strata</span><span class='op'>(</span><span class='va'>tcell</span><span class='op'>)</span><span class='op'>+</span><span class='va'>platelet</span><span class='op'>+</span><span class='va'>age</span>,data<span class='op'>=</span><span class='va'>bmt</span>,cause<span class='op'>=</span><span class='fl'>1</span>,propodds<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sfg</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;    n events
#&gt;  408    161
#&gt; 
#&gt;  408 clusters
#&gt; coeffients:
#&gt;           Estimate      S.E.   dU^-1/2 P-value
#&gt; platelet -0.424631  0.180789  0.187822  0.0188
#&gt; age       0.341978  0.079854  0.086282  0.0000
#&gt; 
#&gt; exp(coeffients):
#&gt;          Estimate    2.5%  97.5%
#&gt; platelet  0.65401 0.45888 0.9321
#&gt; age       1.40773 1.20378 1.6462
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>sfg</span><span class='op'>)</span>
</div><div class='img'><img src='cifreg-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### predictions with CI based on iid decomposition of baseline and beta</span>
<span class='va'>fg</span> <span class='op'>&lt;-</span> <span class='fu'>cifreg</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/timereg/man/Event.html'>Event</a></span><span class='op'>(</span><span class='va'>time</span>,<span class='va'>cause</span><span class='op'>)</span><span class='op'>~</span><span class='va'>tcell</span><span class='op'>+</span><span class='va'>platelet</span><span class='op'>+</span><span class='va'>age</span>,data<span class='op'>=</span><span class='va'>bmt</span>,cause<span class='op'>=</span><span class='fl'>1</span>,propodds<span class='op'>=</span><span class='cn'>NULL</span>,cox.prep<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>Biid</span> <span class='op'>&lt;-</span> <span class='fu'>mets</span><span class='fu'>:::</span><span class='fu'>iid.baseline.cifreg</span><span class='op'>(</span><span class='va'>fg</span>,time<span class='op'>=</span><span class='fl'>20</span><span class='op'>)</span>
<span class='fu'>FGprediid</span><span class='op'>(</span><span class='va'>Biid</span>,<span class='va'>bmt</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>,<span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           pred     se-log     lower     upper
#&gt; [1,] 0.4564160 0.07254064 0.3959262 0.5261476
#&gt; [2,] 0.5072485 0.07328411 0.4393810 0.5855990
#&gt; [3,] 0.6064635 0.08622212 0.5121678 0.7181200
#&gt; [4,] 0.6026848 0.08566100 0.5095367 0.7128612
#&gt; [5,] 0.4288154 0.07564733 0.3697253 0.4973493</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



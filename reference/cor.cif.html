<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Cross-odds-ratio, OR or RR risk regression for competing risks — cor.cif • mets</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-odds-ratio, OR or RR risk regression for competing risks — cor.cif"><meta property="og:description" content="Fits a parametric model for the log-cross-odds-ratio for the 
predictive effect of for the cumulative incidence curves for \(T_1\) 
experiencing cause i given that \(T_2\) has experienced a cause k :
$$
\log(COR(i|k))  =  h(\theta,z_1,i,z_2,k,t)=_{default}  \theta^T z =  
$$
with the log cross odds ratio being 
$$
COR(i|k) = 
\frac{O(T_1 \leq t,cause_1=i | T_2 \leq t,cause_2=k)}{
O(T_1 \leq t,cause_1=i)}  
$$
the conditional odds divided by the unconditional odds, with the odds
being, respectively 
$$
O(T_1 \leq t,cause_1=i | T_2 \leq t,cause_1=k) = 
\frac{
P_x(T_1 \leq t,cause_1=i | T_2 \leq t,cause_2=k)}{
P_x((T_1 \leq t,cause_1=i)^c | T_2 \leq t,cause_2=k)}
$$
and 
$$
O(T_1 \leq t,cause_1=i) = 
\frac{P_x(T_1 \leq t,cause_1=i )}{P_x((T_1 \leq t,cause_1=i)^c )}.
$$
Here \(B^c\) is the complement event of \(B\),
\(P_x\) is the distribution given covariates 
(\(x\) are subject specific and \(z\) are cluster specific covariates), and 
\(h()\) is a function that is the simple identity 
\(\theta^T z\) by default."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a>
    </li>
    <li>
      <a href="../articles/binreg.html">Binomial Regression</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/mediation-survival.html">Mediation Analysis for survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kkholst/mets/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cross-odds-ratio, OR or RR risk regression for competing risks</h1>
    <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/HEAD/R/cor.R" class="external-link"><code>R/cor.R</code></a></small>
    <div class="hidden name"><code>cor.cif.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a parametric model for the log-cross-odds-ratio for the 
predictive effect of for the cumulative incidence curves for \(T_1\) 
experiencing cause i given that \(T_2\) has experienced a cause k :
$$
\log(COR(i|k))  =  h(\theta,z_1,i,z_2,k,t)=_{default}  \theta^T z =  
$$
with the log cross odds ratio being 
$$
COR(i|k) = 
\frac{O(T_1 \leq t,cause_1=i | T_2 \leq t,cause_2=k)}{
O(T_1 \leq t,cause_1=i)}  
$$
the conditional odds divided by the unconditional odds, with the odds
being, respectively 
$$
O(T_1 \leq t,cause_1=i | T_2 \leq t,cause_1=k) = 
\frac{
P_x(T_1 \leq t,cause_1=i | T_2 \leq t,cause_2=k)}{
P_x((T_1 \leq t,cause_1=i)^c | T_2 \leq t,cause_2=k)}
$$
and 
$$
O(T_1 \leq t,cause_1=i) = 
\frac{P_x(T_1 \leq t,cause_1=i )}{P_x((T_1 \leq t,cause_1=i)^c )}.
$$
Here \(B^c\) is the complement event of \(B\),
\(P_x\) is the distribution given covariates 
(\(x\) are subject specific and \(z\) are cluster specific covariates), and 
\(h()\) is a function that is the simple identity 
\(\theta^T z\) by default.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cor.cif</span><span class="op">(</span></span>
<span>  <span class="va">cif</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  cause <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  times <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cause1 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cause2 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cens.code <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cens.model <span class="op">=</span> <span class="st">"KM"</span>,</span>
<span>  Nit <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  detail <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  clusters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta.des <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sym <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par.func <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dpar.func <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dimpar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  score.method <span class="op">=</span> <span class="st">"nlminb"</span>,</span>
<span>  same.cens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  censoring.weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  silent <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>cif</dt>
<dd><p>a model object from the comp.risk function with the 
marginal cumulative incidence of cause1, i.e., the event of interest, and whose
odds the comparision is compared to the conditional odds given cause2</p></dd>


<dt>data</dt>
<dd><p>a data.frame with the variables.</p></dd>


<dt>cause</dt>
<dd><p>specifies the causes  related to the death
times, the value cens.code is the censoring value. When missing it comes from marginal cif.</p></dd>


<dt>times</dt>
<dd><p>time-vector that specifies the times used for the estimating euqations for the cross-odds-ratio estimation.</p></dd>


<dt>cause1</dt>
<dd><p>specificies the cause considered.</p></dd>


<dt>cause2</dt>
<dd><p>specificies the cause that is conditioned on.</p></dd>


<dt>cens.code</dt>
<dd><p>specificies the code for the censoring if NULL then uses the one from the marginal cif model.</p></dd>


<dt>cens.model</dt>
<dd><p>specified which model to use for the ICPW, KM is Kaplan-Meier alternatively it may be "cox"</p></dd>


<dt>Nit</dt>
<dd><p>number of iterations for Newton-Raphson algorithm.</p></dd>


<dt>detail</dt>
<dd><p>if 0 no details are printed during iterations, if 1 details are given.</p></dd>


<dt>clusters</dt>
<dd><p>specifies the cluster structure.</p></dd>


<dt>theta</dt>
<dd><p>specifies starting values for the cross-odds-ratio parameters of the model.</p></dd>


<dt>theta.des</dt>
<dd><p>specifies a regression design for the cross-odds-ratio parameters.</p></dd>


<dt>step</dt>
<dd><p>specifies the step size for the Newton-Raphson algorithm.</p></dd>


<dt>sym</dt>
<dd><p>specifies if symmetry is used in the model.</p></dd>


<dt>weights</dt>
<dd><p>weights for estimating equations.</p></dd>


<dt>par.func</dt>
<dd><p>parfunc</p></dd>


<dt>dpar.func</dt>
<dd><p>dparfunc</p></dd>


<dt>dimpar</dt>
<dd><p>dimpar</p></dd>


<dt>score.method</dt>
<dd><p>"nlminb", can also use "nr".</p></dd>


<dt>same.cens</dt>
<dd><p>if true then censoring within clusters are assumed to be the same variable, default is independent censoring.</p></dd>


<dt>censoring.weights</dt>
<dd><p>these probabilities are used for the bivariate censoring dist.</p></dd>


<dt>silent</dt>
<dd><p>1 to suppress output about convergence related issues.</p></dd>


<dt>...</dt>
<dd><p>Not used.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>returns an object of type 'cor'. With the following arguments:</p>
<dl><dt>theta</dt>
<dd><p>estimate of proportional odds parameters of model.</p></dd>

<dt>var.theta</dt>
<dd><p>variance for gamma.</p></dd>

<dt>hess</dt>
<dd><p>the derivative of the used score.</p></dd>

<dt>score</dt>
<dd><p>scores at final stage.</p></dd>

<dt>score</dt>
<dd><p>scores at final stage.</p></dd>

<dt>theta.iid</dt>
<dd><p>matrix of iid decomposition of parametric effects.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The OR dependence measure is given by 
$$
OR(i,k) = 
\log ( 
\frac{O(T_1 \leq t,cause_1=i | T_2 \leq t,cause_2=k)}{
O(T_1 \leq t,cause_1=i) | T_2 \leq t,cause_2=k)}  
$$
This measure is numerically more stabile than the COR measure, and is symetric in i,k.</p>
<p>The RR dependence measure is given by 
$$
RR(i,k) = 
\log ( 
\frac{P(T_1 \leq t,cause_1=i , T_2 \leq t,cause_2=k)}{
P(T_1 \leq t,cause_1=i) P(T_2 \leq t,cause_2=k)}  
$$
This measure is numerically more stabile than the COR measure, and is symetric in i,k.</p>
<p>The model is fitted under symmetry (sym=1), i.e., such that it is assumed 
that \(T_1\) and \(T_2\) can be interchanged and leads to
the same cross-odd-ratio (i.e.
\(COR(i|k) = COR(k|i))\), 
as would be expected for twins 
or without symmetry as might be the case with mothers and daughters (sym=0).</p>
<p>\(h()\) may be specified as an R-function of the parameters, 
see example below, but the default is that it is simply \(\theta^T z\).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Cross odds ratio Modelling of dependence for
Multivariate Competing Risks Data, Scheike and Sun (2012), Biostatistics.</p>
<p>A Semiparametric Random Effects Model for Multivariate Competing Risks Data,
Scheike, Zhang, Sun, Jensen (2010), Biometrika.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Thomas Scheike</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/scheike/timereg" class="external-link">"timereg"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">multcif</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">multcif</span><span class="op">$</span><span class="va">cause</span><span class="op">[</span><span class="va">multcif</span><span class="op">$</span><span class="va">cause</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">zyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span> <span class="co"># to speed up computations use only these time-points</span></span></span>
<span class="r-in"><span><span class="va">add</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/comp.risk.html" class="external-link">comp.risk</a></span><span class="op">(</span><span class="fu"><a href="Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cause</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">multcif</span>,cause<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>               n.sim<span class="op">=</span><span class="fl">0</span>,times<span class="op">=</span><span class="va">times</span>,model<span class="op">=</span><span class="st">"fg"</span>,max.clust<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">add2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/comp.risk.html" class="external-link">comp.risk</a></span><span class="op">(</span><span class="fu"><a href="Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cause</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">multcif</span>,cause<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>               n.sim<span class="op">=</span><span class="fl">0</span>,times<span class="op">=</span><span class="va">times</span>,model<span class="op">=</span><span class="st">"fg"</span>,max.clust<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out1</span><span class="op">&lt;-</span><span class="fu">cor.cif</span><span class="op">(</span><span class="va">add</span>,data<span class="op">=</span><span class="va">multcif</span>,cause1<span class="op">=</span><span class="fl">1</span>,cause2<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cross odds ratio dependence for competing risks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effect of cause1=1 on cause2=1 under symmetry=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           log-Coef.   SE     z P-val Cross odds ratio   SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intercept      1.04 9.33 0.111 0.911             2.82 26.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out2</span><span class="op">&lt;-</span><span class="fu">cor.cif</span><span class="op">(</span><span class="va">add</span>,data<span class="op">=</span><span class="va">multcif</span>,cause1<span class="op">=</span><span class="fl">1</span>,cause2<span class="op">=</span><span class="fl">1</span>,theta.des<span class="op">=</span><span class="va">theta.des</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cross odds ratio dependence for competing risks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effect of cause1=1 on cause2=1 under symmetry=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              log-Coef.    SE      z P-val Cross odds ratio   SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)0     0.732  8.36 0.0876  0.93             2.08 17.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> factor(zyg)1     1.300 20.70 0.0627  0.95             3.66 75.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##out3&lt;-cor.cif(add,data=multcif,cause1=1,cause2=2,cif2=add2)</span></span></span>
<span class="r-in"><span><span class="co">##summary(out3)</span></span></span>
<span class="r-in"><span><span class="co">###########################################################</span></span></span>
<span class="r-in"><span><span class="co"># investigating further models using parfunc and dparfunc</span></span></span>
<span class="r-in"><span><span class="co">###########################################################</span></span></span>
<span class="r-in"><span> <span class="co">## Reduce Ex.Timings</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prt</span><span class="op">&lt;-</span><span class="fu"><a href="internal.html">simnordic.random</a></span><span class="op">(</span><span class="fl">2000</span>,cordz<span class="op">=</span><span class="fl">2</span>,cormz<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prt</span><span class="op">$</span><span class="va">status</span> <span class="op">&lt;-</span><span class="va">prt</span><span class="op">$</span><span class="va">cause</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">prt</span><span class="op">$</span><span class="va">status</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0    1    2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2102  597 5301 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">100</span>,by<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cifmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/timereg/man/comp.risk.html" class="external-link">comp.risk</a></span><span class="op">(</span><span class="fu"><a href="Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cause</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,</span></span>
<span class="r-in"><span>                    cause<span class="op">=</span><span class="fl">1</span>,n.sim<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>                    times<span class="op">=</span><span class="va">times</span>,conservative<span class="op">=</span><span class="fl">1</span>,max.clust<span class="op">=</span><span class="cn">NULL</span>,model<span class="op">=</span><span class="st">"fg"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">parfunc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>,<span class="va">t</span>,<span class="va">pardes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">par</span> <span class="op">&lt;-</span> <span class="va">pardes</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>       <span class="va">pardes</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">60</span><span class="op">)</span><span class="op">/</span><span class="fl">12</span>,<span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">60</span><span class="op">)</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">par</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">parfunc</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">1</span>,<span class="fl">0.1</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">50</span>,<span class="va">theta.des</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.1666667</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dparfunc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>,<span class="va">t</span>,<span class="va">pardes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">dpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pardes</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">pardes</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">60</span><span class="op">)</span><span class="op">/</span><span class="fl">12</span>,<span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">60</span><span class="op">)</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dpar</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">dparfunc</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">1</span>,<span class="fl">0.1</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">50</span>,<span class="va">theta.des</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   factor(zyg)MZ factor(zyg)DZ factor(zyg)MZ factor(zyg)DZ</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1             0             1             0    -0.8333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2             0             1             0    -0.8333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             0             1             0    -0.8333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             0             1             0    -0.8333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5             0             1             0    -0.8333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6             0             1             0    -0.8333333</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prt</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "time"      "cause"     "x"         "country"   "id"        "cens"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "stime"     "entry"     "truncated" "zyg"       "status"   </span>
<span class="r-in"><span><span class="va">or1</span> <span class="op">&lt;-</span> <span class="fu">or.cif</span><span class="op">(</span><span class="va">cifmod</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">1</span>,cause2<span class="op">=</span><span class="fl">1</span>,theta.des<span class="op">=</span><span class="va">theta.des</span>,</span></span>
<span class="r-in"><span>              same.cens<span class="op">=</span><span class="cn">TRUE</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">1.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              par.func<span class="op">=</span><span class="va">parfunc</span>,dpar.func<span class="op">=</span><span class="va">dparfunc</span>,dimpar<span class="op">=</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>              score.method<span class="op">=</span><span class="st">"nr"</span>,detail<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fisher-Scoring ===================: it= 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta:[1] 0.6 1.1 0.1 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score:[1]  4.4038139 -0.5697823 11.6772977 -1.6949449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hess:          [,1]      [,2]       [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -2.380951  0.000000  -6.184041   0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.000000 -3.262648   0.000000  -8.285154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -6.184041  0.000000 -17.409502   0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.000000 -8.285154   0.000000 -23.052048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fisher-Scoring ===================: it= 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta:[1]  1.98846483  1.23830300  0.27754527 -0.02323445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score:[1] -1.25603525 -0.01146766 -2.79344744 -0.04626783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hess:          [,1]      [,2]       [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -3.955147  0.000000  -9.393342   0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.000000 -3.009163   0.000000  -7.530575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -9.393342  0.000000 -25.237970   0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.000000 -7.530575   0.000000 -20.789841</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fisher-Scoring ===================: it= 3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta:[1]  1.51716907  1.25710704  0.34227293 -0.03227122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score:[1]  0.0084015704  0.0001720174  0.0266071031 -0.0006890359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hess:          [,1]      [,2]       [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -3.976728  0.000000  -9.711857   0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.000000 -3.004696   0.000000  -7.507249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -9.711857  0.000000 -26.396636   0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.000000 -7.507249   0.000000 -20.707731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fisher-Scoring ===================: it= 4"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta:[1]  1.51373019  1.25859721  0.34454613 -0.03284473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score:[1]  1.000423e-04  1.638102e-05  2.675999e-04 -3.827783e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hess:          [,1]      [,2]       [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -3.974979  0.000000  -9.707329   0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.000000 -3.004947   0.000000  -7.507026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -9.707329  0.000000 -26.382387   0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.000000 -7.507026   0.000000 -20.705898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fisher-Scoring ===================: it= 5"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta:[1]  1.51373411  1.25870404  0.34455484 -0.03288532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score:[1]  8.055071e-08  1.179946e-06  1.314044e-06 -2.699063e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hess:          [,1]      [,2]       [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -3.974972  0.000000  -9.707299   0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.000000 -3.004967   0.000000  -7.507016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -9.707299  0.000000 -26.382278   0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.000000 -7.507016   0.000000 -20.705785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fisher-Scoring ===================: it= 6"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta:[1]  1.51373311  1.25871166  0.34455525 -0.03288821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score:[1]  1.926553e-08  8.694846e-08  3.069134e-08 -1.875468e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hess:          [,1]      [,2]       [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -3.974972  0.000000  -9.707298   0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.000000 -3.004969   0.000000  -7.507015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -9.707298  0.000000 -26.382277   0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.000000 -7.507015   0.000000 -20.705777</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">or1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OR for dependence for competing risks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OR of cumulative incidence for cause1= 1  and cause2= 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        log-ratio Coef.    SE      z    P-val Ratio    SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func          1.5100 0.348  4.350 1.39e-05 4.540 1.580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func          1.2600 0.408  3.090 2.03e-03 3.520 1.440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func          0.3450 0.129  2.680 7.43e-03 1.410 0.182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func         -0.0329 0.111 -0.296 7.67e-01 0.968 0.107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">cor1</span> <span class="op">&lt;-</span> <span class="fu">cor.cif</span><span class="op">(</span><span class="va">cifmod</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">1</span>,cause2<span class="op">=</span><span class="fl">1</span>,theta.des<span class="op">=</span><span class="va">theta.des</span>,</span></span>
<span class="r-in"><span>                 same.cens<span class="op">=</span><span class="cn">TRUE</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1.0</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 par.func<span class="op">=</span><span class="va">parfunc</span>,dpar.func<span class="op">=</span><span class="va">dparfunc</span>,dimpar<span class="op">=</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>                 control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,detail<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0:     764.39429: 0.500000  1.00000 0.100000 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:     760.41547: 0.638110 0.960514 0.467772 -0.0132205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     760.40387: 0.653395 0.974160 0.451036 0.0181985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:     760.38389: 0.690757 0.972238 0.448591 0.00142104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:     760.37606: 0.718637 0.978903 0.420008 0.00837748</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:     760.25920:  1.06308  1.01089 0.300306 -0.0207997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   6:     760.25068:  1.17095  1.03357 0.291057 0.00476415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   7:     760.21955:  1.26957  1.04549 0.238342 -0.0108132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8:     760.21001:  1.37413  1.06352 0.203103 -0.0305819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9:     760.20960:  1.45522  1.09168 0.167526 -0.0343140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  10:     760.20850:  1.41964  1.09024 0.182566 -0.0388281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  11:     760.20845:  1.41813  1.09721 0.183339 -0.0412570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  12:     760.20842:  1.41722  1.11055 0.183672 -0.0460117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  13:     760.20842:  1.41733  1.11051 0.183623 -0.0459848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1.41733324  1.11051386  0.18362322 -0.04598481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 760.2084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $evaluations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       19       71 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "relative convergence (4)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iid decomposition</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cor1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cross odds ratio dependence for competing risks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effect of cause1=1 on cause2=1 under symmetry=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        log-Coef.   SE        z P-val Cross odds ratio  SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func     1.420 66.5  0.02130 0.983            4.130 274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func     1.110 71.4  0.01560 0.988            3.040 217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func     0.184 23.3  0.00789 0.994            1.200  28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func    -0.046 22.0 -0.00209 0.998            0.955  21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### piecewise contant OR model</span></span></span>
<span class="r-in"><span><span class="va">gparfunc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>,<span class="va">t</span>,<span class="va">pardes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">cuts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">80</span>,<span class="fl">90</span>,<span class="fl">120</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">grop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">t</span><span class="op">&lt;</span><span class="va">cuts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">paru</span>  <span class="op">&lt;-</span> <span class="op">(</span><span class="va">pardes</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">grop</span><span class="op">*</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="op">(</span><span class="va">pardes</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">grop</span><span class="op">*</span><span class="va">par</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">paru</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dgparfunc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>,<span class="va">t</span>,<span class="va">pardes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">cuts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">80</span>,<span class="fl">90</span>,<span class="fl">120</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">grop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">t</span><span class="op">&lt;</span><span class="va">cuts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">par1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">grop</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pardes</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">grop</span><span class="op">)</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">parmz</span> <span class="op">&lt;-</span> <span class="va">par1</span><span class="op">*</span> <span class="op">(</span><span class="va">pardes</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pardz</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">pardes</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">par1</span></span></span>
<span class="r-in"><span><span class="va">dpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">parmz</span>,<span class="va">pardz</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dpar</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">dgparfunc</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fl">50</span>,<span class="va">theta.des</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    0    0    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    0    0    0    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]    0    0    0    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]    0    0    0    1    0    0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">gparfunc</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fl">50</span>,<span class="va">theta.des</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   2   3   4   5   6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1 0.1 0.1 0.1 0.1 0.1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">or1g</span> <span class="op">&lt;-</span> <span class="fu">or.cif</span><span class="op">(</span><span class="va">cifmod</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">1</span>,cause2<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>               theta.des<span class="op">=</span><span class="va">theta.des</span>, same.cens<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>               par.func<span class="op">=</span><span class="va">gparfunc</span>,dpar.func<span class="op">=</span><span class="va">dgparfunc</span>,</span></span>
<span class="r-in"><span>               dimpar<span class="op">=</span><span class="fl">6</span>,score.method<span class="op">=</span><span class="st">"nr"</span>,detail<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fisher-Scoring ===================: it= 1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta:[1] 0.1 0.1 0.1 0.1 0.1 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score:[1] 0.1272695 0.6721568 3.2995329 0.1193734 0.3414362 1.1416387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hess:            [,1]       [,2]       [,3]        [,4]       [,5]       [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.05264815  0.0000000  0.0000000  0.00000000  0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.00000000 -0.2202109  0.0000000  0.00000000  0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.00000000  0.0000000 -0.8603209  0.00000000  0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.00000000  0.0000000  0.0000000 -0.05264815  0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.00000000  0.0000000  0.0000000  0.00000000 -0.2202109  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.00000000  0.0000000  0.0000000  0.00000000  0.0000000 -0.8603209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fisher-Scoring ===================: it= 2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta:[1] 2.517359 3.152333 3.935235 2.367380 1.650497 1.426992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score:[1] -0.4338385 -1.0147952 -2.5460328 -0.3722739 -0.3313216 -0.7014266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hess:           [,1]       [,2]      [,3]       [,4]       [,5]      [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.4976024  0.0000000  0.000000  0.0000000  0.0000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0000000 -0.8549108  0.000000  0.0000000  0.0000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0000000  0.0000000 -1.600519  0.0000000  0.0000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.0000000  0.0000000  0.000000 -0.4751796  0.0000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.0000000  0.0000000  0.000000  0.0000000 -0.8248922  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.0000000  0.0000000  0.000000  0.0000000  0.0000000 -2.408282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fisher-Scoring ===================: it= 3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta:[1] 1.645501 1.965314 2.344480 1.583942 1.248842 1.135736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score:[1] -0.02982301  0.04411757  0.63062528 -0.02738202 -0.01381586 -0.01990217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hess:           [,1]       [,2]      [,3]      [,4]       [,5]      [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.3202401  0.0000000  0.000000  0.000000  0.0000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0000000 -0.9097494  0.000000  0.000000  0.0000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0000000  0.0000000 -2.766973  0.000000  0.0000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.0000000  0.0000000  0.000000 -0.305418  0.0000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.0000000  0.0000000  0.000000  0.000000 -0.6707065  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.0000000  0.0000000  0.000000  0.000000  0.0000000 -2.098342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fisher-Scoring ===================: it= 4"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta:[1] 1.552374 2.013808 2.572392 1.494288 1.228243 1.126251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score:[1] -4.297265e-04 -1.168387e-04  3.731022e-03 -5.158182e-04 -4.497369e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6]  2.253821e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hess:           [,1]       [,2]      [,3]       [,4]       [,5]      [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.2978324  0.0000000  0.000000  0.0000000  0.0000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0000000 -0.9191812  0.000000  0.0000000  0.0000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0000000  0.0000000 -2.695765  0.0000000  0.0000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.0000000  0.0000000  0.000000 -0.2839372  0.0000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.0000000  0.0000000  0.000000  0.0000000 -0.6619257  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.0000000  0.0000000  0.000000  0.0000000  0.0000000 -2.087228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fisher-Scoring ===================: it= 5"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta:[1] 1.550931 2.013681 2.573776 1.492471 1.228175 1.126252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score:[1]  1.116180e-06 -7.347215e-10  1.587856e-06 -1.109826e-06 -4.893145e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] -4.601634e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hess:           [,1]       [,2]      [,3]       [,4]       [,5]     [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.2974862  0.0000000  0.000000  0.0000000  0.0000000  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0000000 -0.9191578  0.000000  0.0000000  0.0000000  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0000000  0.0000000 -2.695165  0.0000000  0.0000000  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.0000000  0.0000000  0.000000 -0.2835044  0.0000000  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.0000000  0.0000000  0.000000  0.0000000 -0.6618966  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.0000000  0.0000000  0.000000  0.0000000  0.0000000 -2.08723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fisher-Scoring ===================: it= 6"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta:[1] 1.550935 2.013681 2.573776 1.492467 1.228175 1.126252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score:[1] -2.846686e-09 -3.398974e-15 -1.035387e-10 -1.750221e-09 -1.311451e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6]  3.469968e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hess:           [,1]       [,2]      [,3]       [,4]       [,5]     [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.2974871  0.0000000  0.000000  0.0000000  0.0000000  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0000000 -0.9191578  0.000000  0.0000000  0.0000000  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0000000  0.0000000 -2.695165  0.0000000  0.0000000  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.0000000  0.0000000  0.000000 -0.2835035  0.0000000  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.0000000  0.0000000  0.000000  0.0000000 -0.6618966  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.0000000  0.0000000  0.000000  0.0000000  0.0000000 -2.08723</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">or1g</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OR for dependence for competing risks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OR of cumulative incidence for cause1= 1  and cause2= 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        log-ratio Coef.    SE    z    P-val Ratio    SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func            1.55 0.362 4.28 1.87e-05  4.72 1.710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func            2.01 0.325 6.20 5.64e-10  7.49 2.430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func            2.57 0.352 7.31 2.71e-13 13.10 4.620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func            1.49 0.369 4.05 5.12e-05  4.45 1.640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func            1.23 0.307 3.99 6.49e-05  3.41 1.050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R-func            1.13 0.274 4.11 4.01e-05  3.08 0.846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">or1g</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "theta"      "score"      "hess"       "hessi"      "var.theta" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] "theta.iid"  "score1"     "thetanames" "brierscore" "p11"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "call"      </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">or1g</span><span class="op">$</span><span class="va">theta.iid</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]         [,4]         [,5]         [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    0 0.0007341431 0.0008025713 0.0008395676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    0    0 0.0007341431 0.0008025713 0.0008395676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    0    0 0.0007341431 0.0008025713 0.0008395676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    0    0    0 0.0007341431 0.0008025713 0.0008395676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]    0    0    0 0.0007341431 0.0008025713 0.0008395676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]    0    0    0 0.0007341431 0.0008025713 0.0008395676</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>


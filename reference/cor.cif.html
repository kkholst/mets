<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cross-odds-ratio, OR or RR risk regression for competing risks — cor.cif • mets</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Cross-odds-ratio, OR or RR risk regression for competing risks — cor.cif" />
<meta property="og:description" content="Fits a parametric model for the log-cross-odds-ratio for the 
predictive effect of for the cumulative incidence curves for \(T_1\) 
experiencing cause i given that \(T_2\) has experienced a cause k :
$$
\log(COR(i|k))  =  h(\theta,z_1,i,z_2,k,t)=_{default}  \theta^T z =  
$$
with the log cross odds ratio being 
$$
COR(i|k) = 
\frac{O(T_1 \leq t,cause_1=i | T_2 \leq t,cause_2=k)}{
O(T_1 \leq t,cause_1=i)}  
$$
the conditional odds divided by the unconditional odds, with the odds
being, respectively 
$$
O(T_1 \leq t,cause_1=i | T_2 \leq t,cause_1=k) = 
\frac{
P_x(T_1 \leq t,cause_1=i | T_2 \leq t,cause_2=k)}{
P_x((T_1 \leq t,cause_1=i)^c | T_2 \leq t,cause_2=k)}
$$
and 
$$
O(T_1 \leq t,cause_1=i) = 
\frac{P_x(T_1 \leq t,cause_1=i )}{P_x((T_1 \leq t,cause_1=i)^c )}.
$$
Here \(B^c\) is the complement event of \(B\),
\(P_x\) is the distribution given covariates 
(\(x\) are subject specific and \(z\) are cluster specific covariates), and 
\(h()\) is a function that is the simple identity 
\(\theta^T z\) by default." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a>
    </li>
    <li>
      <a href="../articles/binreg.html">Binomial Regression</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kkholst/mets/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cross-odds-ratio, OR or RR risk regression for competing risks</h1>
    <small class="dont-index">Source: <a href='https://github.com/kkholst/mets/blob/master/R/cor.R'><code>R/cor.R</code></a></small>
    <div class="hidden name"><code>cor.cif.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a parametric model for the log-cross-odds-ratio for the 
predictive effect of for the cumulative incidence curves for \(T_1\) 
experiencing cause i given that \(T_2\) has experienced a cause k :
$$
\log(COR(i|k))  =  h(\theta,z_1,i,z_2,k,t)=_{default}  \theta^T z =  
$$
with the log cross odds ratio being 
$$
COR(i|k) = 
\frac{O(T_1 \leq t,cause_1=i | T_2 \leq t,cause_2=k)}{
O(T_1 \leq t,cause_1=i)}  
$$
the conditional odds divided by the unconditional odds, with the odds
being, respectively 
$$
O(T_1 \leq t,cause_1=i | T_2 \leq t,cause_1=k) = 
\frac{
P_x(T_1 \leq t,cause_1=i | T_2 \leq t,cause_2=k)}{
P_x((T_1 \leq t,cause_1=i)^c | T_2 \leq t,cause_2=k)}
$$
and 
$$
O(T_1 \leq t,cause_1=i) = 
\frac{P_x(T_1 \leq t,cause_1=i )}{P_x((T_1 \leq t,cause_1=i)^c )}.
$$
Here \(B^c\) is the complement event of \(B\),
\(P_x\) is the distribution given covariates 
(\(x\) are subject specific and \(z\) are cluster specific covariates), and 
\(h()\) is a function that is the simple identity 
\(\theta^T z\) by default.</p>
    </div>

    <pre class="usage"><span class='fu'>cor.cif</span><span class='op'>(</span>
  <span class='va'>cif</span>,
  <span class='va'>data</span>,
  cause <span class='op'>=</span> <span class='cn'>NULL</span>,
  times <span class='op'>=</span> <span class='cn'>NULL</span>,
  cause1 <span class='op'>=</span> <span class='fl'>1</span>,
  cause2 <span class='op'>=</span> <span class='fl'>1</span>,
  cens.code <span class='op'>=</span> <span class='cn'>NULL</span>,
  cens.model <span class='op'>=</span> <span class='st'>"KM"</span>,
  Nit <span class='op'>=</span> <span class='fl'>40</span>,
  detail <span class='op'>=</span> <span class='fl'>0</span>,
  clusters <span class='op'>=</span> <span class='cn'>NULL</span>,
  theta <span class='op'>=</span> <span class='cn'>NULL</span>,
  theta.des <span class='op'>=</span> <span class='cn'>NULL</span>,
  step <span class='op'>=</span> <span class='fl'>1</span>,
  sym <span class='op'>=</span> <span class='fl'>0</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  par.func <span class='op'>=</span> <span class='cn'>NULL</span>,
  dpar.func <span class='op'>=</span> <span class='cn'>NULL</span>,
  dimpar <span class='op'>=</span> <span class='cn'>NULL</span>,
  score.method <span class='op'>=</span> <span class='st'>"nlminb"</span>,
  same.cens <span class='op'>=</span> <span class='cn'>FALSE</span>,
  censoring.weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  silent <span class='op'>=</span> <span class='fl'>1</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cif</th>
      <td><p>a model object from the comp.risk function with the 
marginal cumulative incidence of cause1, i.e., the event of interest, and whose
odds the comparision is compared to the conditional odds given cause2</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a data.frame with the variables.</p></td>
    </tr>
    <tr>
      <th>cause</th>
      <td><p>specifies the causes  related to the death
times, the value cens.code is the censoring value. When missing it comes from marginal cif.</p></td>
    </tr>
    <tr>
      <th>times</th>
      <td><p>time-vector that specifies the times used for the estimating euqations for the cross-odds-ratio estimation.</p></td>
    </tr>
    <tr>
      <th>cause1</th>
      <td><p>specificies the cause considered.</p></td>
    </tr>
    <tr>
      <th>cause2</th>
      <td><p>specificies the cause that is conditioned on.</p></td>
    </tr>
    <tr>
      <th>cens.code</th>
      <td><p>specificies the code for the censoring if NULL then uses the one from the marginal cif model.</p></td>
    </tr>
    <tr>
      <th>cens.model</th>
      <td><p>specified which model to use for the ICPW, KM is Kaplan-Meier alternatively it may be "cox"</p></td>
    </tr>
    <tr>
      <th>Nit</th>
      <td><p>number of iterations for Newton-Raphson algorithm.</p></td>
    </tr>
    <tr>
      <th>detail</th>
      <td><p>if 0 no details are printed during iterations, if 1 details are given.</p></td>
    </tr>
    <tr>
      <th>clusters</th>
      <td><p>specifies the cluster structure.</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>specifies starting values for the cross-odds-ratio parameters of the model.</p></td>
    </tr>
    <tr>
      <th>theta.des</th>
      <td><p>specifies a regression design for the cross-odds-ratio parameters.</p></td>
    </tr>
    <tr>
      <th>step</th>
      <td><p>specifies the step size for the Newton-Raphson algorithm.</p></td>
    </tr>
    <tr>
      <th>sym</th>
      <td><p>specifies if symmetry is used in the model.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>weights for estimating equations.</p></td>
    </tr>
    <tr>
      <th>par.func</th>
      <td><p>parfunc</p></td>
    </tr>
    <tr>
      <th>dpar.func</th>
      <td><p>dparfunc</p></td>
    </tr>
    <tr>
      <th>dimpar</th>
      <td><p>dimpar</p></td>
    </tr>
    <tr>
      <th>score.method</th>
      <td><p>"nlminb", can also use "nr".</p></td>
    </tr>
    <tr>
      <th>same.cens</th>
      <td><p>if true then censoring within clusters are assumed to be the same variable, default is independent censoring.</p></td>
    </tr>
    <tr>
      <th>censoring.weights</th>
      <td><p>these probabilities are used for the bivariate censoring dist.</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>1 to suppress output about convergence related issues.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Not used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns an object of type 'cor'. With the following arguments:</p>
<dt>theta</dt><dd><p>estimate of proportional odds parameters of model.</p></dd>
<dt>var.theta</dt><dd><p>variance for gamma.</p></dd>
<dt>hess</dt><dd><p>the derivative of the used score.</p></dd>
<dt>score</dt><dd><p>scores at final stage.</p></dd>
<dt>score</dt><dd><p>scores at final stage.</p></dd>
<dt>theta.iid</dt><dd><p>matrix of iid decomposition of parametric effects.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The OR dependence measure is given by 
$$
OR(i,k) = 
\log ( 
\frac{O(T_1 \leq t,cause_1=i | T_2 \leq t,cause_2=k)}{
O(T_1 \leq t,cause_1=i) | T_2 \leq t,cause_2=k)}  
$$
This measure is numerically more stabile than the COR measure, and is symetric in i,k.</p>
<p>The RR dependence measure is given by 
$$
RR(i,k) = 
\log ( 
\frac{P(T_1 \leq t,cause_1=i , T_2 \leq t,cause_2=k)}{
P(T_1 \leq t,cause_1=i) P(T_2 \leq t,cause_2=k)}  
$$
This measure is numerically more stabile than the COR measure, and is symetric in i,k.</p>
<p>The model is fitted under symmetry (sym=1), i.e., such that it is assumed 
that \(T_1\) and \(T_2\) can be interchanged and leads to
the same cross-odd-ratio (i.e.
\(COR(i|k) = COR(k|i))\), 
as would be expected for twins 
or without symmetry as might be the case with mothers and daughters (sym=0).</p>
<p>\(h()\) may be specified as an R-function of the parameters, 
see example below, but the default is that it is simply \(\theta^T z\).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Cross odds ratio Modelling of dependence for
Multivariate Competing Risks Data, Scheike and Sun (2012), Biostatistics.</p>
<p>A Semiparametric Random Effects Model for Multivariate Competing Risks Data,
Scheike, Zhang, Sun, Jensen (2010), Biometrika.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Thomas Scheike</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/scheike/timereg'>"timereg"</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>multcif</span><span class='op'>)</span>;
<span class='va'>multcif</span><span class='op'>$</span><span class='va'>cause</span><span class='op'>[</span><span class='va'>multcif</span><span class='op'>$</span><span class='va'>cause</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>
<span class='va'>zyg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span><span class='fl'>200</span>,<span class='fl'>1</span>,<span class='fl'>0.5</span><span class='op'>)</span>,each<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>theta.des</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>zyg</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>times</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.05</span>,<span class='fl'>1</span>,by<span class='op'>=</span><span class='fl'>0.05</span><span class='op'>)</span> <span class='co'># to speed up computations use only these time-points</span>
<span class='va'>add</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/timereg/man/comp.risk.html'>comp.risk</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/timereg/man/Event.html'>Event</a></span><span class='op'>(</span><span class='va'>time</span>,<span class='va'>cause</span><span class='op'>)</span><span class='op'>~</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'>cluster</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>multcif</span>,cause<span class='op'>=</span><span class='fl'>1</span>,
               n.sim<span class='op'>=</span><span class='fl'>0</span>,times<span class='op'>=</span><span class='va'>times</span>,model<span class='op'>=</span><span class='st'>"fg"</span>,max.clust<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='va'>add2</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/timereg/man/comp.risk.html'>comp.risk</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/timereg/man/Event.html'>Event</a></span><span class='op'>(</span><span class='va'>time</span>,<span class='va'>cause</span><span class='op'>)</span><span class='op'>~</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'>cluster</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>multcif</span>,cause<span class='op'>=</span><span class='fl'>2</span>,
               n.sim<span class='op'>=</span><span class='fl'>0</span>,times<span class='op'>=</span><span class='va'>times</span>,model<span class='op'>=</span><span class='st'>"fg"</span>,max.clust<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>

<span class='va'>out1</span><span class='op'>&lt;-</span><span class='fu'>cor.cif</span><span class='op'>(</span><span class='va'>add</span>,data<span class='op'>=</span><span class='va'>multcif</span>,cause1<span class='op'>=</span><span class='fl'>1</span>,cause2<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>out1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Cross odds ratio dependence for competing risks
#&gt; 
#&gt; Effect of cause1=1 on cause2=1 under symmetry=0
#&gt; 
#&gt;           log-Coef.   SE     z P-val Cross odds ratio   SE
#&gt; intercept      1.04 9.33 0.111 0.911             2.82 26.4
#&gt; </div><div class='input'>
<span class='va'>out2</span><span class='op'>&lt;-</span><span class='fu'>cor.cif</span><span class='op'>(</span><span class='va'>add</span>,data<span class='op'>=</span><span class='va'>multcif</span>,cause1<span class='op'>=</span><span class='fl'>1</span>,cause2<span class='op'>=</span><span class='fl'>1</span>,theta.des<span class='op'>=</span><span class='va'>theta.des</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>out2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Cross odds ratio dependence for competing risks
#&gt; 
#&gt; Effect of cause1=1 on cause2=1 under symmetry=0
#&gt; 
#&gt;              log-Coef.    SE      z P-val Cross odds ratio   SE
#&gt; factor(zyg)0     1.250 23.10 0.0540 0.957             3.49 80.8
#&gt; factor(zyg)1     0.883  8.88 0.0994 0.921             2.42 21.5
#&gt; </div><div class='input'>
<span class='co'>##out3&lt;-cor.cif(add,data=multcif,cause1=1,cause2=2,cif2=add2)</span>
<span class='co'>##summary(out3)</span>
<span class='co'>###########################################################</span>
<span class='co'># investigating further models using parfunc and dparfunc</span>
<span class='co'>###########################################################</span>
 <span class='co'>## Reduce Ex.Timings</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>prt</span><span class='op'>&lt;-</span><span class='fu'><a href='npc.html'>simnordic.random</a></span><span class='op'>(</span><span class='fl'>2000</span>,cordz<span class='op'>=</span><span class='fl'>2</span>,cormz<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>
<span class='va'>prt</span><span class='op'>$</span><span class='va'>status</span> <span class='op'>&lt;-</span><span class='va'>prt</span><span class='op'>$</span><span class='va'>cause</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>prt</span><span class='op'>$</span><span class='va'>status</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;    0    1    2 
#&gt; 2102  597 5301 </div><div class='input'>
<span class='va'>times</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>40</span>,<span class='fl'>100</span>,by<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>cifmod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/timereg/man/comp.risk.html'>comp.risk</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/timereg/man/Event.html'>Event</a></span><span class='op'>(</span><span class='va'>time</span>,<span class='va'>cause</span><span class='op'>)</span><span class='op'>~</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'>cluster</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>prt</span>,
                    cause<span class='op'>=</span><span class='fl'>1</span>,n.sim<span class='op'>=</span><span class='fl'>0</span>,
                    times<span class='op'>=</span><span class='va'>times</span>,conservative<span class='op'>=</span><span class='fl'>1</span>,max.clust<span class='op'>=</span><span class='cn'>NULL</span>,model<span class='op'>=</span><span class='st'>"fg"</span><span class='op'>)</span>
<span class='va'>theta.des</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>zyg</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>prt</span><span class='op'>)</span>

<span class='va'>parfunc</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>par</span>,<span class='va'>t</span>,<span class='va'>pardes</span><span class='op'>)</span>
<span class='op'>{</span>
<span class='va'>par</span> <span class='op'>&lt;-</span> <span class='va'>pardes</span> <span class='op'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>par</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,<span class='va'>par</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='va'>pardes</span> <span class='op'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='va'>par</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='va'>t</span><span class='op'>-</span><span class='fl'>60</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>12</span>,<span class='va'>par</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='va'>t</span><span class='op'>-</span><span class='fl'>60</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>12</span><span class='op'>)</span>
<span class='va'>par</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>parfunc</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>,<span class='fl'>1</span>,<span class='fl'>0.1</span>,<span class='fl'>1</span><span class='op'>)</span>,<span class='fl'>50</span>,<span class='va'>theta.des</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        [,1]
#&gt; 1 0.1666667
#&gt; 2 0.1666667
#&gt; 3 0.1666667
#&gt; 4 0.1666667
#&gt; 5 0.1666667
#&gt; 6 0.1666667</div><div class='input'>
<span class='va'>dparfunc</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>par</span>,<span class='va'>t</span>,<span class='va'>pardes</span><span class='op'>)</span>
<span class='op'>{</span>
<span class='va'>dpar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>pardes</span>, <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>pardes</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='op'>(</span><span class='va'>t</span><span class='op'>-</span><span class='fl'>60</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>12</span>,<span class='op'>(</span><span class='va'>t</span><span class='op'>-</span><span class='fl'>60</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>)</span>
<span class='va'>dpar</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>dparfunc</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>,<span class='fl'>1</span>,<span class='fl'>0.1</span>,<span class='fl'>1</span><span class='op'>)</span>,<span class='fl'>50</span>,<span class='va'>theta.des</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   factor(zyg)MZ factor(zyg)DZ factor(zyg)MZ factor(zyg)DZ
#&gt; 1             0             1             0    -0.8333333
#&gt; 2             0             1             0    -0.8333333
#&gt; 3             0             1             0    -0.8333333
#&gt; 4             0             1             0    -0.8333333
#&gt; 5             0             1             0    -0.8333333
#&gt; 6             0             1             0    -0.8333333</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>prt</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] "time"      "cause"     "x"         "country"   "id"        "cens"     
#&gt;  [7] "stime"     "entry"     "truncated" "zyg"       "status"   </div><div class='input'><span class='va'>or1</span> <span class='op'>&lt;-</span> <span class='fu'>or.cif</span><span class='op'>(</span><span class='va'>cifmod</span>,data<span class='op'>=</span><span class='va'>prt</span>,cause1<span class='op'>=</span><span class='fl'>1</span>,cause2<span class='op'>=</span><span class='fl'>1</span>,theta.des<span class='op'>=</span><span class='va'>theta.des</span>,
              same.cens<span class='op'>=</span><span class='cn'>TRUE</span>,theta<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.6</span>,<span class='fl'>1.1</span>,<span class='fl'>0.1</span>,<span class='fl'>0.1</span><span class='op'>)</span>,
              par.func<span class='op'>=</span><span class='va'>parfunc</span>,dpar.func<span class='op'>=</span><span class='va'>dparfunc</span>,dimpar<span class='op'>=</span><span class='fl'>4</span>,
              score.method<span class='op'>=</span><span class='st'>"nr"</span>,detail<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "Fisher-Scoring ===================: it= 1"
#&gt; theta:[1] 0.6 1.1 0.1 0.1
#&gt; score:[1]  4.4038139 -0.5697823 11.6772977 -1.6949449
#&gt; hess:          [,1]      [,2]       [,3]       [,4]
#&gt; [1,] -2.380951  0.000000  -6.184041   0.000000
#&gt; [2,]  0.000000 -3.262648   0.000000  -8.285154
#&gt; [3,] -6.184041  0.000000 -17.409502   0.000000
#&gt; [4,]  0.000000 -8.285154   0.000000 -23.052048
#&gt; [1] "Fisher-Scoring ===================: it= 2"
#&gt; theta:[1]  1.98846483  1.23830300  0.27754527 -0.02323445
#&gt; score:[1] -1.25603525 -0.01146766 -2.79344744 -0.04626783
#&gt; hess:          [,1]      [,2]       [,3]       [,4]
#&gt; [1,] -3.955147  0.000000  -9.393342   0.000000
#&gt; [2,]  0.000000 -3.009163   0.000000  -7.530575
#&gt; [3,] -9.393342  0.000000 -25.237970   0.000000
#&gt; [4,]  0.000000 -7.530575   0.000000 -20.789841
#&gt; [1] "Fisher-Scoring ===================: it= 3"
#&gt; theta:[1]  1.51716907  1.25710704  0.34227293 -0.03227122
#&gt; score:[1]  0.0084015704  0.0001720174  0.0266071031 -0.0006890359
#&gt; hess:          [,1]      [,2]       [,3]       [,4]
#&gt; [1,] -3.976728  0.000000  -9.711857   0.000000
#&gt; [2,]  0.000000 -3.004696   0.000000  -7.507249
#&gt; [3,] -9.711857  0.000000 -26.396636   0.000000
#&gt; [4,]  0.000000 -7.507249   0.000000 -20.707731
#&gt; [1] "Fisher-Scoring ===================: it= 4"
#&gt; theta:[1]  1.51373019  1.25859721  0.34454613 -0.03284473
#&gt; score:[1]  1.000423e-04  1.638102e-05  2.675999e-04 -3.827783e-05
#&gt; hess:          [,1]      [,2]       [,3]       [,4]
#&gt; [1,] -3.974979  0.000000  -9.707329   0.000000
#&gt; [2,]  0.000000 -3.004947   0.000000  -7.507026
#&gt; [3,] -9.707329  0.000000 -26.382387   0.000000
#&gt; [4,]  0.000000 -7.507026   0.000000 -20.705898
#&gt; [1] "Fisher-Scoring ===================: it= 5"
#&gt; theta:[1]  1.51373411  1.25870404  0.34455484 -0.03288532
#&gt; score:[1]  8.055071e-08  1.179946e-06  1.314044e-06 -2.699063e-06
#&gt; hess:          [,1]      [,2]       [,3]       [,4]
#&gt; [1,] -3.974972  0.000000  -9.707299   0.000000
#&gt; [2,]  0.000000 -3.004967   0.000000  -7.507016
#&gt; [3,] -9.707299  0.000000 -26.382278   0.000000
#&gt; [4,]  0.000000 -7.507016   0.000000 -20.705785
#&gt; [1] "Fisher-Scoring ===================: it= 6"
#&gt; theta:[1]  1.51373311  1.25871166  0.34455525 -0.03288821
#&gt; score:[1]  1.926553e-08  8.694846e-08  3.069134e-08 -1.875468e-07
#&gt; hess:          [,1]      [,2]       [,3]       [,4]
#&gt; [1,] -3.974972  0.000000  -9.707298   0.000000
#&gt; [2,]  0.000000 -3.004969   0.000000  -7.507015
#&gt; [3,] -9.707298  0.000000 -26.382277   0.000000
#&gt; [4,]  0.000000 -7.507015   0.000000 -20.705777</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>or1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; OR for dependence for competing risks
#&gt; 
#&gt; OR of cumulative incidence for cause1= 1  and cause2= 1
#&gt;        log-ratio Coef.    SE      z    P-val Ratio    SE
#&gt; R-func          1.5100 0.348  4.350 1.39e-05 4.540 1.580
#&gt; R-func          1.2600 0.408  3.090 2.03e-03 3.520 1.440
#&gt; R-func          0.3450 0.129  2.680 7.43e-03 1.410 0.182
#&gt; R-func         -0.0329 0.111 -0.296 7.67e-01 0.968 0.107
#&gt; </div><div class='input'>
 <span class='va'>cor1</span> <span class='op'>&lt;-</span> <span class='fu'>cor.cif</span><span class='op'>(</span><span class='va'>cifmod</span>,data<span class='op'>=</span><span class='va'>prt</span>,cause1<span class='op'>=</span><span class='fl'>1</span>,cause2<span class='op'>=</span><span class='fl'>1</span>,theta.des<span class='op'>=</span><span class='va'>theta.des</span>,
                 same.cens<span class='op'>=</span><span class='cn'>TRUE</span>,theta<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>,<span class='fl'>1.0</span>,<span class='fl'>0.1</span>,<span class='fl'>0.1</span><span class='op'>)</span>,
                 par.func<span class='op'>=</span><span class='va'>parfunc</span>,dpar.func<span class='op'>=</span><span class='va'>dparfunc</span>,dimpar<span class='op'>=</span><span class='fl'>4</span>,
                 control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>trace<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>,detail<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   0:     764.39429: 0.500000  1.00000 0.100000 0.100000
#&gt;   1:     760.41547: 0.638110 0.960514 0.467772 -0.0132205
#&gt;   2:     760.40387: 0.653395 0.974160 0.451036 0.0181985
#&gt;   3:     760.38389: 0.690757 0.972238 0.448591 0.00142104
#&gt;   4:     760.37606: 0.718637 0.978903 0.420008 0.00837748
#&gt;   5:     760.25920:  1.06308  1.01089 0.300306 -0.0207997
#&gt;   6:     760.25068:  1.17095  1.03357 0.291057 0.00476415
#&gt;   7:     760.21955:  1.26957  1.04549 0.238342 -0.0108132
#&gt;   8:     760.21001:  1.37413  1.06352 0.203103 -0.0305819
#&gt;   9:     760.20960:  1.45522  1.09168 0.167526 -0.0343140
#&gt;  10:     760.20850:  1.41964  1.09024 0.182566 -0.0388281
#&gt;  11:     760.20845:  1.41813  1.09721 0.183339 -0.0412570
#&gt;  12:     760.20842:  1.41722  1.11055 0.183672 -0.0460117
#&gt;  13:     760.20842:  1.41733  1.11051 0.183623 -0.0459848
#&gt; $par
#&gt; [1]  1.41733324  1.11051386  0.18362322 -0.04598481
#&gt; 
#&gt; $objective
#&gt; [1] 760.2084
#&gt; 
#&gt; $convergence
#&gt; [1] 0
#&gt; 
#&gt; $iterations
#&gt; [1] 13
#&gt; 
#&gt; $evaluations
#&gt; function gradient 
#&gt;       19       71 
#&gt; 
#&gt; $message
#&gt; [1] "relative convergence (4)"
#&gt; 
#&gt; iid decomposition</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>cor1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Cross odds ratio dependence for competing risks
#&gt; 
#&gt; Effect of cause1=1 on cause2=1 under symmetry=0
#&gt; 
#&gt;        log-Coef.   SE        z P-val Cross odds ratio  SE
#&gt; R-func     1.420 66.5  0.02130 0.983            4.130 274
#&gt; R-func     1.110 71.4  0.01560 0.988            3.040 217
#&gt; R-func     0.184 23.3  0.00789 0.994            1.200  28
#&gt; R-func    -0.046 22.0 -0.00209 0.998            0.955  21
#&gt; </div><div class='input'>
<span class='co'>### piecewise contant OR model</span>
<span class='va'>gparfunc</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>par</span>,<span class='va'>t</span>,<span class='va'>pardes</span><span class='op'>)</span>
<span class='op'>{</span>
  <span class='va'>cuts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>80</span>,<span class='fl'>90</span>,<span class='fl'>120</span><span class='op'>)</span>
  <span class='va'>grop</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>&lt;</span><span class='va'>cuts</span><span class='op'>)</span>
<span class='va'>paru</span>  <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>pardes</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>grop</span><span class='op'>*</span><span class='va'>par</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='op'>(</span><span class='va'>pardes</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>grop</span><span class='op'>*</span><span class='va'>par</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>paru</span>
<span class='op'>}</span>

<span class='va'>dgparfunc</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>par</span>,<span class='va'>t</span>,<span class='va'>pardes</span><span class='op'>)</span>
<span class='op'>{</span>
  <span class='va'>cuts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>80</span>,<span class='fl'>90</span>,<span class='fl'>120</span><span class='op'>)</span>
  <span class='va'>grop</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>&lt;</span><span class='va'>cuts</span><span class='op'>)</span>
<span class='va'>par1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>grop</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>pardes</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>grop</span><span class='op'>)</span>,byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>parmz</span> <span class='op'>&lt;-</span> <span class='va'>par1</span><span class='op'>*</span> <span class='op'>(</span><span class='va'>pardes</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>pardz</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>pardes</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>par1</span>
<span class='va'>dpar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span> <span class='va'>parmz</span>,<span class='va'>pardz</span><span class='op'>)</span>
<span class='va'>dpar</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>dgparfunc</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0.1</span>,<span class='fl'>6</span><span class='op'>)</span>,<span class='fl'>50</span>,<span class='va'>theta.des</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]
#&gt; [1,]    0    0    0    1    0    0
#&gt; [2,]    0    0    0    1    0    0
#&gt; [3,]    0    0    0    1    0    0
#&gt; [4,]    0    0    0    1    0    0
#&gt; [5,]    0    0    0    1    0    0
#&gt; [6,]    0    0    0    1    0    0</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>gparfunc</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0.1</span>,<span class='fl'>6</span><span class='op'>)</span>,<span class='fl'>50</span>,<span class='va'>theta.des</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   1   2   3   4   5   6 
#&gt; 0.1 0.1 0.1 0.1 0.1 0.1 </div><div class='input'>
<span class='va'>or1g</span> <span class='op'>&lt;-</span> <span class='fu'>or.cif</span><span class='op'>(</span><span class='va'>cifmod</span>,data<span class='op'>=</span><span class='va'>prt</span>,cause1<span class='op'>=</span><span class='fl'>1</span>,cause2<span class='op'>=</span><span class='fl'>1</span>,
               theta.des<span class='op'>=</span><span class='va'>theta.des</span>, same.cens<span class='op'>=</span><span class='cn'>TRUE</span>,
               par.func<span class='op'>=</span><span class='va'>gparfunc</span>,dpar.func<span class='op'>=</span><span class='va'>dgparfunc</span>,
               dimpar<span class='op'>=</span><span class='fl'>6</span>,score.method<span class='op'>=</span><span class='st'>"nr"</span>,detail<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "Fisher-Scoring ===================: it= 1"
#&gt; theta:[1] 0.1 0.1 0.1 0.1 0.1 0.1
#&gt; score:[1] 0.1272695 0.6721568 3.2995329 0.1193734 0.3414362 1.1416387
#&gt; hess:            [,1]       [,2]       [,3]        [,4]       [,5]       [,6]
#&gt; [1,] -0.05264815  0.0000000  0.0000000  0.00000000  0.0000000  0.0000000
#&gt; [2,]  0.00000000 -0.2202109  0.0000000  0.00000000  0.0000000  0.0000000
#&gt; [3,]  0.00000000  0.0000000 -0.8603209  0.00000000  0.0000000  0.0000000
#&gt; [4,]  0.00000000  0.0000000  0.0000000 -0.05264815  0.0000000  0.0000000
#&gt; [5,]  0.00000000  0.0000000  0.0000000  0.00000000 -0.2202109  0.0000000
#&gt; [6,]  0.00000000  0.0000000  0.0000000  0.00000000  0.0000000 -0.8603209
#&gt; [1] "Fisher-Scoring ===================: it= 2"
#&gt; theta:[1] 2.517359 3.152333 3.935235 2.367380 1.650497 1.426992
#&gt; score:[1] -0.4338385 -1.0147952 -2.5460328 -0.3722739 -0.3313216 -0.7014266
#&gt; hess:           [,1]       [,2]      [,3]       [,4]       [,5]      [,6]
#&gt; [1,] -0.4976024  0.0000000  0.000000  0.0000000  0.0000000  0.000000
#&gt; [2,]  0.0000000 -0.8549108  0.000000  0.0000000  0.0000000  0.000000
#&gt; [3,]  0.0000000  0.0000000 -1.600519  0.0000000  0.0000000  0.000000
#&gt; [4,]  0.0000000  0.0000000  0.000000 -0.4751796  0.0000000  0.000000
#&gt; [5,]  0.0000000  0.0000000  0.000000  0.0000000 -0.8248922  0.000000
#&gt; [6,]  0.0000000  0.0000000  0.000000  0.0000000  0.0000000 -2.408282
#&gt; [1] "Fisher-Scoring ===================: it= 3"
#&gt; theta:[1] 1.645501 1.965314 2.344480 1.583942 1.248842 1.135736
#&gt; score:[1] -0.02982301  0.04411757  0.63062528 -0.02738202 -0.01381586 -0.01990217
#&gt; hess:           [,1]       [,2]      [,3]      [,4]       [,5]      [,6]
#&gt; [1,] -0.3202401  0.0000000  0.000000  0.000000  0.0000000  0.000000
#&gt; [2,]  0.0000000 -0.9097494  0.000000  0.000000  0.0000000  0.000000
#&gt; [3,]  0.0000000  0.0000000 -2.766973  0.000000  0.0000000  0.000000
#&gt; [4,]  0.0000000  0.0000000  0.000000 -0.305418  0.0000000  0.000000
#&gt; [5,]  0.0000000  0.0000000  0.000000  0.000000 -0.6707065  0.000000
#&gt; [6,]  0.0000000  0.0000000  0.000000  0.000000  0.0000000 -2.098342
#&gt; [1] "Fisher-Scoring ===================: it= 4"
#&gt; theta:[1] 1.552374 2.013808 2.572392 1.494288 1.228243 1.126251
#&gt; score:[1] -4.297265e-04 -1.168387e-04  3.731022e-03 -5.158182e-04 -4.497369e-05
#&gt; [6]  2.253821e-06
#&gt; hess:           [,1]       [,2]      [,3]       [,4]       [,5]      [,6]
#&gt; [1,] -0.2978324  0.0000000  0.000000  0.0000000  0.0000000  0.000000
#&gt; [2,]  0.0000000 -0.9191812  0.000000  0.0000000  0.0000000  0.000000
#&gt; [3,]  0.0000000  0.0000000 -2.695765  0.0000000  0.0000000  0.000000
#&gt; [4,]  0.0000000  0.0000000  0.000000 -0.2839372  0.0000000  0.000000
#&gt; [5,]  0.0000000  0.0000000  0.000000  0.0000000 -0.6619257  0.000000
#&gt; [6,]  0.0000000  0.0000000  0.000000  0.0000000  0.0000000 -2.087228
#&gt; [1] "Fisher-Scoring ===================: it= 5"
#&gt; theta:[1] 1.550931 2.013681 2.573776 1.492471 1.228175 1.126252
#&gt; score:[1]  1.116180e-06 -7.347215e-10  1.587856e-06 -1.109826e-06 -4.893145e-10
#&gt; [6] -4.601634e-09
#&gt; hess:           [,1]       [,2]      [,3]       [,4]       [,5]     [,6]
#&gt; [1,] -0.2974862  0.0000000  0.000000  0.0000000  0.0000000  0.00000
#&gt; [2,]  0.0000000 -0.9191578  0.000000  0.0000000  0.0000000  0.00000
#&gt; [3,]  0.0000000  0.0000000 -2.695165  0.0000000  0.0000000  0.00000
#&gt; [4,]  0.0000000  0.0000000  0.000000 -0.2835044  0.0000000  0.00000
#&gt; [5,]  0.0000000  0.0000000  0.000000  0.0000000 -0.6618966  0.00000
#&gt; [6,]  0.0000000  0.0000000  0.000000  0.0000000  0.0000000 -2.08723
#&gt; [1] "Fisher-Scoring ===================: it= 6"
#&gt; theta:[1] 1.550935 2.013681 2.573776 1.492467 1.228175 1.126252
#&gt; score:[1] -2.846686e-09 -3.398974e-15 -1.035387e-10 -1.750221e-09 -1.311451e-15
#&gt; [6]  3.469968e-09
#&gt; hess:           [,1]       [,2]      [,3]       [,4]       [,5]     [,6]
#&gt; [1,] -0.2974871  0.0000000  0.000000  0.0000000  0.0000000  0.00000
#&gt; [2,]  0.0000000 -0.9191578  0.000000  0.0000000  0.0000000  0.00000
#&gt; [3,]  0.0000000  0.0000000 -2.695165  0.0000000  0.0000000  0.00000
#&gt; [4,]  0.0000000  0.0000000  0.000000 -0.2835035  0.0000000  0.00000
#&gt; [5,]  0.0000000  0.0000000  0.000000  0.0000000 -0.6618966  0.00000
#&gt; [6,]  0.0000000  0.0000000  0.000000  0.0000000  0.0000000 -2.08723</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>or1g</span><span class='op'>)</span>
</div><div class='output co'>#&gt; OR for dependence for competing risks
#&gt; 
#&gt; OR of cumulative incidence for cause1= 1  and cause2= 1
#&gt;        log-ratio Coef.    SE    z    P-val Ratio    SE
#&gt; R-func            1.55 0.362 4.28 1.87e-05  4.72 1.710
#&gt; R-func            2.01 0.325 6.20 5.64e-10  7.49 2.430
#&gt; R-func            2.57 0.352 7.31 2.71e-13 13.10 4.620
#&gt; R-func            1.49 0.369 4.05 5.12e-05  4.45 1.640
#&gt; R-func            1.23 0.307 3.99 6.49e-05  3.41 1.050
#&gt; R-func            1.13 0.274 4.11 4.01e-05  3.08 0.846
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>or1g</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] "theta"      "score"      "hess"       "hessi"      "var.theta" 
#&gt;  [6] "theta.iid"  "score1"     "thetanames" "brierscore" "p11"       
#&gt; [11] "call"      </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>or1g</span><span class='op'>$</span><span class='va'>theta.iid</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      [,1] [,2] [,3]         [,4]         [,5]         [,6]
#&gt; [1,]    0    0    0 0.0007341431 0.0008025713 0.0008395676
#&gt; [2,]    0    0    0 0.0007341431 0.0008025713 0.0008395676
#&gt; [3,]    0    0    0 0.0007341431 0.0008025713 0.0008395676
#&gt; [4,]    0    0    0 0.0007341431 0.0008025713 0.0008395676
#&gt; [5,]    0    0    0 0.0007341431 0.0008025713 0.0008395676
#&gt; [6,]    0    0    0 0.0007341431 0.0008025713 0.0008395676</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



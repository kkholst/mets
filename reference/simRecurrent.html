<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulation of recurrent events data based on cumulative hazards — simRecurrent • mets</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation of recurrent events data based on cumulative hazards — simRecurrent"><meta property="og:description" content="Simulation of recurrent events data based on cumulative hazards"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a>
    </li>
    <li>
      <a href="../articles/binreg.html">Binomial Regression</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/mediation-survival.html">Mediation Analysis for survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kkholst/mets/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulation of recurrent events data based on cumulative hazards</h1>
    <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/HEAD/R/recurrent.marginal.R" class="external-link"><code>R/recurrent.marginal.R</code></a></small>
    <div class="hidden name"><code>simRecurrent.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulation of recurrent events data based on cumulative hazards</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simRecurrent</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">cumhaz</span>,</span>
<span>  death.cumhaz <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gap.time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cens <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max.recurrent <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  dhaz <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dependence <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  var.z <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  cor.mat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n</dt>
<dd><p>number of id's</p></dd>


<dt>cumhaz</dt>
<dd><p>cumulative hazard of recurrent events</p></dd>


<dt>death.cumhaz</dt>
<dd><p>cumulative hazard of death</p></dd>


<dt>gap.time</dt>
<dd><p>if true simulates gap-times with specified cumulative hazard</p></dd>


<dt>cens</dt>
<dd><p>rate of exponential on total time i.e. on death time-scale</p></dd>


<dt>max.recurrent</dt>
<dd><p>limits number recurrent events to 100</p></dd>


<dt>dhaz</dt>
<dd><p>rate for death hazard if it is extended to time-range of first event</p></dd>


<dt>dependence</dt>
<dd><p>=0 independence, =1 all share same random effect with variance var.z
=2 random effect exp(normal) with correlation structure from cor.mat,
first random effect is z1 and shared for a possible second cause,  second random effect is for death</p></dd>


<dt>var.z</dt>
<dd><p>variance of random effects</p></dd>


<dt>cor.mat</dt>
<dd><p>correlation matrix for var.z variance of random effects</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to lower level funtions</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Must give hazard of death and recurrent events.  Possible with two
event types and their dependence can be specified but the two recurrent events need
to have the same random effect,  simRecurrentII more flexible !</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Thomas Scheike</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">########################################</span></span></span>
<span class="r-in"><span><span class="co">## getting some rates to mimick </span></span></span>
<span class="r-in"><span><span class="co">########################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">base1cumhaz</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">base4cumhaz</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">drcumhaz</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dr</span> <span class="op">&lt;-</span> <span class="va">drcumhaz</span></span></span>
<span class="r-in"><span><span class="va">base1</span> <span class="op">&lt;-</span> <span class="va">base1cumhaz</span></span></span>
<span class="r-in"><span><span class="va">base4</span> <span class="op">&lt;-</span> <span class="va">base4cumhaz</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">######################################################################</span></span></span>
<span class="r-in"><span> <span class="co">### simulating simple model that mimicks data </span></span></span>
<span class="r-in"><span> <span class="co">######################################################################</span></span></span>
<span class="r-in"><span> <span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu">simRecurrent</span><span class="op">(</span><span class="fl">5</span>,<span class="va">base1</span>,death.cumhaz<span class="op">=</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="dprint.html">dlist</a></span><span class="op">(</span><span class="va">rr</span>,<span class="va">.</span><span class="op">~</span><span class="va">id</span>,n<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        entry      time status rr dtime fdeath death     start      stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     0.0000  700.2429      1  1  5110      0     0    0.0000  700.2429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   700.2429 1023.7144      1  1  5110      0     0  700.2429 1023.7144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1023.7144 4309.6162      1  1  5110      0     0 1023.7144 4309.6162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 4309.6162 4729.7660      1  1  5110      0     0 4309.6162 4729.7660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 4729.7660 5055.9305      1  1  5110      0     0 4729.7660 5055.9305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 5055.9305 5110.0000      0  1  5110      0     0 5055.9305 5110.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   entry     time status rr    dtime fdeath death start     stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     0 92.24233      0  1 92.24233      1     1     0 92.24233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        entry      time status rr    dtime fdeath death     start      stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     0.0000  123.1363      1  1 4524.306      1     0    0.0000  123.1363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   123.1363  199.2410      1  1 4524.306      1     0  123.1363  199.2410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  199.2410  407.8600      1  1 4524.306      1     0  199.2410  407.8600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  407.8600  448.5487      1  1 4524.306      1     0  407.8600  448.5487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  448.5487  966.7833      1  1 4524.306      1     0  448.5487  966.7833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  966.7833 1355.4121      1  1 4524.306      1     0  966.7833 1355.4121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 1355.4121 1424.7372      1  1 4524.306      1     0 1355.4121 1424.7372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 1424.7372 3314.7225      1  1 4524.306      1     0 1424.7372 3314.7225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 3314.7225 4203.5515      1  1 4524.306      1     0 3314.7225 4203.5515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 4203.5515 4524.3062      0  1 4524.306      1     1 4203.5515 4524.3062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        entry      time status rr dtime fdeath death     start      stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     0.0000  402.1773      1  1  5110      0     0    0.0000  402.1773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   402.1773  643.7118      1  1  5110      0     0  402.1773  643.7118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  643.7118  869.4682      1  1  5110      0     0  643.7118  869.4682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  869.4682 1100.4241      1  1  5110      0     0  869.4682 1100.4241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 1100.4241 1252.8515      1  1  5110      0     0 1100.4241 1252.8515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 1252.8515 1766.8568      1  1  5110      0     0 1252.8515 1766.8568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 1766.8568 2168.9370      1  1  5110      0     0 1766.8568 2168.9370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 2168.9370 2170.8310      1  1  5110      0     0 2168.9370 2170.8310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 2170.8310 2203.1275      1  1  5110      0     0 2170.8310 2203.1275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 2203.1275 2311.2489      1  1  5110      0     0 2203.1275 2311.2489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 2311.2489 2494.9235      1  1  5110      0     0 2311.2489 2494.9235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 2494.9235 2557.7508      1  1  5110      0     0 2494.9235 2557.7508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 2557.7508 5110.0000      0  1  5110      0     0 2557.7508 5110.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        entry      time status rr dtime fdeath death     start      stop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     0.0000  112.1676      1  1  5110      0     0    0.0000  112.1676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   112.1676  146.8774      1  1  5110      0     0  112.1676  146.8774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  146.8774  936.5330      1  1  5110      0     0  146.8774  936.5330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  936.5330 1767.2592      1  1  5110      0     0  936.5330 1767.2592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 1767.2592 3221.7391      1  1  5110      0     0 1767.2592 3221.7391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 3221.7391 3278.5433      1  1  5110      0     0 3221.7391 3278.5433</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 3278.5433 3578.0894      1  1  5110      0     0 3278.5433 3578.0894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 3578.0894 4594.5605      1  1  5110      0     0 3578.0894 4594.5605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 4594.5605 5110.0000      0  1  5110      0     0 4594.5605 5110.0000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu">simRecurrent</span><span class="op">(</span><span class="fl">1000</span>,<span class="va">base1</span>,death.cumhaz<span class="op">=</span><span class="va">dr</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu">showfitsim</span><span class="op">(</span>causes<span class="op">=</span><span class="fl">1</span>,<span class="va">rr</span>,<span class="va">dr</span>,<span class="va">base1</span>,<span class="va">base1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################################################################</span></span></span>
<span class="r-in"><span><span class="co">### simulating simple model </span></span></span>
<span class="r-in"><span><span class="co">### random effect for all causes (Z shared for death and recurrent) </span></span></span>
<span class="r-in"><span><span class="co">######################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">rr</span> <span class="op">&lt;-</span> <span class="fu">simRecurrent</span><span class="op">(</span><span class="fl">1000</span>,<span class="va">base1</span>,death.cumhaz<span class="op">=</span><span class="va">dr</span>,dependence<span class="op">=</span><span class="fl">1</span>,var.gamma<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co">### marginals do fit after input after integrating out</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="simRecurrent-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="fu">showfitsim</span><span class="op">(</span>causes<span class="op">=</span><span class="fl">1</span>,<span class="va">rr</span>,<span class="va">dr</span>,<span class="va">base1</span>,<span class="va">base1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-plt img"><img src="simRecurrent-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>


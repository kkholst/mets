<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulation of recurrent events data based on cumulative hazards — simRecurrent • mets</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulation of recurrent events data based on cumulative hazards — simRecurrent" />
<meta property="og:description" content="Simulation of recurrent events data based on cumulative hazards" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a>
    </li>
    <li>
      <a href="../articles/binreg.html">Binomial Regression</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kkholst/mets/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulation of recurrent events data based on cumulative hazards</h1>
    <small class="dont-index">Source: <a href='https://github.com/kkholst/mets/blob/master/R/recurrent.marginal.R'><code>R/recurrent.marginal.R</code></a></small>
    <div class="hidden name"><code>simRecurrent.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulation of recurrent events data based on cumulative hazards</p>
    </div>

    <pre class="usage"><span class='fu'>simRecurrent</span><span class='op'>(</span>
  <span class='va'>n</span>,
  <span class='va'>cumhaz</span>,
  death.cumhaz <span class='op'>=</span> <span class='cn'>NULL</span>,
  cumhaz2 <span class='op'>=</span> <span class='cn'>NULL</span>,
  gap.time <span class='op'>=</span> <span class='cn'>FALSE</span>,
  max.recurrent <span class='op'>=</span> <span class='fl'>100</span>,
  dhaz <span class='op'>=</span> <span class='cn'>NULL</span>,
  haz2 <span class='op'>=</span> <span class='cn'>NULL</span>,
  dependence <span class='op'>=</span> <span class='fl'>0</span>,
  var.z <span class='op'>=</span> <span class='fl'>2</span>,
  cor.mat <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>number of id's</p></td>
    </tr>
    <tr>
      <th>cumhaz</th>
      <td><p>cumulative hazard of recurrent events</p></td>
    </tr>
    <tr>
      <th>death.cumhaz</th>
      <td><p>cumulative hazard of death</p></td>
    </tr>
    <tr>
      <th>cumhaz2</th>
      <td><p>cumulative hazard of recurrent events  of type 2</p></td>
    </tr>
    <tr>
      <th>gap.time</th>
      <td><p>if true simulates gap-times with specified cumulative hazard</p></td>
    </tr>
    <tr>
      <th>max.recurrent</th>
      <td><p>limits number recurrent events to 100</p></td>
    </tr>
    <tr>
      <th>dhaz</th>
      <td><p>rate for death hazard if it is extended to time-range of first event</p></td>
    </tr>
    <tr>
      <th>haz2</th>
      <td><p>rate of second cause  if it is extended to time-range of first event</p></td>
    </tr>
    <tr>
      <th>dependence</th>
      <td><p>=0 independence, =1 all share same random effect with variance var.z
=2 random effect exp(normal) with correlation structure from cor.mat,
first random effect is z1 and shared for a possible second cause,  second random effect is for death</p></td>
    </tr>
    <tr>
      <th>var.z</th>
      <td><p>variance of random effects</p></td>
    </tr>
    <tr>
      <th>cor.mat</th>
      <td><p>correlation matrix for var.z variance of random effects</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to lower level funtions</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Must give hazard of death and recurrent events.  Possible with two
event types and their dependence can be specified but the two recurrent events need
to have the same random effect,  simRecurrentII more flexible !</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Thomas Scheike</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>########################################</span>
<span class='co'>## getting some rates to mimick </span>
<span class='co'>########################################</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>base1cumhaz</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>base4cumhaz</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>drcumhaz</span><span class='op'>)</span>
<span class='va'>dr</span> <span class='op'>&lt;-</span> <span class='va'>drcumhaz</span>
<span class='va'>base1</span> <span class='op'>&lt;-</span> <span class='va'>base1cumhaz</span>
<span class='va'>base4</span> <span class='op'>&lt;-</span> <span class='va'>base4cumhaz</span>

 <span class='co'>######################################################################</span>
 <span class='co'>### simulating simple model that mimicks data </span>
 <span class='co'>######################################################################</span>
 <span class='va'>rr</span> <span class='op'>&lt;-</span> <span class='fu'>simRecurrent</span><span class='op'>(</span><span class='fl'>5</span>,<span class='va'>base1</span>,death.cumhaz<span class='op'>=</span><span class='va'>dr</span><span class='op'>)</span>
 <span class='fu'><a href='dprint.html'>dlist</a></span><span class='op'>(</span><span class='va'>rr</span>,<span class='va'>.</span><span class='op'>~</span><span class='va'>id</span>,n<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>
</div><div class='output co'>#&gt; id: 1
#&gt;       entry     time status rr    dtime fdeath death    start     stop
#&gt; 1    0.0000 258.8925      1  1 993.7701      1     0   0.0000 258.8925
#&gt; 6  258.8925 279.4397      1  1 993.7701      1     0 258.8925 279.4397
#&gt; 10 279.4397 329.1969      1  1 993.7701      1     0 279.4397 329.1969
#&gt; 13 329.1969 854.5010      1  1 993.7701      1     0 329.1969 854.5010
#&gt; 15 854.5010 993.7701      0  1 993.7701      1     1 854.5010 993.7701
#&gt; ------------------------------------------------------------ 
#&gt; id: 2
#&gt;        entry      time status rr    dtime fdeath death     start      stop
#&gt; 2     0.0000  429.2894      1  1 3537.906      1     0    0.0000  429.2894
#&gt; 7   429.2894  442.5034      1  1 3537.906      1     0  429.2894  442.5034
#&gt; 11  442.5034 1489.4541      1  1 3537.906      1     0  442.5034 1489.4541
#&gt; 14 1489.4541 2920.9537      1  1 3537.906      1     0 1489.4541 2920.9537
#&gt; 16 2920.9537 3537.9057      0  1 3537.906      1     1 2920.9537 3537.9057
#&gt; ------------------------------------------------------------ 
#&gt; id: 3
#&gt;   entry     time status rr    dtime fdeath death start     stop
#&gt; 3     0 58.05421      0  1 58.05421      1     1     0 58.05421
#&gt; ------------------------------------------------------------ 
#&gt; id: 4
#&gt;       entry      time status rr    dtime fdeath death    start      stop
#&gt; 4    0.0000  201.2586      1  1 1196.455      1     0   0.0000  201.2586
#&gt; 8  201.2586  459.4113      1  1 1196.455      1     0 201.2586  459.4113
#&gt; 12 459.4113 1196.4548      0  1 1196.455      1     1 459.4113 1196.4548
#&gt; ------------------------------------------------------------ 
#&gt; id: 5
#&gt;      entry      time status rr    dtime fdeath death    start      stop
#&gt; 5   0.0000  786.6433      1  1 1066.173      1     0   0.0000  786.6433
#&gt; 9 786.6433 1066.1732      0  1 1066.173      1     1 786.6433 1066.1732</div><div class='input'>
 <span class='va'>rr</span> <span class='op'>&lt;-</span> <span class='fu'>simRecurrent</span><span class='op'>(</span><span class='fl'>1000</span>,<span class='va'>base1</span>,death.cumhaz<span class='op'>=</span><span class='va'>dr</span><span class='op'>)</span>
 <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
 <span class='fu'>showfitsim</span><span class='op'>(</span>causes<span class='op'>=</span><span class='fl'>1</span>,<span class='va'>rr</span>,<span class='va'>dr</span>,<span class='va'>base1</span>,<span class='va'>base1</span><span class='op'>)</span>

<span class='co'>######################################################################</span>
<span class='co'>### simulating simple model that mimicks data </span>
<span class='co'>### now with two event types and second type has same rate as death rate</span>
<span class='co'>######################################################################</span>

 <span class='va'>rr</span> <span class='op'>&lt;-</span> <span class='fu'>simRecurrent</span><span class='op'>(</span><span class='fl'>1000</span>,<span class='va'>base1</span>,death.cumhaz<span class='op'>=</span><span class='va'>dr</span>,cumhaz2<span class='op'>=</span><span class='va'>base4</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: collapsing to unique 'x' values</span></div><div class='input'> <span class='fu'><a href='dtable.html'>dtable</a></span><span class='op'>(</span><span class='va'>rr</span>,<span class='op'>~</span><span class='va'>death</span><span class='op'>+</span><span class='va'>status</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;       status    0    1    2
#&gt; death                      
#&gt; 0             108 2768  365
#&gt; 1             892    0    0</div><div class='input'> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='simRecurrent-1.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>showfitsim</span><span class='op'>(</span>causes<span class='op'>=</span><span class='fl'>2</span>,<span class='va'>rr</span>,<span class='va'>dr</span>,<span class='va'>base1</span>,<span class='va'>base4</span><span class='op'>)</span>

<span class='co'>######################################################################</span>
<span class='co'>### simulating simple model </span>
<span class='co'>### random effect for all causes (Z shared for death and recurrent) </span>
<span class='co'>######################################################################</span>

 <span class='va'>rr</span> <span class='op'>&lt;-</span> <span class='fu'>simRecurrent</span><span class='op'>(</span><span class='fl'>1000</span>,<span class='va'>base1</span>,death.cumhaz<span class='op'>=</span><span class='va'>dr</span>,dependence<span class='op'>=</span><span class='fl'>1</span>,var.gamma<span class='op'>=</span><span class='fl'>0.4</span><span class='op'>)</span>
 <span class='co'>### marginals do fit after input after integrating out</span>
 <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='simRecurrent-2.png' alt='' width='700' height='433' /></div><div class='input'> <span class='fu'>showfitsim</span><span class='op'>(</span>causes<span class='op'>=</span><span class='fl'>1</span>,<span class='va'>rr</span>,<span class='va'>dr</span>,<span class='va'>base1</span>,<span class='va'>base1</span><span class='op'>)</span>

</div><div class='img'><img src='simRecurrent-3.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



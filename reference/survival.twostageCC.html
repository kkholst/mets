<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Twostage survival model for multivariate survival data — survival.twostageCC • mets</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Twostage survival model for multivariate survival data — survival.twostageCC"><meta property="og:description" content="older extended version of survival.twostage with  more options  and different maximizer."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a>
    </li>
    <li>
      <a href="../articles/binreg.html">Binomial Regression</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/mediation-survival.html">Mediation Analysis for survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/rmst-ate.html">Average treatment effect (ATE) for Restricted mean survival and years lost of Competing risks</a>
    </li>
    <li>
      <a href="../articles/survival-ate.html">Average treatment effect (ATE) based on the Cox and Fine-Gray model</a>
    </li>
    <li>
      <a href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kkholst/mets/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Twostage survival model for multivariate survival data</h1>
    <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/HEAD/R/twostage.R" class="external-link"><code>R/twostage.R</code></a></small>
    <div class="hidden name"><code>survival.twostageCC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>older extended version of survival.twostage with  more options  and different maximizer.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">survival.twostageCC</span><span class="op">(</span></span>
<span>  <span class="va">margsurv</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"nr"</span>,</span>
<span>  Nit <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  detail <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  clusters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  silent <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta.des <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var.link <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  baseline.iid <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"clayton.oakes"</span>,</span>
<span>  marginal.trunc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  marginal.survival <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  marginal.status <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  se.clusters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  numDeriv <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  random.design <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pairs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dim.theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  numDeriv.method <span class="op">=</span> <span class="st">"simple"</span>,</span>
<span>  additive.gamma.sum <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var.par <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cr.models <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  case.control <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ascertained <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  shut.up <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>margsurv</dt>
<dd><p>Marginal model</p></dd>


<dt>data</dt>
<dd><p>data frame</p></dd>


<dt>method</dt>
<dd><p>Scoring method "nr", "nlminb", "optimize", "nlm"</p></dd>


<dt>Nit</dt>
<dd><p>Number of iterations</p></dd>


<dt>detail</dt>
<dd><p>Detail</p></dd>


<dt>clusters</dt>
<dd><p>Cluster variable</p></dd>


<dt>silent</dt>
<dd><p>Debug information</p></dd>


<dt>weights</dt>
<dd><p>Weights</p></dd>


<dt>control</dt>
<dd><p>Optimization arguments</p></dd>


<dt>theta</dt>
<dd><p>Starting values for variance components</p></dd>


<dt>theta.des</dt>
<dd><p>design for dependence parameters, when pairs are given the indeces of the
theta-design for this pair, is given in pairs as column 5</p></dd>


<dt>var.link</dt>
<dd><p>Link function for variance:  exp-link.</p></dd>


<dt>baseline.iid</dt>
<dd><p>to adjust for baseline estimation, using phreg function on same data.</p></dd>


<dt>step</dt>
<dd><p>Step size</p></dd>


<dt>model</dt>
<dd><p>model</p></dd>


<dt>marginal.trunc</dt>
<dd><p>marginal left truncation probabilities</p></dd>


<dt>marginal.survival</dt>
<dd><p>optional vector of marginal survival probabilities</p></dd>


<dt>marginal.status</dt>
<dd><p>related to marginal survival probabilities</p></dd>


<dt>strata</dt>
<dd><p>strata for fitting, see example</p></dd>


<dt>se.clusters</dt>
<dd><p>for clusters for se calculation with iid</p></dd>


<dt>numDeriv</dt>
<dd><p>to get numDeriv version of second derivative, otherwise uses sum of squared score</p></dd>


<dt>random.design</dt>
<dd><p>random effect design for additive gamma model, when pairs are given the
indeces of the pairs random.design rows are given as columns 3:4</p></dd>


<dt>pairs</dt>
<dd><p>matrix with rows of indeces (two-columns) for the pairs considered in the pairwise
composite score, useful for case-control sampling when marginal is known.</p></dd>


<dt>dim.theta</dt>
<dd><p>dimension of the theta parameter for pairs situation.</p></dd>


<dt>numDeriv.method</dt>
<dd><p>uses simple to speed up things and second derivative not so important.</p></dd>


<dt>additive.gamma.sum</dt>
<dd><p>for two.stage=0, this is specification of the lamtot in the models via
a matrix that is multiplied onto the parameters theta (dimensions=(number random effects x number
of theta parameters), when null then sums all parameters.</p></dd>


<dt>var.par</dt>
<dd><p>is 1 for the default parametrization with the variances of the random effects,
var.par=0 specifies that the \(\lambda_j\)'s are used as parameters.</p></dd>


<dt>cr.models</dt>
<dd><p>competing risks models for two.stage=0, should be given as a list with models for each cause</p></dd>


<dt>case.control</dt>
<dd><p>assumes case control structure for "pairs" with second column being the probands,
when this options is used the twostage model is profiled out via the paired estimating equations for the survival model.</p></dd>


<dt>ascertained</dt>
<dd><p>if the pair are sampled only when there is an event. This is in contrast to
case.control sampling where a proband is given. This can be combined with control probands. Pair-call
of twostage is needed  and second column of pairs are the first jump time with an event for ascertained pairs,
or time of control proband.</p></dd>


<dt>shut.up</dt>
<dd><p>to make the program more silent in the context of iterative procedures for case-control</p></dd>

</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Thomas Scheike</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Classic twin model for quantitative traits — twinlm • mets</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Classic twin model for quantitative traits — twinlm"><meta name="description" content="Fits a classical twin model for quantitative traits."><meta property="og:description" content="Fits a classical twin model for quantitative traits."><meta property="og:image" content="http://kkholst.github.io/mets/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/basic-dutils.html">dUtility data-frame manipulations</a></li>
    <li><a class="dropdown-item" href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a></li>
    <li><a class="dropdown-item" href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a></li>
    <li><a class="dropdown-item" href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/binreg-TRS.html">Two-Stage Randomization for for Competing risks and Survival outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/binreg.html">Binomial Regression for Survival and Competing Risks Data</a></li>
    <li><a class="dropdown-item" href="../articles/cifreg.html">Cumulative Incidence Regression</a></li>
    <li><a class="dropdown-item" href="../articles/cooking-survival-data.html">WIP: Cooking survival data, 5 minute recipes</a></li>
    <li><a class="dropdown-item" href="../articles/cumulative-cost.html">IPCW Cumulative Cost</a></li>
    <li><a class="dropdown-item" href="../articles/glm-utility.html">GEE cluster standard errors and predictions for glm objects</a></li>
    <li><a class="dropdown-item" href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a></li>
    <li><a class="dropdown-item" href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a></li>
    <li><a class="dropdown-item" href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a></li>
    <li><a class="dropdown-item" href="../articles/mediation-survival.html">Mediation Analysis for survival data</a></li>
    <li><a class="dropdown-item" href="../articles/phreg_rct.html">Randomization for Cox Type rate models </a></li>
    <li><a class="dropdown-item" href="../articles/quantitative-twin.html">Twin models</a></li>
    <li><a class="dropdown-item" href="../articles/recurrent-events.html">Recurrent events</a></li>
    <li><a class="dropdown-item" href="../articles/rmst-ate.html">Average treatment effect (ATE) for Restricted mean survival and years lost of Competing risks</a></li>
    <li><a class="dropdown-item" href="../articles/survival-ate.html">G-Computation or standardization for the Cox, Fine-Gray and binomial regression models for survival data</a></li>
    <li><a class="dropdown-item" href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a></li>
    <li><a class="dropdown-item" href="../articles/twostage-survival.html">Analysis of multivariate survival data</a></li>
    <li><a class="dropdown-item" href="../articles/while-alive.html">While Alive estimands for Recurrent Events</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kkholst/mets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Classic twin model for quantitative traits</h1>
      <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/main/R/twinlm.R" class="external-link"><code>R/twinlm.R</code></a></small>
      <div class="d-none name"><code>twinlm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a classical twin model for quantitative traits.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">twinlm</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  <span class="va">zyg</span>,</span>
<span>  <span class="va">DZ</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group.equal <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ace"</span><span class="op">)</span>,</span>
<span>  twinnum <span class="op">=</span> <span class="st">"twinnum"</span>,</span>
<span>  binary <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ordinal <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  keep <span class="op">=</span> <span class="va">weights</span>,</span>
<span>  estimator <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  constrain <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  messages <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Formula specifying effects of covariates on the response</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><code>data.frame</code> with one observation pr row. In
addition a column with the zygosity (DZ or MZ given as a factor) of
each individual much be
specified as well as a twin id variable giving a unique pair of
numbers/factors to each twin pair</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>The name of the column in the dataset containing the twin-id variable.</p></dd>


<dt id="arg-zyg">zyg<a class="anchor" aria-label="anchor" href="#arg-zyg"></a></dt>
<dd><p>The name of the column in the dataset containing the
zygosity variable</p></dd>


<dt id="arg-dz">DZ<a class="anchor" aria-label="anchor" href="#arg-dz"></a></dt>
<dd><p>Character defining the level in the zyg variable
corresponding to the dyzogitic twins. If this argument is missing,
the reference level (i.e. the first level) will be interpreted as
the dyzogitic twins</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Optional. Variable name defining group for interaction analysis (e.g., gender)</p></dd>


<dt id="arg-group-equal">group.equal<a class="anchor" aria-label="anchor" href="#arg-group-equal"></a></dt>
<dd><p>If TRUE marginals of groups are asummed to be the same</p></dd>


<dt id="arg-strata">strata<a class="anchor" aria-label="anchor" href="#arg-strata"></a></dt>
<dd><p>Strata variable name</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Weights matrix if needed by the chosen estimator. For use
with Inverse Probability Weights</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character defining the type of analysis to be
performed. Can be a subset of "aced" (additive genetic factors, common
environmental factors, unique environmental factors, dominant
genetic factors). Other choices are:</p><ul><li><p>"0" (or "sat"): Saturated model where twin 1 and twin 2 within each twin
       pair may have a different marginal distribution.</p></li>
<li><p>"1" (or "flex","zyg"): Within twin pairs the marginal distribution is
       the same, but the marginal distribution may differ between MZ and DZ
       twins. A free correlation structure within MZ and DZ twins.</p></li>
<li><p>"2" (or "u", "eqmarg"): All individuals have the same marginals
       but a free correlation structure within MZ and DZ twins.</p></li>
</ul><p>The default value is an additive polygenic model <code>type="ace"</code>.</p></dd>


<dt id="arg-twinnum">twinnum<a class="anchor" aria-label="anchor" href="#arg-twinnum"></a></dt>
<dd><p>The name of the column in the dataset numbering the
twins (1,2). If it does not exist in <code>data</code> it will
automatically be created.</p></dd>


<dt id="arg-binary">binary<a class="anchor" aria-label="anchor" href="#arg-binary"></a></dt>
<dd><p>If <code>TRUE</code> a liability model is fitted. Note that if the right-hand-side of the formula is a factor, character vector, og logical variable, then the liability model is automatically chosen (wrapper of the <code>bptwin</code> function).</p></dd>


<dt id="arg-ordinal">ordinal<a class="anchor" aria-label="anchor" href="#arg-ordinal"></a></dt>
<dd><p>If non-zero (number of bins) a liability model is fitted.</p></dd>


<dt id="arg-keep">keep<a class="anchor" aria-label="anchor" href="#arg-keep"></a></dt>
<dd><p>Vector of variables from <code>data</code> that are not
specified in <code>formula</code>, to be added to data.frame of the SEM</p></dd>


<dt id="arg-estimator">estimator<a class="anchor" aria-label="anchor" href="#arg-estimator"></a></dt>
<dd><p>Choice of estimator/model</p></dd>


<dt id="arg-constrain">constrain<a class="anchor" aria-label="anchor" href="#arg-constrain"></a></dt>
<dd><p>Development argument</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>Control argument parsed on to the optimization routine</p></dd>


<dt id="arg-messages">messages<a class="anchor" aria-label="anchor" href="#arg-messages"></a></dt>
<dd><p>Control amount of messages shown</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments parsed on to lower-level functions</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an object of class <code>twinlm</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="bptwin.html">bptwin</a></code>, <code><a href="bptwin.html">twinlm.time</a></code>, <code>twinlm.strata</code>, <code><a href="twinsim.html">twinsim</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Klaus K. Holst</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Simulate data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="twinsim.html">twinsim</a></span><span class="op">(</span><span class="fl">1000</span>,b1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,b2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,acde<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## E(y|z1,z2) = z1 - z2. var(A) = var(C) = var(E) = 1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## E.g to fit the data to an ACE-model without any confounders we simply write</span></span></span>
<span class="r-in"><span><span class="va">ace</span> <span class="op">&lt;-</span> <span class="fu">twinlm</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">d</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, id<span class="op">=</span><span class="st">"id"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ace</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate Std. Error Z value  Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y     -0.019439   0.041817 -0.4649     0.642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd(A)  0.902004   0.203739  4.4273 9.544e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd(C)  1.137025   0.132852  8.5586 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd(E)  1.728992   0.037408 46.2194 &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MZ-pairs DZ-pairs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1000     1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variance decomposition:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Estimate 2.5%    97.5%  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 0.15966  0.01867 0.30065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C 0.25370  0.13920 0.36820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E 0.58664  0.53677 0.63650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          Estimate 2.5%    97.5%  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Broad-sense heritability 0.15966  0.01867 0.30065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Estimate 2.5%    97.5%  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation within MZ: 0.41336  0.36229 0.46196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation within DZ: 0.33353  0.27933 0.38561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -8779.953 (df=4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 17567.91 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: 17590.31 </span>
<span class="r-in"><span><span class="co">## An AE-model could be fitted as</span></span></span>
<span class="r-in"><span><span class="va">ae</span> <span class="op">&lt;-</span> <span class="fu">twinlm</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">d</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, id<span class="op">=</span><span class="st">"id"</span>, type<span class="op">=</span><span class="st">"ae"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## LRT:</span></span></span>
<span class="r-in"><span><span class="fu">lava</span><span class="fu">::</span><span class="fu"><a href="http://kkholst.github.io/lava/reference/compare.html" class="external-link">compare</a></span><span class="op">(</span><span class="va">ae</span>,<span class="va">ace</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	- Likelihood ratio test -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> chisq = 17.207, df = 1, p-value = 3.353e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log likelihood (model 1) log likelihood (model 2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                -8788.556                -8779.953 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## AIC</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">ae</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">ace</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15.20656</span>
<span class="r-in"><span><span class="co">## To adjust for the covariates we simply alter the formula statement</span></span></span>
<span class="r-in"><span><span class="va">ace2</span> <span class="op">&lt;-</span> <span class="fu">twinlm</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span><span class="op">+</span><span class="va">x2</span>, data<span class="op">=</span><span class="va">d</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, id<span class="op">=</span><span class="st">"id"</span>, type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Summary/GOF</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ace2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate Std. Error  Z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y     -0.026049   0.034844  -0.7476   0.4547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd(A)  1.066060   0.072890  14.6256   &lt;2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd(C)  0.980740   0.073569  13.3309   &lt;2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd(E)  0.979980   0.021887  44.7736   &lt;2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y~x1   1.006963   0.021900  45.9807   &lt;2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y~x2  -0.993802   0.021962 -45.2512   &lt;2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MZ-pairs DZ-pairs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1000     1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variance decomposition:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Estimate 2.5%    97.5%  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 0.37156  0.27300 0.47012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C 0.31446  0.22643 0.40250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E 0.31398  0.28381 0.34414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          Estimate 2.5%    97.5%  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Broad-sense heritability 0.37156  0.27300 0.47012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Estimate 2.5%    97.5%  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation within MZ: 0.68602  0.65467 0.71502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation within DZ: 0.50024  0.45538 0.54257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -7449.697 (df=6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 14911.39 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: 14945 </span>
<span class="r-in"><span> <span class="co">## Reduce Ex.Timings</span></span></span>
<span class="r-in"><span><span class="co">## An interaction could be analyzed as:</span></span></span>
<span class="r-in"><span><span class="va">ace3</span> <span class="op">&lt;-</span> <span class="fu">twinlm</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span><span class="op">+</span><span class="va">x2</span> <span class="op">+</span> <span class="va">x1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">x2</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">)</span>, data<span class="op">=</span><span class="va">d</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, id<span class="op">=</span><span class="st">"id"</span>, type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ace3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Estimate Std. Error  Z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y                  -0.026089   0.034847  -0.7487   0.4541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd(A)               1.065529   0.072975  14.6012   &lt;2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd(C)               0.981354   0.073598  13.3340   &lt;2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sd(E)               0.980018   0.021889  44.7711   &lt;2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y~x1                1.010637   0.030279  33.3778   &lt;2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y~x2               -0.993859   0.021964 -45.2498   &lt;2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y~x1:I(x2 &lt; 0)TRUE -0.007626   0.043403  -0.1757   0.8605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MZ-pairs DZ-pairs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1000     1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variance decomposition:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Estimate 2.5%    97.5%  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 0.37117  0.27253 0.46981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C 0.31484  0.22673 0.40296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E 0.31399  0.28382 0.34415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          Estimate 2.5%    97.5%  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Broad-sense heritability 0.37117  0.27253 0.46981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Estimate 2.5%    97.5%  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation within MZ: 0.68601  0.65466 0.71501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation within DZ: 0.50043  0.45553 0.54279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -7449.682 (df=7)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 14913.36 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: 14952.57 </span>
<span class="r-in"><span><span class="co">## Categorical variables are also supported </span></span></span>
<span class="r-in"><span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">d</span>,x2cat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">x2</span>,<span class="fl">3</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Low"</span>,<span class="st">"Med"</span>,<span class="st">"High"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ace4</span> <span class="op">&lt;-</span> <span class="fu">twinlm</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span><span class="op">+</span><span class="va">x2cat</span>, data<span class="op">=</span><span class="va">d2</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, id<span class="op">=</span><span class="st">"id"</span>, type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>


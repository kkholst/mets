<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Classic twin model for quantitative traits — twinlm • mets</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Classic twin model for quantitative traits — twinlm" />
<meta property="og:description" content="Fits a classical twin model for quantitative traits." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kkholst/mets/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Classic twin model for quantitative traits</h1>
    <small class="dont-index">Source: <a href='https://github.com/kkholst/mets/blob/master/R/twinlm.R'><code>R/twinlm.R</code></a></small>
    <div class="hidden name"><code>twinlm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a classical twin model for quantitative traits.</p>
    </div>

    <pre class="usage"><span class='fu'>twinlm</span>(
  <span class='no'>formula</span>,
  <span class='no'>data</span>,
  <span class='no'>id</span>,
  <span class='no'>zyg</span>,
  <span class='no'>DZ</span>,
  <span class='kw'>group</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>group.equal</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>strata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"ace"</span>),
  <span class='kw'>twinnum</span> <span class='kw'>=</span> <span class='st'>"twinnum"</span>,
  <span class='kw'>binary</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>ordinal</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>keep</span> <span class='kw'>=</span> <span class='no'>weights</span>,
  <span class='kw'>estimator</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>constrain</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>messages</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>Formula specifying effects of covariates on the response</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p><code>data.frame</code> with one observation pr row. In
addition a column with the zygosity (DZ or MZ given as a factor) of
each individual much be
specified as well as a twin id variable giving a unique pair of
numbers/factors to each twin pair</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>The name of the column in the dataset containing the twin-id variable.</p></td>
    </tr>
    <tr>
      <th>zyg</th>
      <td><p>The name of the column in the dataset containing the
zygosity variable</p></td>
    </tr>
    <tr>
      <th>DZ</th>
      <td><p>Character defining the level in the zyg variable
corresponding to the dyzogitic twins. If this argument is missing,
the reference level (i.e. the first level) will be interpreted as
the dyzogitic twins</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>Optional. Variable name defining group for interaction analysis (e.g., gender)</p></td>
    </tr>
    <tr>
      <th>group.equal</th>
      <td><p>If TRUE marginals of groups are asummed to be the same</p></td>
    </tr>
    <tr>
      <th>strata</th>
      <td><p>Strata variable name</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Weights matrix if needed by the chosen estimator. For use
with Inverse Probability Weights</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Character defining the type of analysis to be
performed. Should be a subset of "aced" (additive genetic factors, common
environmental factors, unique environmental factors, dominant
genetic factors).</p></td>
    </tr>
    <tr>
      <th>twinnum</th>
      <td><p>The name of the column in the dataset numbering the
twins (1,2). If it does not exist in <code>data</code> it will
automatically be created.</p></td>
    </tr>
    <tr>
      <th>binary</th>
      <td><p>If <code>TRUE</code> a liability model is fitted. Note that if the right-hand-side of the formula is a factor, character vector, og logical variable, then the liability model is automatically chosen (wrapper of the <code>bptwin</code> function).</p></td>
    </tr>
    <tr>
      <th>ordinal</th>
      <td><p>If non-zero (number of bins) a liability model is fitted.</p></td>
    </tr>
    <tr>
      <th>keep</th>
      <td><p>Vector of variables from <code>data</code> that are not
specified in <code>formula</code>, to be added to data.frame of the SEM</p></td>
    </tr>
    <tr>
      <th>estimator</th>
      <td><p>Choice of estimator/model</p></td>
    </tr>
    <tr>
      <th>constrain</th>
      <td><p>Development argument</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>Control argument parsed on to the optimization routine</p></td>
    </tr>
    <tr>
      <th>messages</th>
      <td><p>Control amount of messages shown</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments parsed on to lower-level functions</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns an object of class <code>twinlm</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>bptwin</code>, <code>twinlm.time</code>, <code>twinlm.strata</code>, <code>twinsim</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Simulate data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'>twinsim</span>(<span class='fl'>1000</span>,<span class='kw'>b1</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,-<span class='fl'>1</span>),<span class='kw'>b2</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),<span class='kw'>acde</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>1</span>))
<span class='co'>## E(y|z1,z2) = z1 - z2. var(A) = var(C) = var(E) = 1</span>

<span class='co'>## E.g to fit the data to an ACE-model without any confounders we simply write</span>
<span class='no'>ace</span> <span class='kw'>&lt;-</span> <span class='fu'>twinlm</span>(<span class='no'>y</span> ~ <span class='fl'>1</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>d</span>, <span class='kw'>DZ</span><span class='kw'>=</span><span class='st'>"DZ"</span>, <span class='kw'>zyg</span><span class='kw'>=</span><span class='st'>"zyg"</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"id"</span>)
<span class='no'>ace</span></div><div class='output co'>#&gt;        Estimate Std. Error Z value  Pr(&gt;|z|)
#&gt; y     -0.019439   0.041817 -0.4649     0.642
#&gt; sd(A)  0.902004   0.203739  4.4273 9.544e-06
#&gt; sd(C)  1.137025   0.132852  8.5586 &lt; 2.2e-16
#&gt; sd(E)  1.728992   0.037408 46.2194 &lt; 2.2e-16
#&gt; 
#&gt; MZ-pairs DZ-pairs 
#&gt;     1000     1000 
#&gt; 
#&gt; Variance decomposition:
#&gt;   Estimate 2.5%    97.5%  
#&gt; A 0.15966  0.01867 0.30065
#&gt; C 0.25370  0.13920 0.36820
#&gt; E 0.58664  0.53677 0.63650
#&gt; 
#&gt; 
#&gt;                          Estimate 2.5%    97.5%  
#&gt; Broad-sense heritability 0.15966  0.01867 0.30065
#&gt; 
#&gt;                        Estimate 2.5%    97.5%  
#&gt; Correlation within MZ: 0.41336  0.36229 0.46196
#&gt; Correlation within DZ: 0.33353  0.27933 0.38561
#&gt; 
#&gt; 'log Lik.' -8779.953 (df=4)
#&gt; AIC: 17567.91 
#&gt; BIC: 17590.31 </div><div class='input'><span class='co'>## An AE-model could be fitted as</span>
<span class='no'>ae</span> <span class='kw'>&lt;-</span> <span class='fu'>twinlm</span>(<span class='no'>y</span> ~ <span class='fl'>1</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>d</span>, <span class='kw'>DZ</span><span class='kw'>=</span><span class='st'>"DZ"</span>, <span class='kw'>zyg</span><span class='kw'>=</span><span class='st'>"zyg"</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"id"</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"ae"</span>)
<span class='co'>## LRT:</span>
<span class='kw pkg'>lava</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lava/man/compare.html'>compare</a></span>(<span class='no'>ae</span>,<span class='no'>ace</span>)</div><div class='output co'>#&gt; 
#&gt; 	- Likelihood ratio test -
#&gt; 
#&gt; data:  
#&gt; chisq = 17.207, df = 1, p-value = 3.353e-05
#&gt; sample estimates:
#&gt; log likelihood (model 1) log likelihood (model 2) 
#&gt;                -8788.556                -8779.953 
#&gt; </div><div class='input'><span class='co'>## AIC</span>
<span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span>(<span class='no'>ae</span>)-<span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span>(<span class='no'>ace</span>)</div><div class='output co'>#&gt; [1] 15.20656</div><div class='input'><span class='co'>## To adjust for the covariates we simply alter the formula statement</span>
<span class='no'>ace2</span> <span class='kw'>&lt;-</span> <span class='fu'>twinlm</span>(<span class='no'>y</span> ~ <span class='no'>x1</span>+<span class='no'>x2</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>d</span>, <span class='kw'>DZ</span><span class='kw'>=</span><span class='st'>"DZ"</span>, <span class='kw'>zyg</span><span class='kw'>=</span><span class='st'>"zyg"</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"id"</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"ace"</span>)
<span class='co'>## Summary/GOF</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>ace2</span>)</div><div class='output co'>#&gt;        Estimate Std. Error  Z value Pr(&gt;|z|)
#&gt; y     -0.026049   0.034844  -0.7476   0.4547
#&gt; sd(A)  1.066060   0.072890  14.6256   &lt;2e-16
#&gt; sd(C)  0.980740   0.073569  13.3309   &lt;2e-16
#&gt; sd(E)  0.979980   0.021887  44.7736   &lt;2e-16
#&gt; y~x1   1.006963   0.021900  45.9807   &lt;2e-16
#&gt; y~x2  -0.993802   0.021962 -45.2512   &lt;2e-16
#&gt; 
#&gt; MZ-pairs DZ-pairs 
#&gt;     1000     1000 
#&gt; 
#&gt; Variance decomposition:
#&gt;   Estimate 2.5%    97.5%  
#&gt; A 0.37156  0.27300 0.47012
#&gt; C 0.31446  0.22643 0.40250
#&gt; E 0.31398  0.28381 0.34414
#&gt; 
#&gt; 
#&gt;                          Estimate 2.5%    97.5%  
#&gt; Broad-sense heritability 0.37156  0.27300 0.47012
#&gt; 
#&gt;                        Estimate 2.5%    97.5%  
#&gt; Correlation within MZ: 0.68602  0.65467 0.71502
#&gt; Correlation within DZ: 0.50024  0.45538 0.54257
#&gt; 
#&gt; 'log Lik.' -7449.697 (df=6)
#&gt; AIC: 14911.39 
#&gt; BIC: 14945 </div><div class='input'> <span class='co'>## Reduce Ex.Timings</span>
<span class='co'>## An interaction could be analyzed as:</span>
<span class='no'>ace3</span> <span class='kw'>&lt;-</span> <span class='fu'>twinlm</span>(<span class='no'>y</span> ~ <span class='no'>x1</span>+<span class='no'>x2</span> + <span class='no'>x1</span>:<span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>x2</span><span class='kw'>&lt;</span><span class='fl'>0</span>), <span class='kw'>data</span><span class='kw'>=</span><span class='no'>d</span>, <span class='kw'>DZ</span><span class='kw'>=</span><span class='st'>"DZ"</span>, <span class='kw'>zyg</span><span class='kw'>=</span><span class='st'>"zyg"</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"id"</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"ace"</span>)
<span class='no'>ace3</span></div><div class='output co'>#&gt;                     Estimate Std. Error  Z value Pr(&gt;|z|)
#&gt; y                  -0.026089   0.034847  -0.7487   0.4541
#&gt; sd(A)               1.065529   0.072975  14.6012   &lt;2e-16
#&gt; sd(C)               0.981354   0.073598  13.3340   &lt;2e-16
#&gt; sd(E)               0.980018   0.021889  44.7711   &lt;2e-16
#&gt; y~x1                1.010637   0.030279  33.3778   &lt;2e-16
#&gt; y~x2               -0.993859   0.021964 -45.2498   &lt;2e-16
#&gt; y~x1:I(x2 &lt; 0)TRUE -0.007626   0.043403  -0.1757   0.8605
#&gt; 
#&gt; MZ-pairs DZ-pairs 
#&gt;     1000     1000 
#&gt; 
#&gt; Variance decomposition:
#&gt;   Estimate 2.5%    97.5%  
#&gt; A 0.37117  0.27253 0.46981
#&gt; C 0.31484  0.22673 0.40296
#&gt; E 0.31399  0.28382 0.34415
#&gt; 
#&gt; 
#&gt;                          Estimate 2.5%    97.5%  
#&gt; Broad-sense heritability 0.37117  0.27253 0.46981
#&gt; 
#&gt;                        Estimate 2.5%    97.5%  
#&gt; Correlation within MZ: 0.68601  0.65466 0.71501
#&gt; Correlation within DZ: 0.50043  0.45553 0.54279
#&gt; 
#&gt; 'log Lik.' -7449.682 (df=7)
#&gt; AIC: 14913.36 
#&gt; BIC: 14952.57 </div><div class='input'><span class='co'>## Categorical variables are also supported </span>
<span class='no'>d2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span>(<span class='no'>d</span>,<span class='kw'>x2cat</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>(<span class='no'>x2</span>,<span class='fl'>3</span>,<span class='kw'>labels</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Low"</span>,<span class='st'>"Med"</span>,<span class='st'>"High"</span>)))
<span class='no'>ace4</span> <span class='kw'>&lt;-</span> <span class='fu'>twinlm</span>(<span class='no'>y</span> ~ <span class='no'>x1</span>+<span class='no'>x2cat</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>d2</span>, <span class='kw'>DZ</span><span class='kw'>=</span><span class='st'>"DZ"</span>, <span class='kw'>zyg</span><span class='kw'>=</span><span class='st'>"zyg"</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"id"</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"ace"</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



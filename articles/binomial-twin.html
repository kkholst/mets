<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis of bivariate binomial data: Twin analysis â€¢ mets</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of bivariate binomial data: Twin analysis">
<meta property="og:description" content="mets">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.8.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kkholst/mets/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysis of bivariate binomial data: Twin analysis</h1>
                        <h4 class="author">Klaus Holst &amp; Thomas Scheike</h4>
            
            <h4 class="date">2021-05-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/master/vignettes/binomial-twin.Rmd"><code>vignettes/binomial-twin.Rmd</code></a></small>
      <div class="hidden name"><code>binomial-twin.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>When looking at bivariate binomial data with the aim of learning about the dependence that is present, possibly after correcting for some covariates many models are available.</p>
<ul>
<li>Random-effects models logistic regression covered elsewhere (glmer in lme4).</li>
</ul>
<p>in the mets package you can fit the</p>
<ul>
<li><p>Pairwise odds ratio model</p></li>
<li>Bivariate Probit model
<ul>
<li>With random effects</li>
<li>Special functionality for polygenic random effects modelling such as ACE, ADE ,AE and so forth.</li>
</ul>
</li>
<li>Additive gamma random effects model
<ul>
<li>Special functionality for polygenic random effects modelling such as ACE, ADE ,AE and so forth.</li>
</ul>
</li>
</ul>
<p>Typically it can be hard or impossible to specify random effects models with special structure among the parameters of the random effects. This is possible in our models.</p>
<p>To be concrete about the model structure assume that we have paired binomial data <span class="math inline">\((Y_1, Y_2, X_1, X_)2\)</span> where the responses are <span class="math inline">\(Y_1, Y_2\)</span> and we have covariates <span class="math inline">\(X_1, X_2\)</span>.</p>
<p>We start by giving a brief description of these different models. First we for bivariate data one can specify the marginal probability using logistic regression models <span class="math display">\[
logit(P(Y_i=1|X_i)) = \alpha_i + X_i^T \beta  i=1,2.
\]</span> These model can be estimated under working independence .</p>
<p>A typical twin analysis will typically consist of looking at both</p>
<ul>
<li><p>Pairwise odds ratio model</p></li>
<li><p>Bivariate Probit model</p></li>
</ul>
<p>The additive gamma can be used for the same as the bivariate probit model but is more restrictive in terms of dependence structure, but is nevertheless still valuable to have also as a check of results of the bivariate probit model.</p>
</div>
<div id="biprobit-with-random-effects" class="section level1">
<h1 class="hasAnchor">
<a href="#biprobit-with-random-effects" class="anchor"></a>Biprobit with random effects</h1>
<p>For these model we assume that given random effects <span class="math inline">\(Z\)</span> and a covariate vector <span class="math inline">\(V_{12}\)</span> we have independent logistic regression models <span class="math display">\[
probit(P(Y_i=1|X_i, Z)) = \alpha_i + X_i^T \beta + V_{12}^T Z  i=1,2.
\]</span> where Z$ is a bivariate normal distribution with some covariance <span class="math inline">\(\Sigma\)</span>. The general covariance structure <span class="math inline">\(\Sigma\)</span> makes the model very flexible.</p>
<p>We note that</p>
<ul>
<li>Paramters <span class="math inline">\(\beta\)</span> are subject specific</li>
<li>The <span class="math inline">\(\Sigma\)</span> will reflect dependence</li>
</ul>
<p>The more standard link function <span class="math inline">\(logit\)</span> rather than the <span class="math inline">\(probit\)</span> link is often used and implemented in for example . The advantage is that one now gets an odds-ratio interpretation of the subject specific effects, but one then needs numerical integration to fit the model.</p>
<div id="pairwise-odds-ratio-model" class="section level2">
<h2 class="hasAnchor">
<a href="#pairwise-odds-ratio-model" class="anchor"></a>Pairwise odds ratio model</h2>
<p>Now the pairwise odds ratio model the specifies that given $ X_1, X_2 $ the marginal models are <span class="math display">\[
logit(P(Y_i=1|X_i)) = \alpha_i + X_i^T \beta  i=1,2
\]</span></p>
<p>The primary object of interest are the odds ratio between <span class="math inline">\(Y_{1}\)</span> and <span class="math inline">\(Y_{2}\)</span> <span class="math display">\[
\gamma_{12} = \frac{ P(  Y_{ki} =1 , Y_{kj} =1) P(  Y_{ki} =0 , Y_{kj} =0) }{ 
  P(  Y_{ki} =1 , Y_{kj} =0) P(  Y_{ki} =0 , Y_{kj} =1) }
\]</span> given <span class="math inline">\(X_{ki}\)</span>, <span class="math inline">\(X_{kj}\)</span>, and <span class="math inline">\(Z_{kji}\)</span>.</p>
<p>We model the odds ratio with the regression <span class="math display">\[
\gamma_{12} = \exp( Z_{12}^T \lambda)
\]</span> Where <span class="math inline">\(Z_{12}\)</span> are some covarites that may influence the odds-ratio between between <span class="math inline">\(Y_{1}\)</span> and <span class="math inline">\(Y_{2}\)</span> and contains the marginal covariates, . This odds-ratio is given covariates as well as marginal covariates. The odds-ratio and marginals specify the joint bivariate distribution via the so-called Placckett-distribution.</p>
<p>One way of fitting this model is the ALR algoritm, the alternating logistic regression ahd this has been described in several papers . We here simply estimate the parameters in a two stage-procedure</p>
<ul>
<li>Estimating the marginal parameters via GEE</li>
<li>Using marginal estimates, estimate dependence parameters</li>
</ul>
<p>This gives efficient estimates of the dependence parameters because of orthogonality, but some efficiency may be gained for the marginal parameters by using the full likelihood or iterative fitting such as for the ALR.</p>
<p>The pairwise odds-ratio model is very useful, but one do not have a random effects model.</p>
</div>
<div id="additive-gamma-model" class="section level2">
<h2 class="hasAnchor">
<a href="#additive-gamma-model" class="anchor"></a>Additive gamma model</h2>
<p>Again we operate under marginal logistic regression models are <span class="math display">\[
logit(P(Y_i=1|X_i)) = \alpha_i + X_i^T \beta  i=1,2
\]</span></p>
<p>First with just one random effect <span class="math inline">\(Z\)</span> we assume that conditional on <span class="math inline">\(Z\)</span> the responses are independent and follow the model <span class="math display">\[
logit(P(Y_i=1|X_i,Z)) = exp( -Z \cdot \Psi^{-1}(\lambda_{\bullet},\lambda_{\bullet},P(Y_i=1|X_i)) )  
\]</span> where <span class="math inline">\(\Psi\)</span> is the laplace transform of <span class="math inline">\(Z\)</span> where we assume that <span class="math inline">\(Z\)</span> is gamma distributed with variance <span class="math inline">\(\lambda_{\bullet}^{-1}\)</span> and mean 1. In general <span class="math inline">\(\Psi(\lambda_1,\lambda_2)\)</span> is the laplace transform of a Gamma distributed random effect with <span class="math inline">\(Z\)</span> with mean <span class="math inline">\(\lambda_1/\lambda_2\)</span> and variance <span class="math inline">\(\lambda_1/\lambda_2^2\)</span>.</p>
<p>We fit this model by</p>
<ul>
<li>Estimating the marginal parameters via GEE</li>
<li>Using marginal estimates, estimate dependence parameters</li>
</ul>
<p>To deal with multiple random effects we consider random effects <span class="math inline">\(Z_i i=1,...,d\)</span> such that <span class="math inline">\(Z_i\)</span> is gamma distributed with * mean: <span class="math inline">\(\lambda_j/\lambda_{\bullet}\)</span> * variance: <span class="math inline">\(\lambda_j/\lambda_{\bullet}^2\)</span>, where we define the scalar <span class="math inline">\(\lambda_{\bullet}\)</span> below.</p>
<p>Now given a cluster-specific design vector <span class="math inline">\(V_{12}\)</span> we assume that <span class="math display">\[
V_{12}^T Z
\]</span> is gamma distributed with mean 1 and variance <span class="math inline">\(\lambda_{\bullet}^{-1}\)</span> such that critically the random effect variance is the same for all clusters. That is <span class="math display">\[
 \lambda_{\bullet} = V_{12}^T (\lambda_1,...,\lambda_d)^T 
\]</span> We return to some specific models below, and show how to fit the ACE and AE model using this set-up.</p>
<p>One last option in the model-specification is to specify how the parameters <span class="math inline">\(\lambda_1,...,\lambda_d\)</span> are related. We thus can specify a matrix <span class="math inline">\(M\)</span> of dimension <span class="math inline">\(p \times d\)</span> such that <span class="math display">\[
 (\lambda_1,...,\lambda_d)^T  = M \theta
\]</span> where <span class="math inline">\(\theta\)</span> is d-dimensional. If <span class="math inline">\(M\)</span> is diagonal we have no restrictions on parameters.</p>
<p>This parametrization is obtained with the var.par=0 option that thus estimates <span class="math inline">\(\theta\)</span>.</p>
<p>The DEFAULT parametrization instead estimates the variances of the random effecs (var.par=1) via the parameters <span class="math inline">\(\nu\)</span> <span class="math display">\[
 M \nu = ( \lambda_1/\lambda_{\bullet}^2, ...,\lambda_d/\lambda_{\bullet}^2)^T
\]</span></p>
<p>The basic modelling assumption is now that given random effects <span class="math inline">\(Z=(Z_1,...,Z_d)\)</span> we have independent probabilites <span class="math display">\[
logit(P(Y_i=1|X_i,Z)) = exp( -V_{12,i}^T Z \cdot \Psi^{-1}(\lambda_{\bullet},\lambda_{\bullet},P(Y_i=1|X_i)) )   i=1,2
\]</span></p>
<p>We fit this model by</p>
<ul>
<li>Estimating the marginal parameters via GEE</li>
<li>Using marginal estimates, estimate dependence parameters</li>
</ul>
<p>Even though the model not formaly in this formulation allows negative correlation in practice the paramters can be negative and this reflects negative correlation. An advanatage is that no numerical integration is needed.</p>
</div>
<div id="the-twin-stutter-data" class="section level2">
<h2 class="hasAnchor">
<a href="#the-twin-stutter-data" class="anchor"></a>The twin-stutter data</h2>
<p>We consider the twin-stutter where for pairs of twins that are either dizygotic or monozygotic we have recorded whether the twins are stuttering </p>
<p>We here consider MZ and same sex DZ twins.</p>
<p>Looking at the data</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://kkholst.github.io/mets">mets</a></span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="kw">twinstut</span>)
<span class="kw">twinstut</span><span class="op">$</span><span class="kw">binstut</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span>(<span class="kw">twinstut</span><span class="op">$</span><span class="kw">stutter</span><span class="op">==</span><span class="st">"yes"</span>)
<span class="kw">twinsall</span> <span class="op">&lt;-</span> <span class="kw">twinstut</span>
<span class="kw">twinstut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="kw">twinstut</span>,<span class="kw">zyg</span><span class="op">%in%</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mz"</span>,<span class="st">"dz"</span>))
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">twinstut</span>)
<span class="co">#&gt;    tvparnr zyg stutter    sex age nr binstut</span>
<span class="co">#&gt; 1        1  mz      no female  71  1       0</span>
<span class="co">#&gt; 2        1  mz      no female  71  2       0</span>
<span class="co">#&gt; 3        2  dz      no female  71  1       0</span>
<span class="co">#&gt; 8        5  mz      no female  71  1       0</span>
<span class="co">#&gt; 9        5  mz      no female  71  2       0</span>
<span class="co">#&gt; 11       7  dz      no   male  71  1       0</span>
</pre></div>
</div>
<div id="pairwise-odds-ratio-model-1" class="section level2">
<h2 class="hasAnchor">
<a href="#pairwise-odds-ratio-model-1" class="anchor"></a>Pairwise odds ratio model</h2>
<p>We start by fitting an overall dependence OR for both MZ and DZ even though the dependence is expected to be different across zygosity.</p>
<p>The first step is to fit the marginal model adjusting for marginal covariates. We here note that there is a rather strong gender effect in the risk of stuttering.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">margbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(<span class="kw">binstut</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">sex</span>)<span class="op">+</span><span class="kw">age</span>,data=<span class="kw">twinstut</span>,family=<span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>())
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">margbin</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; glm(formula = binstut ~ factor(sex) + age, family = binomial(), </span>
<span class="co">#&gt;     data = twinstut)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span>
<span class="co">#&gt; -0.4419  -0.4078  -0.2842  -0.2672   2.6395  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                  Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)     -3.027625   0.104012 -29.108  &lt; 2e-16 ***</span>
<span class="co">#&gt; factor(sex)male  0.869826   0.062197  13.985  &lt; 2e-16 ***</span>
<span class="co">#&gt; age             -0.005983   0.002172  -2.754  0.00588 ** </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 9328.6  on 21287  degrees of freedom</span>
<span class="co">#&gt; Residual deviance: 9117.0  on 21285  degrees of freedom</span>
<span class="co">#&gt; AIC: 9123</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of Fisher Scoring iterations: 6</span>
</pre></div>
<p>Now estimating the OR parameter. We see a strong dependence with an OR at around 8 that is clearly significant.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">bina</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span>(<span class="kw">margbin</span>,data=<span class="kw">twinstut</span>,var.link=<span class="fl">1</span>,
                       clusters=<span class="kw">twinstut</span><span class="op">$</span><span class="kw">tvparnr</span>,detail=<span class="fl">0</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">bina</span>)
<span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="co">#&gt; With log-link</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                theta        se</span>
<span class="co">#&gt; dependence1 2.085347 0.1274536</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $or</span>
<span class="co">#&gt;             Estimate Std.Err  2.5% 97.5%   P-value</span>
<span class="co">#&gt; dependence1    8.047   1.026 6.037 10.06 4.295e-15</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "plackett"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>
</pre></div>
<p>Now, and more interestingly, we consider an OR that depends on zygosity and note that MZ have a much larger OR than DZ twins. This type of trait is somewhat complicated to interpret, but clearly, one option is that that there is a genetic effect, alternatively there might be a stronger environmental effect for MZ twins.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># design for OR dependence </span>
<span class="kw">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>( <span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">zyg</span>),data=<span class="kw">twinstut</span>)
<span class="kw">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span>(<span class="kw">margbin</span>,data=<span class="kw">twinstut</span>,var.link=<span class="fl">1</span>,
                          clusters=<span class="kw">twinstut</span><span class="op">$</span><span class="kw">tvparnr</span>,theta.des=<span class="kw">theta.des</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">bin</span>)
<span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="co">#&gt; With log-link</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                   theta        se</span>
<span class="co">#&gt; factor(zyg)dz 0.5221651 0.2401355</span>
<span class="co">#&gt; factor(zyg)mz 3.4853933 0.1866076</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $or</span>
<span class="co">#&gt;               Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="co">#&gt; factor(zyg)dz    1.686  0.4048  0.8923  2.479 3.123e-05</span>
<span class="co">#&gt; factor(zyg)mz   32.635  6.0900 20.6991 44.571 8.376e-08</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "plackett"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>
</pre></div>
<p>We now consider further regression modelling of the OR structure by considering possible interactions between sex and zygozsity. We see that MZ has a much higher dependence and that males have a much lower dependence. We tested for interaction in this model and these were not significant.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">twinstut</span><span class="op">$</span><span class="kw">cage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(<span class="kw">twinstut</span><span class="op">$</span><span class="kw">age</span>)
<span class="kw">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>( <span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">zyg</span>)<span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">sex</span>),data=<span class="kw">twinstut</span>)
<span class="kw">bina</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span>(<span class="kw">margbin</span>,data=<span class="kw">twinstut</span>,var.link=<span class="fl">1</span>,
                          clusters=<span class="kw">twinstut</span><span class="op">$</span><span class="kw">tvparnr</span>,theta.des=<span class="kw">theta.des</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">bina</span>)
<span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="co">#&gt; With log-link</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                      theta        se</span>
<span class="co">#&gt; factor(zyg)dz    0.8098841 0.3138423</span>
<span class="co">#&gt; factor(zyg)mz    3.7318076 0.2632250</span>
<span class="co">#&gt; factor(sex)male -0.4075409 0.3055349</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $or</span>
<span class="co">#&gt;                 Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="co">#&gt; factor(zyg)dz     2.2476  0.7054  0.8651  3.630 0.0014410</span>
<span class="co">#&gt; factor(zyg)mz    41.7545 10.9908 20.2129 63.296 0.0001453</span>
<span class="co">#&gt; factor(sex)male   0.6653  0.2033  0.2669  1.064 0.0010643</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "plackett"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>
</pre></div>
</div>
<div id="alternative-syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#alternative-syntax" class="anchor"></a>Alternative syntax</h2>
<p>We now demonstrate how the models can fitted jointly and with anohter syntax, that ofcourse just fits the marginal model and subsequently fits the pairwise OR model.</p>
<p>First noticing as before that MZ twins have a much higher dependence.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
 <span class="co"># refers to zygosity of first subject in eash pair : zyg1</span>
 <span class="co"># could also use zyg2 (since zyg2=zyg1 within twinpair's)</span>
 <span class="kw">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/easy.binomial.twostage.html">easy.binomial.twostage</a></span>(<span class="kw">stutter</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">sex</span>)<span class="op">+</span><span class="kw">age</span>,data=<span class="kw">twinstut</span>,
                response=<span class="st">"binstut"</span>,id=<span class="st">"tvparnr"</span>,var.link=<span class="fl">1</span>,
                theta.formula=<span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">zyg1</span>))
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">out</span>)
<span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="co">#&gt; With log-link</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                    theta        se</span>
<span class="co">#&gt; factor(zyg1)dz 0.5221651 0.2401355</span>
<span class="co">#&gt; factor(zyg1)mz 3.4853933 0.1866076</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $or</span>
<span class="co">#&gt;                Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="co">#&gt; factor(zyg1)dz    1.686  0.4048  0.8923  2.479 3.123e-05</span>
<span class="co">#&gt; factor(zyg1)mz   32.635  6.0900 20.6991 44.571 8.376e-08</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "plackett"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>
</pre></div>
<p>Now considering all data and estimating separate effects for the OR for opposite sex DZ twins and same sex twins. We here find that os twins are not markedly different from the same sex DZ twins.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
 <span class="co"># refers to zygosity of first subject in eash pair : zyg1</span>
 <span class="co"># could also use zyg2 (since zyg2=zyg1 within twinpair's))</span>
 
 <span class="kw">desfs</span><span class="op">&lt;-</span><span class="fu">function</span>(<span class="kw">x</span>,<span class="kw">num1</span>=<span class="st">"zyg1"</span>,<span class="kw">num2</span>=<span class="st">"zyg2"</span>)
         <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">x</span>[<span class="kw">num1</span>]<span class="op">==</span><span class="st">"dz"</span>,<span class="kw">x</span>[<span class="kw">num1</span>]<span class="op">==</span><span class="st">"mz"</span>,<span class="kw">x</span>[<span class="kw">num1</span>]<span class="op">==</span><span class="st">"os"</span>)<span class="op">*</span><span class="fl">1</span>
     
 <span class="kw">margbinall</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(<span class="kw">binstut</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">sex</span>)<span class="op">+</span><span class="kw">age</span>,data=<span class="kw">twinsall</span>,family=<span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>())
 <span class="kw">out3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/easy.binomial.twostage.html">easy.binomial.twostage</a></span>(<span class="kw">binstut</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">sex</span>)<span class="op">+</span><span class="kw">age</span>,
       data=<span class="kw">twinsall</span>,response=<span class="st">"binstut"</span>,id=<span class="st">"tvparnr"</span>,var.link=<span class="fl">1</span>,
       theta.formula=<span class="kw">desfs</span>,desnames=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dz"</span>,<span class="st">"mz"</span>,<span class="st">"os"</span>))
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">out3</span>)
<span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model </span>
<span class="co">#&gt; With log-link</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;        theta        se</span>
<span class="co">#&gt; dz 0.5278527 0.2396796</span>
<span class="co">#&gt; mz 3.4850037 0.1864190</span>
<span class="co">#&gt; os 0.7802940 0.2894394</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $or</span>
<span class="co">#&gt;    Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="co">#&gt; dz    1.695  0.4063  0.8989  2.492 3.016e-05</span>
<span class="co">#&gt; mz   32.623  6.0815 20.7031 44.542 8.128e-08</span>
<span class="co">#&gt; os    2.182  0.6316  0.9442  3.420 5.504e-04</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "plackett"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>
</pre></div>
</div>
<div id="bivariate-probit-model" class="section level2">
<h2 class="hasAnchor">
<a href="#bivariate-probit-model" class="anchor"></a>Bivariate Probit model</h2>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://kkholst.github.io/mets">mets</a></span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="kw">twinstut</span>)
<span class="kw">twinstut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="kw">twinstut</span>,<span class="kw">zyg</span><span class="op">%in%</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mz"</span>,<span class="st">"dz"</span>))
<span class="kw">twinstut</span><span class="op">$</span><span class="kw">binstut</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span>(<span class="kw">twinstut</span><span class="op">$</span><span class="kw">stutter</span><span class="op">==</span><span class="st">"yes"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">twinstut</span>)
<span class="co">#&gt;    tvparnr zyg stutter    sex age nr binstut</span>
<span class="co">#&gt; 1        1  mz      no female  71  1       0</span>
<span class="co">#&gt; 2        1  mz      no female  71  2       0</span>
<span class="co">#&gt; 3        2  dz      no female  71  1       0</span>
<span class="co">#&gt; 8        5  mz      no female  71  1       0</span>
<span class="co">#&gt; 9        5  mz      no female  71  2       0</span>
<span class="co">#&gt; 11       7  dz      no   male  71  1       0</span>
</pre></div>
<p>First testing for same dependence in MZ and DZ that we recommend doing by comparing the correlations of MZ and DZ twins. Apart from regression correction in the mean this is an un-structured model, and the useful concordance and casewise concordance estimates can be reported from this analysis.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin</a></span>(<span class="kw">binstut</span><span class="op">~</span><span class="kw">sex</span>,data=<span class="kw">twinstut</span>,id=<span class="st">"tvparnr"</span>,zyg=<span class="st">"zyg"</span>,DZ=<span class="st">"dz"</span>,type=<span class="st">"un"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">b1</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;                Estimate   Std.Err        Z p-value    </span>
<span class="co">#&gt; (Intercept)   -1.794823  0.023289 -77.0667 &lt; 2e-16 ***</span>
<span class="co">#&gt; sexmale        0.401432  0.030179  13.3018 &lt; 2e-16 ***</span>
<span class="co">#&gt; atanh(rho) MZ  1.096916  0.073574  14.9091 &lt; 2e-16 ***</span>
<span class="co">#&gt; atanh(rho) DZ  0.132458  0.062516   2.1188 0.03411 *  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total MZ/DZ Complete pairs MZ/DZ</span>
<span class="co">#&gt;  8777/12511  3255/4058           </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                            Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Tetrachoric correlation MZ 0.79939  0.74101 0.84577</span>
<span class="co">#&gt; Tetrachoric correlation DZ 0.13169  0.00993 0.24960</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MZ:</span>
<span class="co">#&gt;                      Estimate 2.5%     97.5%   </span>
<span class="co">#&gt; Concordance           0.01698  0.01411  0.02042</span>
<span class="co">#&gt; Casewise Concordance  0.46730  0.40383  0.53185</span>
<span class="co">#&gt; Marginal              0.03634  0.03287  0.04016</span>
<span class="co">#&gt; Rel.Recur.Risk       12.85882 10.87510 14.84253</span>
<span class="co">#&gt; log(OR)               3.75632  3.37975  4.13289</span>
<span class="co">#&gt; DZ:</span>
<span class="co">#&gt;                      Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Concordance          0.00235  0.00140 0.00393</span>
<span class="co">#&gt; Casewise Concordance 0.06456  0.03937 0.10413</span>
<span class="co">#&gt; Marginal             0.03634  0.03287 0.04016</span>
<span class="co">#&gt; Rel.Recur.Risk       1.77662  0.92746 2.62577</span>
<span class="co">#&gt; log(OR)              0.63527  0.09013 1.18040</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          Estimate 2.5% 97.5%</span>
<span class="co">#&gt; Broad-sense heritability   1      NaN  NaN</span>
</pre></div>
</div>
<div id="polygenic-modelling" class="section level2">
<h2 class="hasAnchor">
<a href="#polygenic-modelling" class="anchor"></a>Polygenic modelling</h2>
<p>We now turn attention to specific polygenic modelling where special random effects are used to specify ACE, AE, ADE models and so forth. This is very easy with the bptwin function. The key parts of the output are the sizes of the genetic component A and the environmental component, and we can compare with the results of the unstructed model above. Also formally we can test if this submodel is acceptable by a likelihood ratio test.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin</a></span>(<span class="kw">binstut</span><span class="op">~</span><span class="kw">sex</span>,data=<span class="kw">twinstut</span>,id=<span class="st">"tvparnr"</span>,zyg=<span class="st">"zyg"</span>,DZ=<span class="st">"dz"</span>,type=<span class="st">"ace"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">b1</span>)
<span class="co">#&gt; Warning in sqrt(diag(vcovACDE)): NaNs produced</span>

<span class="co">#&gt; Warning in sqrt(diag(vcovACDE)): NaNs produced</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              Estimate   Std.Err         Z   p-value    </span>
<span class="co">#&gt; (Intercept)  -3.70371   0.24449  -15.1485 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; sexmale       0.83310   0.08255   10.0920 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; log(var(A))   1.18278   0.17179    6.8851 5.774e-12 ***</span>
<span class="co">#&gt; log(var(C)) -31.88101   0.14929 -213.5454 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total MZ/DZ Complete pairs MZ/DZ</span>
<span class="co">#&gt;  8777/12511  3255/4058           </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                    Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; A                  0.76545  0.70500 0.82590</span>
<span class="co">#&gt; C                  0.00000      NaN     NaN</span>
<span class="co">#&gt; E                  0.23455  0.17410 0.29500</span>
<span class="co">#&gt; MZ Tetrachoric Cor 0.76545  0.69793 0.81948</span>
<span class="co">#&gt; DZ Tetrachoric Cor 0.38272  0.35210 0.41253</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MZ:</span>
<span class="co">#&gt;                      Estimate 2.5%     97.5%   </span>
<span class="co">#&gt; Concordance           0.01560  0.01273  0.01912</span>
<span class="co">#&gt; Casewise Concordance  0.42830  0.36248  0.49677</span>
<span class="co">#&gt; Marginal              0.03643  0.03294  0.04027</span>
<span class="co">#&gt; Rel.Recur.Risk       11.75741  9.77237 13.74246</span>
<span class="co">#&gt; log(OR)               3.52382  3.13466  3.91298</span>
<span class="co">#&gt; DZ:</span>
<span class="co">#&gt;                      Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Concordance          0.00558  0.00465 0.00670</span>
<span class="co">#&gt; Casewise Concordance 0.15327  0.13749 0.17050</span>
<span class="co">#&gt; Marginal             0.03643  0.03294 0.04027</span>
<span class="co">#&gt; Rel.Recur.Risk       4.20744  3.78588 4.62900</span>
<span class="co">#&gt; log(OR)              1.69996  1.57262 1.82730</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Broad-sense heritability 0.76545  0.70500 0.82590</span>
</pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">b0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin</a></span>(<span class="kw">binstut</span><span class="op">~</span><span class="kw">sex</span>,data=<span class="kw">twinstut</span>,id=<span class="st">"tvparnr"</span>,zyg=<span class="st">"zyg"</span>,DZ=<span class="st">"dz"</span>,type=<span class="st">"ae"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">b0</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;             Estimate  Std.Err        Z   p-value    </span>
<span class="co">#&gt; (Intercept) -3.70371  0.24449 -15.1485 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; sexmale      0.83310  0.08255  10.0920 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; log(var(A))  1.18278  0.17179   6.8851 5.774e-12 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total MZ/DZ Complete pairs MZ/DZ</span>
<span class="co">#&gt;  8777/12511  3255/4058           </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                    Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; A                  0.76545  0.70500 0.82590</span>
<span class="co">#&gt; E                  0.23455  0.17410 0.29500</span>
<span class="co">#&gt; MZ Tetrachoric Cor 0.76545  0.69793 0.81948</span>
<span class="co">#&gt; DZ Tetrachoric Cor 0.38272  0.35210 0.41253</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MZ:</span>
<span class="co">#&gt;                      Estimate 2.5%     97.5%   </span>
<span class="co">#&gt; Concordance           0.01560  0.01273  0.01912</span>
<span class="co">#&gt; Casewise Concordance  0.42830  0.36248  0.49677</span>
<span class="co">#&gt; Marginal              0.03643  0.03294  0.04027</span>
<span class="co">#&gt; Rel.Recur.Risk       11.75741  9.77237 13.74246</span>
<span class="co">#&gt; log(OR)               3.52382  3.13466  3.91298</span>
<span class="co">#&gt; DZ:</span>
<span class="co">#&gt;                      Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Concordance          0.00558  0.00465 0.00670</span>
<span class="co">#&gt; Casewise Concordance 0.15327  0.13749 0.17050</span>
<span class="co">#&gt; Marginal             0.03643  0.03294 0.04027</span>
<span class="co">#&gt; Rel.Recur.Risk       4.20744  3.78588 4.62900</span>
<span class="co">#&gt; log(OR)              1.69996  1.57262 1.82730</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Broad-sense heritability 0.76545  0.70500 0.82590</span>
</pre></div>
</div>
<div id="additive-gamma-random-effects" class="section level2">
<h2 class="hasAnchor">
<a href="#additive-gamma-random-effects" class="anchor"></a>Additive gamma random effects</h2>
<p>Fitting first a model with different size random effects for MZ and DZ. We note that as before in the OR and biprobit model the dependence is much stronger for MZ twins. We also test if these are the same by parametrizing the OR model with an intercept. This clearly shows a significant difference.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>( <span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">zyg</span>),data=<span class="kw">twinstut</span>)
<span class="kw">margbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(<span class="kw">binstut</span><span class="op">~</span><span class="kw">sex</span>,data=<span class="kw">twinstut</span>,family=<span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>())
<span class="kw">bintwin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span>(<span class="kw">margbin</span>,data=<span class="kw">twinstut</span>,model=<span class="st">"gamma"</span>,
     clusters=<span class="kw">twinstut</span><span class="op">$</span><span class="kw">tvparnr</span>,detail=<span class="fl">0</span>,theta=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>)<span class="op">/</span><span class="fl">1</span>,var.link=<span class="fl">1</span>,
     theta.des=<span class="kw">theta.des</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">bintwin</span>)
<span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span>
<span class="co">#&gt; Variance of Gamma distributed random effects </span>
<span class="co">#&gt; With log-link</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                     theta        se</span>
<span class="co">#&gt; factor(zyg)dz -2.61194495 0.4854454</span>
<span class="co">#&gt; factor(zyg)mz -0.01817181 0.1030735</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vargam</span>
<span class="co">#&gt;               Estimate Std.Err     2.5%  97.5%   P-value</span>
<span class="co">#&gt; factor(zyg)dz  0.07339 0.03563 0.003563 0.1432 3.940e-02</span>
<span class="co">#&gt; factor(zyg)mz  0.98199 0.10122 0.783610 1.1804 2.962e-22</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "gamma"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>

<span class="co"># test for same dependence in MZ and DZ </span>
<span class="kw">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>( <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">zyg</span>),data=<span class="kw">twinstut</span>)
<span class="kw">margbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(<span class="kw">binstut</span><span class="op">~</span><span class="kw">sex</span>,data=<span class="kw">twinstut</span>,family=<span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>())
<span class="kw">bintwin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span>(<span class="kw">margbin</span>,data=<span class="kw">twinstut</span>,model=<span class="st">"gamma"</span>,
     clusters=<span class="kw">twinstut</span><span class="op">$</span><span class="kw">tvparnr</span>,detail=<span class="fl">0</span>,theta=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>)<span class="op">/</span><span class="fl">1</span>,var.link=<span class="fl">1</span>,
     theta.des=<span class="kw">theta.des</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">bintwin</span>)
<span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span>
<span class="co">#&gt; Variance of Gamma distributed random effects </span>
<span class="co">#&gt; With log-link</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                   theta        se</span>
<span class="co">#&gt; (Intercept)   -2.611945 0.4854454</span>
<span class="co">#&gt; factor(zyg)mz  2.593773 0.4962675</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vargam</span>
<span class="co">#&gt;               Estimate Std.Err     2.5%   97.5% P-value</span>
<span class="co">#&gt; (Intercept)    0.07339 0.03563 0.003563  0.1432  0.0394</span>
<span class="co">#&gt; factor(zyg)mz 13.38016 6.64014 0.365728 26.3946  0.0439</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "gamma"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>
</pre></div>
</div>
<div id="polygenic-modelling-1" class="section level2">
<h2 class="hasAnchor">
<a href="#polygenic-modelling-1" class="anchor"></a>Polygenic modelling</h2>
<p>First setting up the random effects design for the random effects and the the relationship between variance parameters. We see that the genetic random effect has size one for MZ and 0.5 for DZ subjects, that have shared and non-shared genetic components with variance 0.5 such that the total genetic variance is the same for all subjects. The shared environmental effect is the samme for all. Thus two parameters with these bands.</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="kw">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/npc.html">twin.polygen.design</a></span>(<span class="kw">twinstut</span>,id=<span class="st">"tvparnr"</span>,zygname=<span class="st">"zyg"</span>,zyg=<span class="st">"dz"</span>,type=<span class="st">"ace"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">out</span><span class="op">$</span><span class="kw">des.rv</span>,<span class="kw">twinstut</span><span class="op">$</span><span class="kw">tvparnr</span>),<span class="fl">10</span>)
<span class="co">#&gt;    MZ DZ DZns1 DZns2 env   </span>
<span class="co">#&gt; 1   1  0     0     0   1  1</span>
<span class="co">#&gt; 2   1  0     0     0   1  1</span>
<span class="co">#&gt; 3   0  1     1     0   1  2</span>
<span class="co">#&gt; 8   1  0     0     0   1  5</span>
<span class="co">#&gt; 9   1  0     0     0   1  5</span>
<span class="co">#&gt; 11  0  1     1     0   1  7</span>
<span class="co">#&gt; 12  0  1     1     0   1  8</span>
<span class="co">#&gt; 13  0  1     0     1   1  8</span>
<span class="co">#&gt; 15  0  1     1     0   1 10</span>
<span class="co">#&gt; 18  0  1     1     0   1 12</span>
<span class="kw">out</span><span class="op">$</span><span class="kw">pardes</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]  1.0    0</span>
<span class="co">#&gt; [2,]  0.5    0</span>
<span class="co">#&gt; [3,]  0.5    0</span>
<span class="co">#&gt; [4,]  0.5    0</span>
<span class="co">#&gt; [5,]  0.0    1</span>
</pre></div>
<p>Now, fitting the ACE model, we see that the variance of the genetic, component, is 1.5 and the environmental variance is -0.5. Thus suggesting that the ACE model does not fit the data. When the random design is given we automatically use the gamma fralty model.</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">margbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(<span class="kw">binstut</span><span class="op">~</span><span class="kw">sex</span>,data=<span class="kw">twinstut</span>,family=<span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>())
<span class="kw">bintwin1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span>(<span class="kw">margbin</span>,data=<span class="kw">twinstut</span>,
     clusters=<span class="kw">twinstut</span><span class="op">$</span><span class="kw">tvparnr</span>,detail=<span class="fl">0</span>,theta=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>)<span class="op">/</span><span class="fl">1</span>,var.link=<span class="fl">0</span>,
     random.design=<span class="kw">out</span><span class="op">$</span><span class="kw">des.rv</span>,theta.des=<span class="kw">out</span><span class="op">$</span><span class="kw">pardes</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">bintwin1</span>)
<span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span>
<span class="co">#&gt; Variance of Gamma distributed random effects</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                  theta        se</span>
<span class="co">#&gt; dependence1  1.5261839 0.2475041</span>
<span class="co">#&gt; dependence2 -0.5447955 0.1942159</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "clayton.oakes"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $h</span>
<span class="co">#&gt;             Estimate Std.Err    2.5%   97.5%   P-value</span>
<span class="co">#&gt; dependence1   1.5551   0.187  1.1886  1.9217 9.107e-17</span>
<span class="co">#&gt; dependence2  -0.5551   0.187 -0.9217 -0.1886 2.993e-03</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vare</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vartot</span>
<span class="co">#&gt;    Estimate Std.Err   2.5% 97.5%   P-value</span>
<span class="co">#&gt; p1   0.9814  0.1023 0.7809 1.182 8.292e-22</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>
</pre></div>
<p>For this model we estimate the concordance and casewise concordance as well as the marginal rates of stuttering for females.</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="fu"><a href="../reference/npc.html">concordanceTwinACE</a></span>(<span class="kw">bintwin1</span>,type=<span class="st">"ace"</span>)
<span class="co">#&gt; $MZ</span>
<span class="co">#&gt;                      Estimate  Std.Err    2.5%   97.5%   P-value</span>
<span class="co">#&gt; concordance           0.01822 0.001469 0.01534 0.02110 2.612e-35</span>
<span class="co">#&gt; casewise concordance  0.50334 0.032558 0.43953 0.56716 6.486e-54</span>
<span class="co">#&gt; marginal              0.03620 0.001877 0.03252 0.03988 7.148e-83</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DZ</span>
<span class="co">#&gt;                      Estimate   Std.Err     2.5%    97.5%   P-value</span>
<span class="co">#&gt; concordance          0.002353 0.0005889 0.001199 0.003507 6.453e-05</span>
<span class="co">#&gt; casewise concordance 0.065007 0.0158357 0.033970 0.096045 4.041e-05</span>
<span class="co">#&gt; marginal             0.036197 0.0018769 0.032518 0.039876 7.148e-83</span>
</pre></div>
<p>The E component was not consistent with the fit of the data and we now consider instead the AE model.</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="kw">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/npc.html">twin.polygen.design</a></span>(<span class="kw">twinstut</span>,id=<span class="st">"tvparnr"</span>,zygname=<span class="st">"zyg"</span>,zyg=<span class="st">"dz"</span>,type=<span class="st">"ae"</span>)

<span class="kw">bintwin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span>(<span class="kw">margbin</span>,data=<span class="kw">twinstut</span>,
     clusters=<span class="kw">twinstut</span><span class="op">$</span><span class="kw">tvparnr</span>,detail=<span class="fl">0</span>,theta=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>)<span class="op">/</span><span class="fl">1</span>,var.link=<span class="fl">0</span>,
     random.design=<span class="kw">out</span><span class="op">$</span><span class="kw">des.rv</span>,theta.des=<span class="kw">out</span><span class="op">$</span><span class="kw">pardes</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">bintwin</span>)
<span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span>
<span class="co">#&gt; Variance of Gamma distributed random effects</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                 theta         se</span>
<span class="co">#&gt; dependence1 0.9094847 0.09536268</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "clayton.oakes"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $h</span>
<span class="co">#&gt;             Estimate Std.Err 2.5% 97.5% P-value</span>
<span class="co">#&gt; dependence1        1       0    1     1       0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vare</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vartot</span>
<span class="co">#&gt;    Estimate Std.Err   2.5% 97.5%   P-value</span>
<span class="co">#&gt; p1   0.9095 0.09536 0.7226 1.096 1.469e-21</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>
</pre></div>
<p>Again, the concordance can be computed:</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="fu"><a href="../reference/npc.html">concordanceTwinACE</a></span>(<span class="kw">bintwin</span>,type=<span class="st">"ae"</span>)
<span class="co">#&gt; $MZ</span>
<span class="co">#&gt;                      Estimate  Std.Err    2.5%   97.5%   P-value</span>
<span class="co">#&gt; concordance           0.01736 0.001427 0.01456 0.02016 5.005e-34</span>
<span class="co">#&gt; casewise concordance  0.47954 0.032716 0.41542 0.54366 1.199e-48</span>
<span class="co">#&gt; marginal              0.03620 0.001877 0.03252 0.03988 7.148e-83</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DZ</span>
<span class="co">#&gt;                      Estimate   Std.Err     2.5%    97.5%    P-value</span>
<span class="co">#&gt; concordance          0.004769 0.0003926 0.003999 0.005538  5.938e-34</span>
<span class="co">#&gt; casewise concordance 0.131750 0.0054168 0.121133 0.142367 1.139e-130</span>
<span class="co">#&gt; marginal             0.036197 0.0018769 0.032518 0.039876  7.148e-83</span>
</pre></div>
</div>
</div>
<div id="sessioninfo" class="section level1">
<h1 class="hasAnchor">
<a href="#sessioninfo" class="anchor"></a>SessionInfo</h1>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()
<span class="co">#&gt; R version 4.0.2 (2020-06-22)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 16.04.6 LTS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /usr/lib/openblas-base/libblas.so.3</span>
<span class="co">#&gt; LAPACK: /usr/lib/libopenblasp-r0.2.18.so</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] mets_1.2.8.1    lava_1.6.9      timereg_1.9.9   survival_3.1-12</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] Rcpp_1.0.6          cpp11_0.2.1         knitr_1.33         </span>
<span class="co">#&gt;  [4] magrittr_2.0.1      splines_4.0.2       lattice_0.20-41    </span>
<span class="co">#&gt;  [7] R6_2.5.0            ragg_0.3.1          rlang_0.4.11       </span>
<span class="co">#&gt; [10] stringr_1.4.0       tools_4.0.2         grid_4.0.2         </span>
<span class="co">#&gt; [13] xfun_0.23           htmltools_0.5.1.1   systemfonts_0.3.1  </span>
<span class="co">#&gt; [16] yaml_2.2.1          rprojroot_2.0.2     digest_0.6.27      </span>
<span class="co">#&gt; [19] ucminf_1.1-4        numDeriv_2016.8-1.1 pkgdown_1.6.1      </span>
<span class="co">#&gt; [22] crayon_1.4.1        Matrix_1.2-18       fs_1.5.0           </span>
<span class="co">#&gt; [25] memoise_1.1.0       evaluate_0.14       rmarkdown_2.8      </span>
<span class="co">#&gt; [28] stringi_1.6.2       compiler_4.0.2      desc_1.3.0         </span>
<span class="co">#&gt; [31] mvtnorm_1.1-1</span>
</pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysis of bivariate binomial data: Twin analysis • mets</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of bivariate binomial data: Twin analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/basic-dutils.html">dUtility data-frame manipulations</a></li>
    <li><a class="dropdown-item" href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a></li>
    <li><a class="dropdown-item" href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a></li>
    <li><a class="dropdown-item" href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/binreg-TRS.html">Two-Stage Randomization for for Competing risks and Survival outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/binreg.html">Binomial Regression for Survival and Competing Risks Data</a></li>
    <li><a class="dropdown-item" href="../articles/cifreg.html">Cumulative Incidence Regression</a></li>
    <li><a class="dropdown-item" href="../articles/cooking-survival-data.html">WIP: Cooking survival data, 5 minute recipes</a></li>
    <li><a class="dropdown-item" href="../articles/cumulative-cost.html">IPCW Cumulative Cost</a></li>
    <li><a class="dropdown-item" href="../articles/glm-utility.html">GEE cluster standard errors and predictions for glm objects</a></li>
    <li><a class="dropdown-item" href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a></li>
    <li><a class="dropdown-item" href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a></li>
    <li><a class="dropdown-item" href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a></li>
    <li><a class="dropdown-item" href="../articles/mediation-survival.html">Mediation Analysis for survival data</a></li>
    <li><a class="dropdown-item" href="../articles/phreg_rct.html">Randomization for Cox Type rate models </a></li>
    <li><a class="dropdown-item" href="../articles/quantitative-twin.html">Twin models</a></li>
    <li><a class="dropdown-item" href="../articles/recurrent-events.html">Recurrent events</a></li>
    <li><a class="dropdown-item" href="../articles/rmst-ate.html">Average treatment effect (ATE) for Restricted mean survival and years lost of Competing risks</a></li>
    <li><a class="dropdown-item" href="../articles/survival-ate.html">G-Computation or standardization for the Cox, Fine-Gray and binomial regression models for survival data</a></li>
    <li><a class="dropdown-item" href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a></li>
    <li><a class="dropdown-item" href="../articles/twostage-survival.html">Analysis of multivariate survival data</a></li>
    <li><a class="dropdown-item" href="../articles/while-alive.html">While Alive estimands for Recurrent Events</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kkholst/mets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analysis of bivariate binomial data: Twin analysis</h1>
                        <h4 data-toc-skip class="author">Klaus Holst
&amp; Thomas Scheike</h4>
            
            <h4 data-toc-skip class="date">2026-01-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/main/vignettes/binomial-twin.Rmd" class="external-link"><code>vignettes/binomial-twin.Rmd</code></a></small>
      <div class="d-none name"><code>binomial-twin.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>When looking at bivariate binomial data with the aim of learning
about the dependence that is present, possibly after correcting for some
covariates many models are available.</p>
<ul>
<li>Random-effects models logistic regression covered elsewhere (glmer
in lme4).</li>
</ul>
<p>in the mets package you can fit the</p>
<ul>
<li><p>Pairwise odds ratio model</p></li>
<li>
<p>Bivariate Probit model</p>
<ul>
<li>With random effects</li>
<li>Special functionality for polygenic random effects modelling such as
ACE, ADE ,AE and so forth.</li>
</ul>
</li>
<li>
<p>Additive gamma random effects model</p>
<ul>
<li>Special functionality for polygenic random effects modelling such as
ACE, ADE ,AE and so forth.</li>
</ul>
</li>
</ul>
<p>Typically it can be hard or impossible to specify random effects
models with special structure among the parameters of the random
effects. This is possible in our models.</p>
<p>To be concrete about the model structure assume that we have paired
binomial data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>Y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Y</mi><mn>2</mn></msub><mo>,</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mo stretchy="false" form="postfix">)</mo></msub><mn>2</mn></mrow><annotation encoding="application/x-tex">(Y_1, Y_2, X_1, X_)2</annotation></semantics></math>
where the responses are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">Y_1, Y_2</annotation></semantics></math>
and we have covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">X_1, X_2</annotation></semantics></math>.</p>
<p>We start by giving a brief description of these different models.
First we for bivariate data one can specify the marginal probability
using logistic regression models
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><msubsup><mi>X</mi><mi>i</mi><mi>T</mi></msubsup><mi>β</mi><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
logit(P(Y_i=1|X_i)) = \alpha_i + X_i^T \beta  i=1,2.
</annotation></semantics></math> These model can be estimated under
working independence .</p>
<p>A typical twin analysis will typically consist of looking at both</p>
<ul>
<li><p>Pairwise odds ratio model</p></li>
<li><p>Bivariate Probit model</p></li>
</ul>
<p>The additive gamma can be used for the same as the bivariate probit
model but is more restrictive in terms of dependence structure, but is
nevertheless still valuable to have also as a check of results of the
bivariate probit model.</p>
</div>
<div class="section level2">
<h2 id="biprobit-with-random-effects">Biprobit with random effects<a class="anchor" aria-label="anchor" href="#biprobit-with-random-effects"></a>
</h2>
<p>For these model we assume that given random effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
and a covariate vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mn>12</mn></msub><annotation encoding="application/x-tex">V_{12}</annotation></semantics></math>
we have independent logistic regression models
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><msubsup><mi>X</mi><mi>i</mi><mi>T</mi></msubsup><mi>β</mi><mo>+</mo><msubsup><mi>V</mi><mn>12</mn><mi>T</mi></msubsup><mi>Z</mi><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
probit(P(Y_i=1|X_i, Z)) = \alpha_i + X_i^T \beta + V_{12}^T Z  i=1,2.
</annotation></semantics></math> where Z$ is a bivariate normal
distribution with some covariance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Σ</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>.
The general covariance structure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Σ</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
makes the model very flexible.</p>
<p>We note that</p>
<ul>
<li>Paramters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
are subject specific</li>
<li>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Σ</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
will reflect dependence</li>
</ul>
<p>The more standard link function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">logit</annotation></semantics></math>
rather than the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>i</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">probit</annotation></semantics></math>
link is often used and implemented in for example . The advantage is
that one now gets an odds-ratio interpretation of the subject specific
effects, but one then needs numerical integration to fit the model.</p>
<div class="section level3">
<h3 id="pairwise-odds-ratio-model">Pairwise odds ratio model<a class="anchor" aria-label="anchor" href="#pairwise-odds-ratio-model"></a>
</h3>
<p>Now the pairwise odds ratio model the specifies that given $ X_1, X_2
$ the marginal models are
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><msubsup><mi>X</mi><mi>i</mi><mi>T</mi></msubsup><mi>β</mi><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">
logit(P(Y_i=1|X_i)) = \alpha_i + X_i^T \beta  i=1,2
</annotation></semantics></math></p>
<p>The primary object of interest are the odds ratio between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_{1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Y_{2}</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mn>12</mn></msub><mo>=</mo><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>Y</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>0</mn><mo>,</mo><msub><mi>Y</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>Y</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>0</mn><mo>,</mo><msub><mi>Y</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\gamma_{12} = \frac{ P(  Y_{ki} =1 , Y_{kj} =1) P(  Y_{ki} =0 , Y_{kj} =0) }{ 
  P(  Y_{ki} =1 , Y_{kj} =0) P(  Y_{ki} =0 , Y_{kj} =1) }
</annotation></semantics></math> given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>k</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{ki}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">X_{kj}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mrow><mi>k</mi><mi>j</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">Z_{kji}</annotation></semantics></math>.</p>
<p>We model the odds ratio with the regression
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mn>12</mn></msub><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Z</mi><mn>12</mn><mi>T</mi></msubsup><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\gamma_{12} = \exp( Z_{12}^T \lambda)
</annotation></semantics></math> Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mn>12</mn></msub><annotation encoding="application/x-tex">Z_{12}</annotation></semantics></math>
are some covarites that may influence the odds-ratio between between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_{1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Y_{2}</annotation></semantics></math>
and contains the marginal covariates, . This odds-ratio is given
covariates as well as marginal covariates. The odds-ratio and marginals
specify the joint bivariate distribution via the so-called
Placckett-distribution.</p>
<p>One way of fitting this model is the ALR algoritm, the alternating
logistic regression ahd this has been described in several papers . We
here simply estimate the parameters in a two stage-procedure</p>
<ul>
<li>Estimating the marginal parameters via GEE</li>
<li>Using marginal estimates, estimate dependence parameters</li>
</ul>
<p>This gives efficient estimates of the dependence parameters because
of orthogonality, but some efficiency may be gained for the marginal
parameters by using the full likelihood or iterative fitting such as for
the ALR.</p>
<p>The pairwise odds-ratio model is very useful, but one do not have a
random effects model.</p>
</div>
<div class="section level3">
<h3 id="additive-gamma-model">Additive gamma model<a class="anchor" aria-label="anchor" href="#additive-gamma-model"></a>
</h3>
<p>Again we operate under marginal logistic regression models are
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><msubsup><mi>X</mi><mi>i</mi><mi>T</mi></msubsup><mi>β</mi><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">
logit(P(Y_i=1|X_i)) = \alpha_i + X_i^T \beta  i=1,2
</annotation></semantics></math></p>
<p>First with just one random effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
we assume that conditional on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
the responses are independent and follow the model
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>Z</mi><mo>⋅</mo><msup><mi>Ψ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mo>•</mo></msub><mo>,</mo><msub><mi>λ</mi><mo>•</mo></msub><mo>,</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
logit(P(Y_i=1|X_i,Z)) = exp( -Z \cdot \Psi^{-1}(\lambda_{\bullet},\lambda_{\bullet},P(Y_i=1|X_i)) )  
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ψ</mi><annotation encoding="application/x-tex">\Psi</annotation></semantics></math>
is the laplace transform of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
where we assume that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
is gamma distributed with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>λ</mi><mo>•</mo><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">\lambda_{\bullet}^{-1}</annotation></semantics></math>
and mean 1. In general
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Psi(\lambda_1,\lambda_2)</annotation></semantics></math>
is the laplace transform of a Gamma distributed random effect with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
with mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub><mi>/</mi><msub><mi>λ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\lambda_1/\lambda_2</annotation></semantics></math>
and variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub><mi>/</mi><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\lambda_1/\lambda_2^2</annotation></semantics></math>.</p>
<p>We fit this model by</p>
<ul>
<li>Estimating the marginal parameters via GEE</li>
<li>Using marginal estimates, estimate dependence parameters</li>
</ul>
<p>To deal with multiple random effects we consider random effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>i</mi></msub><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">Z_i  i=1,...,d</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Z_i</annotation></semantics></math>
is gamma distributed with * mean:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>j</mi></msub><mi>/</mi><msub><mi>λ</mi><mo>•</mo></msub></mrow><annotation encoding="application/x-tex">\lambda_j/\lambda_{\bullet}</annotation></semantics></math>
* variance:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>j</mi></msub><mi>/</mi><msubsup><mi>λ</mi><mo>•</mo><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\lambda_j/\lambda_{\bullet}^2</annotation></semantics></math>,
where we define the scalar
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mo>•</mo></msub><annotation encoding="application/x-tex">\lambda_{\bullet}</annotation></semantics></math>
below.</p>
<p>Now given a cluster-specific design vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mn>12</mn></msub><annotation encoding="application/x-tex">V_{12}</annotation></semantics></math>
we assume that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><mn>12</mn><mi>T</mi></msubsup><mi>Z</mi></mrow><annotation encoding="application/x-tex">
V_{12}^T Z
</annotation></semantics></math> is gamma distributed with mean 1 and
variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>λ</mi><mo>•</mo><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">\lambda_{\bullet}^{-1}</annotation></semantics></math>
such that critically the random effect variance is the same for all
clusters. That is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mo>•</mo></msub><mo>=</mo><msubsup><mi>V</mi><mn>12</mn><mi>T</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>λ</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">
 \lambda_{\bullet} = V_{12}^T (\lambda_1,...,\lambda_d)^T 
</annotation></semantics></math> We return to some specific models
below, and show how to fit the ACE and AE model using this set-up.</p>
<p>One last option in the model-specification is to specify how the
parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>λ</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_1,...,\lambda_d</annotation></semantics></math>
are related. We thus can specify a matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
of dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>×</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">p \times d</annotation></semantics></math>
such that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>λ</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><mo>=</mo><mi>M</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">
 (\lambda_1,...,\lambda_d)^T  = M \theta
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
is d-dimensional. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
is diagonal we have no restrictions on parameters.</p>
<p>This parametrization is obtained with the var.par=0 option that thus
estimates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p>
<p>The DEFAULT parametrization instead estimates the variances of the
random effecs (var.par=1) via the parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>ν</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mi>/</mi><msubsup><mi>λ</mi><mo>•</mo><mn>2</mn></msubsup><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>λ</mi><mi>d</mi></msub><mi>/</mi><msubsup><mi>λ</mi><mo>•</mo><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">
 M \nu = ( \lambda_1/\lambda_{\bullet}^2, ...,\lambda_d/\lambda_{\bullet}^2)^T
</annotation></semantics></math></p>
<p>The basic modelling assumption is now that given random effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>Z</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z=(Z_1,...,Z_d)</annotation></semantics></math>
we have independent probabilites
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo>,</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msubsup><mi>V</mi><mrow><mn>12</mn><mo>,</mo><mi>i</mi></mrow><mi>T</mi></msubsup><mi>Z</mi><mo>⋅</mo><msup><mi>Ψ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mo>•</mo></msub><mo>,</mo><msub><mi>λ</mi><mo>•</mo></msub><mo>,</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">
logit(P(Y_i=1|X_i,Z)) = exp( -V_{12,i}^T Z \cdot \Psi^{-1}(\lambda_{\bullet},\lambda_{\bullet},P(Y_i=1|X_i)) )   i=1,2
</annotation></semantics></math></p>
<p>We fit this model by</p>
<ul>
<li>Estimating the marginal parameters via GEE</li>
<li>Using marginal estimates, estimate dependence parameters</li>
</ul>
<p>Even though the model not formaly in this formulation allows negative
correlation in practice the paramters can be negative and this reflects
negative correlation. An advanatage is that no numerical integration is
needed.</p>
</div>
<div class="section level3">
<h3 id="the-twin-stutter-data">The twin-stutter data<a class="anchor" aria-label="anchor" href="#the-twin-stutter-data"></a>
</h3>
<p>We consider the twin-stutter where for pairs of twins that are either
dizygotic or monozygotic we have recorded whether the twins are
stuttering </p>
<p>We here consider MZ and same sex DZ twins.</p>
<p>Looking at the data</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/mets/" class="external-link">mets</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">twinstut</span><span class="op">)</span></span>
<span><span class="va">twinstut</span><span class="op">$</span><span class="va">binstut</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">twinstut</span><span class="op">$</span><span class="va">stutter</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span></span>
<span><span class="va">twinsall</span> <span class="op">&lt;-</span> <span class="va">twinstut</span></span>
<span><span class="va">twinstut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">twinstut</span>,<span class="va">zyg</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>,<span class="st">"dz"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">twinstut</span><span class="op">)</span></span>
<span><span class="co">#&gt;    tvparnr zyg stutter    sex age nr binstut</span></span>
<span><span class="co">#&gt; 1        1  mz      no female  71  1       0</span></span>
<span><span class="co">#&gt; 2        1  mz      no female  71  2       0</span></span>
<span><span class="co">#&gt; 3        2  dz      no female  71  1       0</span></span>
<span><span class="co">#&gt; 8        5  mz      no female  71  1       0</span></span>
<span><span class="co">#&gt; 9        5  mz      no female  71  2       0</span></span>
<span><span class="co">#&gt; 11       7  dz      no   male  71  1       0</span></span>
<span><span class="va">twinstut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">twinstut</span>,<span class="va">tvparnr</span> <span class="op">&lt;</span> <span class="fl">3000</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pairwise-odds-ratio-model-1">Pairwise odds ratio model<a class="anchor" aria-label="anchor" href="#pairwise-odds-ratio-model-1"></a>
</h3>
<p>We start by fitting an overall dependence OR for both MZ and DZ even
though the dependence is expected to be different across zygosity.</p>
<p>The first step is to fit the marginal model adjusting for marginal
covariates. We here note that there is a rather strong gender effect in
the risk of stuttering.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">margbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">binstut</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">+</span><span class="va">age</span>,data<span class="op">=</span><span class="va">twinstut</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">margbin</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = binstut ~ factor(sex) + age, family = binomial(), </span></span>
<span><span class="co">#&gt;     data = twinstut)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)      0.03033    2.16166   0.014   0.9888    </span></span>
<span><span class="co">#&gt; factor(sex)male  0.80288    0.20272   3.961 7.48e-05 ***</span></span>
<span><span class="co">#&gt; age             -0.05471    0.03295  -1.660   0.0968 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 940.43  on 2650  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 921.01  on 2648  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 927.01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 6</span></span></code></pre></div>
<p>Now estimating the OR parameter. We see a strong dependence with an
OR at around 8 that is clearly significant.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bina</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">margbin</span>,data<span class="op">=</span><span class="va">twinstut</span>,var.link<span class="op">=</span><span class="fl">1</span>,</span>
<span>                       clusters<span class="op">=</span><span class="va">twinstut</span><span class="op">$</span><span class="va">tvparnr</span>,detail<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bina</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                theta       se</span></span>
<span><span class="co">#&gt; dependence1 1.859712 0.481585</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $or</span></span>
<span><span class="co">#&gt;             Estimate Std.Err   2.5% 97.5% P-value</span></span>
<span><span class="co">#&gt; dependence1    6.422   3.093 0.3603 12.48 0.03785</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "plackett"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>Now, and more interestingly, we consider an OR that depends on
zygosity and note that MZ have a much larger OR than DZ twins. This type
of trait is somewhat complicated to interpret, but clearly, one option
is that that there is a genetic effect, alternatively there might be a
stronger environmental effect for MZ twins.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># design for OR dependence </span></span>
<span><span class="va">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span> <span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span>,data<span class="op">=</span><span class="va">twinstut</span><span class="op">)</span></span>
<span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">margbin</span>,data<span class="op">=</span><span class="va">twinstut</span>,var.link<span class="op">=</span><span class="fl">1</span>,</span>
<span>                          clusters<span class="op">=</span><span class="va">twinstut</span><span class="op">$</span><span class="va">tvparnr</span>,theta.des<span class="op">=</span><span class="va">theta.des</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bin</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                   theta        se</span></span>
<span><span class="co">#&gt; factor(zyg)dz 0.1624942 1.0050473</span></span>
<span><span class="co">#&gt; factor(zyg)mz 3.7460315 0.7259771</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $or</span></span>
<span><span class="co">#&gt;               Estimate Std.Err    2.5%   97.5% P-value</span></span>
<span><span class="co">#&gt; factor(zyg)dz    1.176   1.182  -1.141   3.494  0.3197</span></span>
<span><span class="co">#&gt; factor(zyg)mz   42.353  30.747 -17.910 102.616  0.1684</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "plackett"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>We now consider further regression modelling of the OR structure by
considering possible interactions between sex and zygozsity. We see that
MZ has a much higher dependence and that males have a much lower
dependence. We tested for interaction in this model and these were not
significant.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">twinstut</span><span class="op">$</span><span class="va">cage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">twinstut</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="va">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span> <span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span>,data<span class="op">=</span><span class="va">twinstut</span><span class="op">)</span></span>
<span><span class="va">bina</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">margbin</span>,data<span class="op">=</span><span class="va">twinstut</span>,var.link<span class="op">=</span><span class="fl">1</span>,</span>
<span>                          clusters<span class="op">=</span><span class="va">twinstut</span><span class="op">$</span><span class="va">tvparnr</span>,theta.des<span class="op">=</span><span class="va">theta.des</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bina</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                     theta       se</span></span>
<span><span class="co">#&gt; factor(zyg)dz    1.238547 1.118919</span></span>
<span><span class="co">#&gt; factor(zyg)mz    6.078248 1.536564</span></span>
<span><span class="co">#&gt; factor(sex)male -3.233772 1.776972</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $or</span></span>
<span><span class="co">#&gt;                  Estimate   Std.Err       2.5%     97.5% P-value</span></span>
<span><span class="co">#&gt; factor(zyg)dz     3.45059   3.86094   -4.11670   11.0179  0.3715</span></span>
<span><span class="co">#&gt; factor(zyg)mz   436.26434 670.34797 -877.59353 1750.1222  0.5152</span></span>
<span><span class="co">#&gt; factor(sex)male   0.03941   0.07003   -0.09784    0.1767  0.5736</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "plackett"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="alternative-syntax">Alternative syntax<a class="anchor" aria-label="anchor" href="#alternative-syntax"></a>
</h3>
<p>We now demonstrate how the models can fitted jointly and with anohter
syntax, that ofcourse just fits the marginal model and subsequently fits
the pairwise OR model.</p>
<p>First noticing as before that MZ twins have a much higher
dependence.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># refers to zygosity of first subject in eash pair : zyg1</span></span>
<span> <span class="co"># could also use zyg2 (since zyg2=zyg1 within twinpair's)</span></span>
<span> <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/easy.binomial.twostage.html">easy.binomial.twostage</a></span><span class="op">(</span><span class="va">stutter</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">+</span><span class="va">age</span>,data<span class="op">=</span><span class="va">twinstut</span>,</span>
<span>                response<span class="op">=</span><span class="st">"binstut"</span>,id<span class="op">=</span><span class="st">"tvparnr"</span>,var.link<span class="op">=</span><span class="fl">1</span>,</span>
<span>                theta.formula<span class="op">=</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                    theta        se</span></span>
<span><span class="co">#&gt; factor(zyg1)dz 0.1624942 1.0050473</span></span>
<span><span class="co">#&gt; factor(zyg1)mz 3.7460315 0.7259771</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $or</span></span>
<span><span class="co">#&gt;                Estimate Std.Err    2.5%   97.5% P-value</span></span>
<span><span class="co">#&gt; factor(zyg1)dz    1.176   1.182  -1.141   3.494  0.3197</span></span>
<span><span class="co">#&gt; factor(zyg1)mz   42.353  30.747 -17.910 102.616  0.1684</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "plackett"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>Now considering all data and estimating separate effects for the OR
for opposite sex DZ twins and same sex twins. We here find that os twins
are not markedly different from the same sex DZ twins.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># refers to zygosity of first subject in eash pair : zyg1</span></span>
<span> <span class="co"># could also use zyg2 (since zyg2=zyg1 within twinpair's))</span></span>
<span> </span>
<span> <span class="va">desfs</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">num1</span><span class="op">=</span><span class="st">"zyg1"</span>,<span class="va">num2</span><span class="op">=</span><span class="st">"zyg2"</span><span class="op">)</span></span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"dz"</span>,<span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"mz"</span>,<span class="va">x</span><span class="op">[</span><span class="va">num1</span><span class="op">]</span><span class="op">==</span><span class="st">"os"</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span></span>
<span>     </span>
<span> <span class="va">margbinall</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">binstut</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">+</span><span class="va">age</span>,data<span class="op">=</span><span class="va">twinsall</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="va">out3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/easy.binomial.twostage.html">easy.binomial.twostage</a></span><span class="op">(</span><span class="va">binstut</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">+</span><span class="va">age</span>,</span>
<span>       data<span class="op">=</span><span class="va">twinsall</span>,response<span class="op">=</span><span class="st">"binstut"</span>,id<span class="op">=</span><span class="st">"tvparnr"</span>,var.link<span class="op">=</span><span class="fl">1</span>,</span>
<span>       theta.formula<span class="op">=</span><span class="va">desfs</span>,desnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dz"</span>,<span class="st">"mz"</span>,<span class="st">"os"</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;        theta        se</span></span>
<span><span class="co">#&gt; dz 0.5278527 0.2396796</span></span>
<span><span class="co">#&gt; mz 3.4850037 0.1864190</span></span>
<span><span class="co">#&gt; os 0.7802940 0.2894394</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $or</span></span>
<span><span class="co">#&gt;    Estimate Std.Err    2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt; dz    1.695  0.4063  0.8989  2.492 3.016e-05</span></span>
<span><span class="co">#&gt; mz   32.623  6.0815 20.7031 44.542 8.128e-08</span></span>
<span><span class="co">#&gt; os    2.182  0.6316  0.9442  3.420 5.504e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "plackett"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bivariate-probit-model">Bivariate Probit model<a class="anchor" aria-label="anchor" href="#bivariate-probit-model"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/mets/" class="external-link">mets</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">twinstut</span><span class="op">)</span></span>
<span><span class="va">twinstut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">twinstut</span>,<span class="va">zyg</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>,<span class="st">"dz"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">twinstut</span><span class="op">$</span><span class="va">binstut</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">twinstut</span><span class="op">$</span><span class="va">stutter</span><span class="op">==</span><span class="st">"yes"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">twinstut</span><span class="op">)</span></span>
<span><span class="co">#&gt;    tvparnr zyg stutter    sex age nr binstut</span></span>
<span><span class="co">#&gt; 1        1  mz      no female  71  1       0</span></span>
<span><span class="co">#&gt; 2        1  mz      no female  71  2       0</span></span>
<span><span class="co">#&gt; 3        2  dz      no female  71  1       0</span></span>
<span><span class="co">#&gt; 8        5  mz      no female  71  1       0</span></span>
<span><span class="co">#&gt; 9        5  mz      no female  71  2       0</span></span>
<span><span class="co">#&gt; 11       7  dz      no   male  71  1       0</span></span>
<span><span class="va">twinstut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">twinstut</span>,<span class="va">tvparnr</span> <span class="op">&lt;</span> <span class="fl">2000</span><span class="op">)</span></span></code></pre></div>
<p>First testing for same dependence in MZ and DZ that we recommend
doing by comparing the correlations of MZ and DZ twins. Apart from
regression correction in the mean this is an un-structured model, and
the useful concordance and casewise concordance estimates can be
reported from this analysis.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin</a></span><span class="op">(</span><span class="va">binstut</span><span class="op">~</span><span class="va">sex</span>,data<span class="op">=</span><span class="va">twinstut</span>,id<span class="op">=</span><span class="st">"tvparnr"</span>,zyg<span class="op">=</span><span class="st">"zyg"</span>,DZ<span class="op">=</span><span class="st">"dz"</span>,type<span class="op">=</span><span class="st">"un"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">b1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               Estimate  Std.Err        Z   p-value    </span></span>
<span><span class="co">#&gt; (Intercept)   -2.04432  0.10246 -19.9532 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; sexmale        0.41203  0.12392   3.3249 0.0008844 ***</span></span>
<span><span class="co">#&gt; atanh(rho) MZ  1.11748  0.43188   2.5875 0.0096683 ** </span></span>
<span><span class="co">#&gt; atanh(rho) DZ  0.23000  0.25889   0.8884 0.3743295    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Total MZ/DZ Complete pairs MZ/DZ</span></span>
<span><span class="co">#&gt;  583/1192    212/354             </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            Estimate 2.5%     97.5%   </span></span>
<span><span class="co">#&gt; Tetrachoric correlation MZ  0.80669  0.26456  0.96139</span></span>
<span><span class="co">#&gt; Tetrachoric correlation DZ  0.22603 -0.27052  0.62759</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MZ:</span></span>
<span><span class="co">#&gt;                      Estimate 2.5%     97.5%   </span></span>
<span><span class="co">#&gt; Concordance           0.00886  0.00272  0.02840</span></span>
<span><span class="co">#&gt; Casewise Concordance  0.43282  0.13214  0.79272</span></span>
<span><span class="co">#&gt; Marginal              0.02046  0.01258  0.03312</span></span>
<span><span class="co">#&gt; Rel.Recur.Risk       21.15321  2.70681 39.59960</span></span>
<span><span class="co">#&gt; log(OR)               4.15336  1.96005  6.34666</span></span>
<span><span class="co">#&gt; DZ:</span></span>
<span><span class="co">#&gt;                      Estimate 2.5%     97.5%   </span></span>
<span><span class="co">#&gt; Concordance           0.00128  0.00013  0.01240</span></span>
<span><span class="co">#&gt; Casewise Concordance  0.06251  0.00705  0.38497</span></span>
<span><span class="co">#&gt; Marginal              0.02046  0.01258  0.03312</span></span>
<span><span class="co">#&gt; Rel.Recur.Risk        3.05481 -3.12067  9.23029</span></span>
<span><span class="co">#&gt; log(OR)               1.20535 -1.09090  3.50161</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          Estimate 2.5% 97.5%</span></span>
<span><span class="co">#&gt; Broad-sense heritability   1      NaN  NaN</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="polygenic-modelling">Polygenic modelling<a class="anchor" aria-label="anchor" href="#polygenic-modelling"></a>
</h3>
<p>We now turn attention to specific polygenic modelling where special
random effects are used to specify ACE, AE, ADE models and so forth.
This is very easy with the bptwin function. The key parts of the output
are the sizes of the genetic component A and the environmental
component, and we can compare with the results of the unstructed model
above. Also formally we can test if this submodel is acceptable by a
likelihood ratio test.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin</a></span><span class="op">(</span><span class="va">binstut</span><span class="op">~</span><span class="va">sex</span>,data<span class="op">=</span><span class="va">twinstut</span>,id<span class="op">=</span><span class="st">"tvparnr"</span>,zyg<span class="op">=</span><span class="st">"zyg"</span>,DZ<span class="op">=</span><span class="st">"dz"</span>,type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">b1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Estimate   Std.Err       Z p-value   </span></span>
<span><span class="co">#&gt; (Intercept)  -4.20958   1.55369 -2.7094 0.00674 **</span></span>
<span><span class="co">#&gt; sexmale       0.85990   0.36387  2.3632 0.01812 * </span></span>
<span><span class="co">#&gt; log(var(A))   1.17018   0.99695  1.1738 0.24049   </span></span>
<span><span class="co">#&gt; log(var(C)) -23.53038       NaN     NaN     NaN   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Total MZ/DZ Complete pairs MZ/DZ</span></span>
<span><span class="co">#&gt;  583/1192    212/354             </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                    Estimate 2.5%     97.5%   </span></span>
<span><span class="co">#&gt; A                   0.76318  0.41002  1.11633</span></span>
<span><span class="co">#&gt; C                   0.00000  0.00000  0.00000</span></span>
<span><span class="co">#&gt; E                   0.23682 -0.11633  0.58998</span></span>
<span><span class="co">#&gt; MZ Tetrachoric Cor  0.76318  0.15672  0.95170</span></span>
<span><span class="co">#&gt; DZ Tetrachoric Cor  0.38159  0.19280  0.54313</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MZ:</span></span>
<span><span class="co">#&gt;                      Estimate 2.5%     97.5%   </span></span>
<span><span class="co">#&gt; Concordance           0.00768  0.00201  0.02893</span></span>
<span><span class="co">#&gt; Casewise Concordance  0.37943  0.09711  0.77658</span></span>
<span><span class="co">#&gt; Marginal              0.02025  0.01241  0.03289</span></span>
<span><span class="co">#&gt; Rel.Recur.Risk       18.73516 -0.13385 37.60417</span></span>
<span><span class="co">#&gt; log(OR)               3.85127  1.58182  6.12072</span></span>
<span><span class="co">#&gt; DZ:</span></span>
<span><span class="co">#&gt;                      Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Concordance          0.00230  0.00077 0.00688</span></span>
<span><span class="co">#&gt; Casewise Concordance 0.11369  0.05266 0.22841</span></span>
<span><span class="co">#&gt; Marginal             0.02025  0.01241 0.03289</span></span>
<span><span class="co">#&gt; Rel.Recur.Risk       5.61371  2.19257 9.03484</span></span>
<span><span class="co">#&gt; log(OR)              1.92764  1.16374 2.69154</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Broad-sense heritability 0.76318  0.41002 1.11633</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin</a></span><span class="op">(</span><span class="va">binstut</span><span class="op">~</span><span class="va">sex</span>,data<span class="op">=</span><span class="va">twinstut</span>,id<span class="op">=</span><span class="st">"tvparnr"</span>,zyg<span class="op">=</span><span class="st">"zyg"</span>,DZ<span class="op">=</span><span class="st">"dz"</span>,type<span class="op">=</span><span class="st">"ae"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">b0</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Estimate  Std.Err       Z p-value   </span></span>
<span><span class="co">#&gt; (Intercept) -4.20958  1.55369 -2.7094 0.00674 **</span></span>
<span><span class="co">#&gt; sexmale      0.85990  0.36387  2.3632 0.01812 * </span></span>
<span><span class="co">#&gt; log(var(A))  1.17018  0.99695  1.1738 0.24049   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Total MZ/DZ Complete pairs MZ/DZ</span></span>
<span><span class="co">#&gt;  583/1192    212/354             </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                    Estimate 2.5%     97.5%   </span></span>
<span><span class="co">#&gt; A                   0.76318  0.41002  1.11633</span></span>
<span><span class="co">#&gt; E                   0.23682 -0.11633  0.58998</span></span>
<span><span class="co">#&gt; MZ Tetrachoric Cor  0.76318  0.15672  0.95170</span></span>
<span><span class="co">#&gt; DZ Tetrachoric Cor  0.38159  0.19280  0.54313</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MZ:</span></span>
<span><span class="co">#&gt;                      Estimate 2.5%     97.5%   </span></span>
<span><span class="co">#&gt; Concordance           0.00768  0.00201  0.02893</span></span>
<span><span class="co">#&gt; Casewise Concordance  0.37943  0.09711  0.77658</span></span>
<span><span class="co">#&gt; Marginal              0.02025  0.01241  0.03289</span></span>
<span><span class="co">#&gt; Rel.Recur.Risk       18.73517 -0.13386 37.60419</span></span>
<span><span class="co">#&gt; log(OR)               3.85127  1.58182  6.12072</span></span>
<span><span class="co">#&gt; DZ:</span></span>
<span><span class="co">#&gt;                      Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Concordance          0.00230  0.00077 0.00688</span></span>
<span><span class="co">#&gt; Casewise Concordance 0.11369  0.05266 0.22841</span></span>
<span><span class="co">#&gt; Marginal             0.02025  0.01241 0.03289</span></span>
<span><span class="co">#&gt; Rel.Recur.Risk       5.61371  2.19257 9.03484</span></span>
<span><span class="co">#&gt; log(OR)              1.92764  1.16374 2.69154</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Broad-sense heritability 0.76318  0.41002 1.11633</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="additive-gamma-random-effects">Additive gamma random effects<a class="anchor" aria-label="anchor" href="#additive-gamma-random-effects"></a>
</h3>
<p>Fitting first a model with different size random effects for MZ and
DZ. We note that as before in the OR and biprobit model the dependence
is much stronger for MZ twins. We also test if these are the same by
parametrizing the OR model with an intercept. This clearly shows a
significant difference.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span> <span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span>,data<span class="op">=</span><span class="va">twinstut</span><span class="op">)</span></span>
<span><span class="va">margbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">binstut</span><span class="op">~</span><span class="va">sex</span>,data<span class="op">=</span><span class="va">twinstut</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bintwin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">margbin</span>,data<span class="op">=</span><span class="va">twinstut</span>,model<span class="op">=</span><span class="st">"gamma"</span>,</span>
<span>     clusters<span class="op">=</span><span class="va">twinstut</span><span class="op">$</span><span class="va">tvparnr</span>,detail<span class="op">=</span><span class="fl">0</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">/</span><span class="fl">1</span>,var.link<span class="op">=</span><span class="fl">1</span>,</span>
<span>     theta.des<span class="op">=</span><span class="va">theta.des</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bintwin</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                     theta        se</span></span>
<span><span class="co">#&gt; factor(zyg)dz -2.13348460 1.0821489</span></span>
<span><span class="co">#&gt; factor(zyg)mz -0.07740026 0.5790839</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vargam</span></span>
<span><span class="co">#&gt;               Estimate Std.Err    2.5%  97.5% P-value</span></span>
<span><span class="co">#&gt; factor(zyg)dz   0.1184  0.1282 -0.1327 0.3696 0.35544</span></span>
<span><span class="co">#&gt; factor(zyg)mz   0.9255  0.5360 -0.1249 1.9760 0.08419</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "gamma"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span></span>
<span><span class="co"># test for same dependence in MZ and DZ </span></span>
<span><span class="va">theta.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span>,data<span class="op">=</span><span class="va">twinstut</span><span class="op">)</span></span>
<span><span class="va">margbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">binstut</span><span class="op">~</span><span class="va">sex</span>,data<span class="op">=</span><span class="va">twinstut</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bintwin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">margbin</span>,data<span class="op">=</span><span class="va">twinstut</span>,model<span class="op">=</span><span class="st">"gamma"</span>,</span>
<span>     clusters<span class="op">=</span><span class="va">twinstut</span><span class="op">$</span><span class="va">tvparnr</span>,detail<span class="op">=</span><span class="fl">0</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">/</span><span class="fl">1</span>,var.link<span class="op">=</span><span class="fl">1</span>,</span>
<span>     theta.des<span class="op">=</span><span class="va">theta.des</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bintwin</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                   theta       se</span></span>
<span><span class="co">#&gt; (Intercept)   -2.133485 1.082149</span></span>
<span><span class="co">#&gt; factor(zyg)mz  2.056084 1.227348</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vargam</span></span>
<span><span class="co">#&gt;               Estimate Std.Err     2.5%   97.5% P-value</span></span>
<span><span class="co">#&gt; (Intercept)     0.1184  0.1282  -0.1327  0.3696  0.3554</span></span>
<span><span class="co">#&gt; factor(zyg)mz   7.8153  9.5921 -10.9849 26.6155  0.4152</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "gamma"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="polygenic-modelling-1">Polygenic modelling<a class="anchor" aria-label="anchor" href="#polygenic-modelling-1"></a>
</h3>
<p>First setting up the random effects design for the random effects and
the the relationship between variance parameters. We see that the
genetic random effect has size one for MZ and 0.5 for DZ subjects, that
have shared and non-shared genetic components with variance 0.5 such
that the total genetic variance is the same for all subjects. The shared
environmental effect is the samme for all. Thus two parameters with
these bands.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">twinstut</span>,id<span class="op">=</span><span class="st">"tvparnr"</span>,zygname<span class="op">=</span><span class="st">"zyg"</span>,zyg<span class="op">=</span><span class="st">"dz"</span>,type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>,<span class="va">twinstut</span><span class="op">$</span><span class="va">tvparnr</span><span class="op">)</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;    MZ DZ DZns1 DZns2 env   </span></span>
<span><span class="co">#&gt; 1   1  0     0     0   1  1</span></span>
<span><span class="co">#&gt; 2   1  0     0     0   1  1</span></span>
<span><span class="co">#&gt; 3   0  1     1     0   1  2</span></span>
<span><span class="co">#&gt; 8   1  0     0     0   1  5</span></span>
<span><span class="co">#&gt; 9   1  0     0     0   1  5</span></span>
<span><span class="co">#&gt; 11  0  1     1     0   1  7</span></span>
<span><span class="co">#&gt; 12  0  1     1     0   1  8</span></span>
<span><span class="co">#&gt; 13  0  1     0     1   1  8</span></span>
<span><span class="co">#&gt; 15  0  1     1     0   1 10</span></span>
<span><span class="co">#&gt; 18  0  1     1     0   1 12</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]  1.0    0</span></span>
<span><span class="co">#&gt; [2,]  0.5    0</span></span>
<span><span class="co">#&gt; [3,]  0.5    0</span></span>
<span><span class="co">#&gt; [4,]  0.5    0</span></span>
<span><span class="co">#&gt; [5,]  0.0    1</span></span></code></pre></div>
<p>Now, fitting the ACE model, we see that the variance of the genetic,
component, is 1.5 and the environmental variance is -0.5. Thus
suggesting that the ACE model does not fit the data. When the random
design is given we automatically use the gamma fralty model.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">margbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">binstut</span><span class="op">~</span><span class="va">sex</span>,data<span class="op">=</span><span class="va">twinstut</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bintwin1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">margbin</span>,data<span class="op">=</span><span class="va">twinstut</span>,</span>
<span>     clusters<span class="op">=</span><span class="va">twinstut</span><span class="op">$</span><span class="va">tvparnr</span>,detail<span class="op">=</span><span class="fl">0</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">/</span><span class="fl">1</span>,var.link<span class="op">=</span><span class="fl">0</span>,</span>
<span>     random.design<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bintwin1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                  theta        se</span></span>
<span><span class="co">#&gt; dependence1  1.1700713 0.9350041</span></span>
<span><span class="co">#&gt; dependence2 -0.2552978 0.5910697</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;             Estimate Std.Err     2.5%  97.5% P-value</span></span>
<span><span class="co">#&gt; dependence1   1.2791  0.6039  0.09552 2.4626 0.03416</span></span>
<span><span class="co">#&gt; dependence2  -0.2791  0.6039 -1.46265 0.9045 0.64397</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err    2.5% 97.5% P-value</span></span>
<span><span class="co">#&gt; p1   0.9148  0.5352 -0.1343 1.964 0.08744</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>For this model we estimate the concordance and casewise concordance
as well as the marginal rates of stuttering for females.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/internal.html">concordanceTwinACE</a></span><span class="op">(</span><span class="va">bintwin1</span>,type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $MZ</span></span>
<span><span class="co">#&gt;                      Estimate  Std.Err     2.5%   97.5%   P-value</span></span>
<span><span class="co">#&gt; concordance          0.009738 0.004010 0.001878 0.01760 1.517e-02</span></span>
<span><span class="co">#&gt; casewise concordance 0.476141 0.190613 0.102547 0.84974 1.249e-02</span></span>
<span><span class="co">#&gt; marginal             0.020452 0.005083 0.010489 0.03041 5.733e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $DZ</span></span>
<span><span class="co">#&gt;                      Estimate  Std.Err       2.5%   97.5%   P-value</span></span>
<span><span class="co">#&gt; concordance          0.001301 0.001158 -0.0009681 0.00357 2.611e-01</span></span>
<span><span class="co">#&gt; casewise concordance 0.063604 0.057255 -0.0486137 0.17582 2.666e-01</span></span>
<span><span class="co">#&gt; marginal             0.020452 0.005083  0.0104894 0.03041 5.733e-05</span></span></code></pre></div>
<p>The E component was not consistent with the fit of the data and we
now consider instead the AE model.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">twinstut</span>,id<span class="op">=</span><span class="st">"tvparnr"</span>,zygname<span class="op">=</span><span class="st">"zyg"</span>,zyg<span class="op">=</span><span class="st">"dz"</span>,type<span class="op">=</span><span class="st">"ae"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bintwin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">margbin</span>,data<span class="op">=</span><span class="va">twinstut</span>,</span>
<span>     clusters<span class="op">=</span><span class="va">twinstut</span><span class="op">$</span><span class="va">tvparnr</span>,detail<span class="op">=</span><span class="fl">0</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">/</span><span class="fl">1</span>,var.link<span class="op">=</span><span class="fl">0</span>,</span>
<span>     random.design<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bintwin</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 theta        se</span></span>
<span><span class="co">#&gt; dependence1 0.8485392 0.4941264</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;             Estimate Std.Err 2.5% 97.5% P-value</span></span>
<span><span class="co">#&gt; dependence1        1       0    1     1       0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err    2.5% 97.5% P-value</span></span>
<span><span class="co">#&gt; p1   0.8485  0.4941 -0.1199 1.817 0.08593</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>Again, the concordance can be computed:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/internal.html">concordanceTwinACE</a></span><span class="op">(</span><span class="va">bintwin</span>,type<span class="op">=</span><span class="st">"ae"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $MZ</span></span>
<span><span class="co">#&gt;                      Estimate  Std.Err     2.5%   97.5%   P-value</span></span>
<span><span class="co">#&gt; concordance          0.009236 0.003778 0.001831 0.01664 1.450e-02</span></span>
<span><span class="co">#&gt; casewise concordance 0.451605 0.189131 0.080916 0.82229 1.695e-02</span></span>
<span><span class="co">#&gt; marginal             0.020452 0.005083 0.010489 0.03041 5.733e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $DZ</span></span>
<span><span class="co">#&gt;                      Estimate   Std.Err      2.5%    97.5%   P-value</span></span>
<span><span class="co">#&gt; concordance          0.001966 0.0007099 0.0005741 0.003357 5.628e-03</span></span>
<span><span class="co">#&gt; casewise concordance 0.096106 0.0196561 0.0575803 0.134631 1.012e-06</span></span>
<span><span class="co">#&gt; marginal             0.020452 0.0050831 0.0104894 0.030415 5.733e-05</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="sessioninfo">SessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] mets_1.3.9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] cli_3.6.5              knitr_1.51             rlang_1.1.7           </span></span>
<span><span class="co">#&gt;  [4] xfun_0.55              textshaping_1.0.4      jsonlite_2.0.0        </span></span>
<span><span class="co">#&gt;  [7] listenv_0.10.0         future.apply_1.20.1    lava_1.8.2            </span></span>
<span><span class="co">#&gt; [10] htmltools_0.5.9        ragg_1.5.0             sass_0.4.10           </span></span>
<span><span class="co">#&gt; [13] rmarkdown_2.30         grid_4.5.2             evaluate_1.0.5        </span></span>
<span><span class="co">#&gt; [16] jquerylib_0.1.4        fastmap_1.2.0          numDeriv_2016.8-1.1   </span></span>
<span><span class="co">#&gt; [19] yaml_2.3.12            mvtnorm_1.3-3          lifecycle_1.0.5       </span></span>
<span><span class="co">#&gt; [22] timereg_2.0.7          compiler_4.5.2         codetools_0.2-20      </span></span>
<span><span class="co">#&gt; [25] fs_1.6.6               ucminf_1.2.2           htmlwidgets_1.6.4     </span></span>
<span><span class="co">#&gt; [28] Rcpp_1.1.1             future_1.68.0          lattice_0.22-7        </span></span>
<span><span class="co">#&gt; [31] systemfonts_1.3.1      digest_0.6.39          R6_2.6.1              </span></span>
<span><span class="co">#&gt; [34] parallelly_1.46.1      parallel_4.5.2         splines_4.5.2         </span></span>
<span><span class="co">#&gt; [37] Matrix_1.7-4           bslib_0.9.0            tools_4.5.2           </span></span>
<span><span class="co">#&gt; [40] RcppArmadillo_15.2.3-1 globals_0.18.0         survival_3.8-3        </span></span>
<span><span class="co">#&gt; [43] pkgdown_2.2.0          cachem_1.1.0           desc_1.4.3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>

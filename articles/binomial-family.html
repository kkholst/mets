<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis of multivariate binomial data: family analysis • mets</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of multivariate binomial data: family analysis">
<meta property="og:description" content="mets">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a>
    </li>
    <li>
      <a href="../articles/binreg.html">Binomial Regression</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/mediation-survival.html">Mediation Analysis for survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/rmst-ate.html">Average treatment effect (ATE) for Restricted mean survival and years lost of Competing risks</a>
    </li>
    <li>
      <a href="../articles/survival-ate.html">Average treatment effect (ATE) based on the Cox and Fine-Gray model</a>
    </li>
    <li>
      <a href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kkholst/mets/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="binomial-family_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysis of multivariate binomial data: family analysis</h1>
                        <h4 data-toc-skip class="author">Klaus Holst &amp; Thomas Scheike</h4>
            
            <h4 data-toc-skip class="date">2023-01-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/HEAD/vignettes/binomial-family.Rmd" class="external-link"><code>vignettes/binomial-family.Rmd</code></a></small>
      <div class="hidden name"><code>binomial-family.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>When looking at multivariate binomial data with the aim of learning about the dependence that is present, possibly after correcting for some covariates many models are available.</p>
<ul>
<li>Random-effects models logistic regression covered elsewhere (glmer in lme4).</li>
</ul>
<p>in the mets package you can fit the</p>
<ul>
<li><p>Pairwise odds ratio model</p></li>
<li>
<p>Bivariate Probit model</p>
<ul>
<li>With random effects</li>
<li>Special functionality for polygenic random effects modelling such as ACE, ADE ,AE and so forth.</li>
</ul>
</li>
<li>
<p>Additive gamma random effects model</p>
<ul>
<li>Special functionality for polygenic random effects modelling such as ACE, ADE ,AE and so forth.</li>
</ul>
</li>
</ul>
<p>These last three models are all fitted in the mets package using composite likelihoods for pairs of data. The models can be fitted specifically based on specifying which pairs one wants to use for the composite score.</p>
<p>The models are described in futher details in the binomial-twin vignette.</p>
</div>
<div class="section level2">
<h2 id="simulated-family-data">Simulated family data<a class="anchor" aria-label="anchor" href="#simulated-family-data"></a>
</h2>
<p>We start by simulating family data with and additive gamma structure on ACE form. Here 10000 families consisting of two parents and two children. The response is ybin and there is one covariate x.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/mets/" class="external-link">mets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/scheike/timereg" class="external-link">timereg</a></span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span> <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">simbinClaytonOakes.family.ace</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">2</span>,<span class="fl">1</span>,beta<span class="op">=</span><span class="cn">NULL</span>,alpha<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span> <span class="va">data</span><span class="op">$</span><span class="va">number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span>
<span> <span class="va">data</span><span class="op">$</span><span class="va">child</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">number</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ybin x   type cluster number child</span></span>
<span><span class="co">#&gt; 1    1 1 mother       1      1     0</span></span>
<span><span class="co">#&gt; 2    0 1 father       1      2     0</span></span>
<span><span class="co">#&gt; 3    1 1  child       1      3     1</span></span>
<span><span class="co">#&gt; 4    0 1  child       1      4     0</span></span>
<span><span class="co">#&gt; 5    1 0 mother       2      1     0</span></span>
<span><span class="co">#&gt; 6    0 0 father       2      2     0</span></span></code></pre></div>
<p>We fit the marginal models, and here find a covariate effect at 0.3 for x. The marginals can be specified excatly as one wants.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">aa</span> <span class="op">&lt;-</span> <span class="va">margbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">ybin</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">data</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aa</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = ybin ~ x, family = binomial(), data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals: </span></span>
<span><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co">#&gt; -1.5202  -1.4036   0.8697   0.9669   0.9669  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)  0.51765    0.04676   11.07   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; x            0.25959    0.06673    3.89    1e-04 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 5146.6  on 3999  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 5131.5  on 3998  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 5135.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="additive-gamma-model">Additive gamma model<a class="anchor" aria-label="anchor" href="#additive-gamma-model"></a>
</h2>
<p>For the additive gamma of this type we set-up the random effects included in such a family to make the ACE valid using some special functions for this.</p>
<p>The model is constructe with one enviromental effect shared by all in the family and 8 genetic random effects with size (1/4) genetic variance. Looking at the first family we see that the mother and father both share half the genes with the children and that the two children also share half their genes with this specification. Below we also show an alternative specification of this model using all pairs.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make ace random effects design</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">ace.family.design</a></span><span class="op">(</span><span class="va">data</span>,member<span class="op">=</span><span class="st">"type"</span>,id<span class="op">=</span><span class="st">"cluster"</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt;  [1,] 0.25    0</span></span>
<span><span class="co">#&gt;  [2,] 0.25    0</span></span>
<span><span class="co">#&gt;  [3,] 0.25    0</span></span>
<span><span class="co">#&gt;  [4,] 0.25    0</span></span>
<span><span class="co">#&gt;  [5,] 0.25    0</span></span>
<span><span class="co">#&gt;  [6,] 0.25    0</span></span>
<span><span class="co">#&gt;  [7,] 0.25    0</span></span>
<span><span class="co">#&gt;  [8,] 0.25    0</span></span>
<span><span class="co">#&gt;  [9,] 0.00    1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;      m1 m2 m3 m4 f1 f2 f3 f4 env</span></span>
<span><span class="co">#&gt; [1,]  1  1  1  1  0  0  0  0   1</span></span>
<span><span class="co">#&gt; [2,]  0  0  0  0  1  1  1  1   1</span></span>
<span><span class="co">#&gt; [3,]  1  1  0  0  1  1  0  0   1</span></span>
<span><span class="co">#&gt; [4,]  1  0  1  0  1  0  1  0   1</span></span></code></pre></div>
<p>We can now fit the model calling the two-stage function</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fitting ace model for family structure</span></span>
<span><span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">margbin</span>,data<span class="op">=</span><span class="va">data</span>,clusters<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>random.design<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 theta        se</span></span>
<span><span class="co">#&gt; dependence1 2.5726358 0.6212573</span></span>
<span><span class="co">#&gt; dependence2 0.8903891 0.2487322</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;             Estimate Std.Err   2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt; dependence1   0.7429 0.07228 0.6012 0.8845 8.833e-25</span></span>
<span><span class="co">#&gt; dependence2   0.2571 0.07228 0.1155 0.3988 3.747e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1    3.463  0.6574 2.175 4.751 1.381e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span><span class="co"># true variance parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2 1</span></span>
<span><span class="co"># total variance </span></span>
<span><span class="fl">3</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pairwise-fitting">Pairwise fitting<a class="anchor" aria-label="anchor" href="#pairwise-fitting"></a>
</h2>
<p>We now specify the same model via extracting all pairs.<br>
The random effecs structure is typically simpler when just looking at pairs, but we start by specifying the random effects jointly for whole family. A special function writes up all combinations of pairs. There are 6 pairs within each family, and we keep track of who belongs to the different families. We first simply give the pairs and we then should get the same result as before.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/familycluster.index.html">familycluster.index</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mm</span><span class="op">$</span><span class="va">familypairindex</span>,n<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1 2 1 3 1 4 2 3 2 4 3 4 5 6 5 7 5 8 6 7</span></span>
<span><span class="va">pairs</span> <span class="op">&lt;-</span> <span class="va">mm</span><span class="op">$</span><span class="va">pairs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6000    2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pairs</span>,<span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt;  [1,]    1    2</span></span>
<span><span class="co">#&gt;  [2,]    1    3</span></span>
<span><span class="co">#&gt;  [3,]    1    4</span></span>
<span><span class="co">#&gt;  [4,]    2    3</span></span>
<span><span class="co">#&gt;  [5,]    2    4</span></span>
<span><span class="co">#&gt;  [6,]    3    4</span></span>
<span><span class="co">#&gt;  [7,]    5    6</span></span>
<span><span class="co">#&gt;  [8,]    5    7</span></span>
<span><span class="co">#&gt;  [9,]    5    8</span></span>
<span><span class="co">#&gt; [10,]    6    7</span></span>
<span><span class="co">#&gt; [11,]    6    8</span></span>
<span><span class="co">#&gt; [12,]    7    8</span></span></code></pre></div>
<p>Now with the pairs we fit the model</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">margbin</span>,data<span class="op">=</span><span class="va">data</span>,clusters<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,detail<span class="op">=</span><span class="fl">0</span>,</span>
<span>        random.design<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span>,pairs<span class="op">=</span><span class="va">pairs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 theta        se</span></span>
<span><span class="co">#&gt; dependence1 2.5726358 0.6212573</span></span>
<span><span class="co">#&gt; dependence2 0.8903891 0.2487322</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;             Estimate Std.Err   2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt; dependence1   0.7429 0.07228 0.6012 0.8845 8.833e-25</span></span>
<span><span class="co">#&gt; dependence2   0.2571 0.07228 0.1155 0.3988 3.747e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1    3.463  0.6574 2.175 4.751 1.381e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>Here a random sample of pairs are given instead and we get other estimates.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">ssid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tsd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">aa</span>,data<span class="op">=</span><span class="va">data</span>,clusters<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>               theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,step<span class="op">=</span><span class="fl">1.0</span>,</span>
<span>               random.design<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>,iid<span class="op">=</span><span class="fl">1</span>,Nit<span class="op">=</span><span class="fl">10</span>,</span>
<span>               theta.des<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span>,pairs<span class="op">=</span><span class="va">pairs</span><span class="op">[</span><span class="va">ssid</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsd</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 theta        se</span></span>
<span><span class="co">#&gt; dependence1 1.9018993 0.7610494</span></span>
<span><span class="co">#&gt; dependence2 0.9473264 0.2636491</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; dependence1   0.6675  0.1217 0.42901 0.906 4.122e-08</span></span>
<span><span class="co">#&gt; dependence2   0.3325  0.1217 0.09399 0.571 6.289e-03</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1    2.849  0.7315 1.415 4.283 9.823e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>To specify such a model when only the pairs are available we show how to specify the model. We here use the same marginal “aa” to make the results comparable. The marginal can also be fitted based on available data.</p>
<p>We start by selecting the data related to the pairs, and sets up new id’s and to start we specify the model using the full design with 9 random effects. Below we show how one can use with only the random effects needed for each pair, which is typically simpler.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">[</span><span class="va">ssid</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    2</span></span>
<span><span class="co">#&gt; [2,]    2    3</span></span>
<span><span class="co">#&gt; [3,]    3    4</span></span>
<span><span class="co">#&gt; [4,]    5    6</span></span>
<span><span class="co">#&gt; [5,]    9   11</span></span>
<span><span class="co">#&gt; [6,]   10   11</span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">[</span><span class="va">ssid</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pairsids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">[</span><span class="va">ssid</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="va">pair.new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="../reference/fast.approx.html">fast.approx</a></span><span class="op">(</span><span class="va">ids</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">[</span><span class="va">ssid</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pair.new</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    2</span></span>
<span><span class="co">#&gt; [2,]    2    3</span></span>
<span><span class="co">#&gt; [3,]    3    4</span></span>
<span><span class="co">#&gt; [4,]    5    6</span></span>
<span><span class="co">#&gt; [5,]    7    9</span></span>
<span><span class="co">#&gt; [6,]    8    9</span></span>
<span></span>
<span><span class="va">dataid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dsort.html">dsort</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">ids</span>,<span class="op">]</span>,<span class="st">"cluster"</span><span class="op">)</span></span>
<span><span class="va">outid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">ace.family.design</a></span><span class="op">(</span><span class="va">dataid</span>,member<span class="op">=</span><span class="st">"type"</span>,id<span class="op">=</span><span class="st">"cluster"</span><span class="op">)</span></span>
<span><span class="va">outid</span><span class="op">$</span><span class="va">pardes</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt;  [1,] 0.25    0</span></span>
<span><span class="co">#&gt;  [2,] 0.25    0</span></span>
<span><span class="co">#&gt;  [3,] 0.25    0</span></span>
<span><span class="co">#&gt;  [4,] 0.25    0</span></span>
<span><span class="co">#&gt;  [5,] 0.25    0</span></span>
<span><span class="co">#&gt;  [6,] 0.25    0</span></span>
<span><span class="co">#&gt;  [7,] 0.25    0</span></span>
<span><span class="co">#&gt;  [8,] 0.25    0</span></span>
<span><span class="co">#&gt;  [9,] 0.00    1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">outid</span><span class="op">$</span><span class="va">des.rv</span><span class="op">)</span></span>
<span><span class="co">#&gt;      m1 m2 m3 m4 f1 f2 f3 f4 env</span></span>
<span><span class="co">#&gt; [1,]  1  1  1  1  0  0  0  0   1</span></span>
<span><span class="co">#&gt; [2,]  0  0  0  0  1  1  1  1   1</span></span>
<span><span class="co">#&gt; [3,]  1  1  0  0  1  1  0  0   1</span></span>
<span><span class="co">#&gt; [4,]  1  0  1  0  1  0  1  0   1</span></span>
<span><span class="co">#&gt; [5,]  1  1  1  1  0  0  0  0   1</span></span>
<span><span class="co">#&gt; [6,]  0  0  0  0  1  1  1  1   1</span></span></code></pre></div>
<p>Now fitting the model with the data set up</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">ybin</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">dataid</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tsdid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">aa</span>,data<span class="op">=</span><span class="va">dataid</span>,clusters<span class="op">=</span><span class="va">dataid</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>         theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,random.design<span class="op">=</span><span class="va">outid</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">outid</span><span class="op">$</span><span class="va">pardes</span>,pairs<span class="op">=</span><span class="va">pair.new</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsdid</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 theta        se</span></span>
<span><span class="co">#&gt; dependence1 1.8988989 0.7589513</span></span>
<span><span class="co">#&gt; dependence2 0.9469586 0.2573599</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt; dependence1   0.6673  0.1215 0.42907 0.9054 4.004e-08</span></span>
<span><span class="co">#&gt; dependence2   0.3327  0.1215 0.09457 0.5709 6.179e-03</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1    2.846  0.7236 1.428 4.264 8.393e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>We now specify the design specifically using the pairs. The random.design and design on the parameters are now given for each pair, as a 3 dimensional matrix. with a direct specification of random.design and the design on the parameters theta.design. In addition we need also to give the number of random effects for each pair. These basic things are constructed by certain functions for the ACE design.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pair.types</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">dataid</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">pair.new</span><span class="op">)</span><span class="op">)</span>,<span class="st">"type"</span><span class="op">]</span>,byrow<span class="op">=</span><span class="cn">T</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pair.new</span>,<span class="fl">7</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    2</span></span>
<span><span class="co">#&gt; [2,]    2    3</span></span>
<span><span class="co">#&gt; [3,]    3    4</span></span>
<span><span class="co">#&gt; [4,]    5    6</span></span>
<span><span class="co">#&gt; [5,]    7    9</span></span>
<span><span class="co">#&gt; [6,]    8    9</span></span>
<span><span class="co">#&gt; [7,]    8   10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pair.types</span>,<span class="fl">7</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]     [,2]    </span></span>
<span><span class="co">#&gt; [1,] "mother" "father"</span></span>
<span><span class="co">#&gt; [2,] "father" "child" </span></span>
<span><span class="co">#&gt; [3,] "child"  "child" </span></span>
<span><span class="co">#&gt; [4,] "mother" "father"</span></span>
<span><span class="co">#&gt; [5,] "mother" "child" </span></span>
<span><span class="co">#&gt; [6,] "father" "child" </span></span>
<span><span class="co">#&gt; [7,] "father" "child"</span></span>
<span><span class="co">###</span></span>
<span><span class="va">theta.des</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">random.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mf</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">pair.types</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">==</span><span class="st">"mother"</span> <span class="op">&amp;</span> <span class="va">pair.types</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="st">"father"</span><span class="op">)</span></span>
<span><span class="co">##          pair, rv related to pairs,  theta.des related to pair </span></span>
<span><span class="va">pairs.new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pair.new</span>,<span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span><span class="op">+</span><span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="fl">3</span>,<span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span><span class="op">+</span><span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>,<span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span><span class="op">+</span><span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span>,<span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">3</span><span class="op">+</span><span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>pairs.new is matrix with</p>
<ul>
<li><p>columns 1:2 giving the indeces of the data points</p></li>
<li><p>columns 3:4 giving the indeces of the random.design for the different pairs</p></li>
<li><p>columns 5 giving the indeces of the theta.des written as rows</p></li>
<li><p>columns 6 giving the number of random variables for this pair</p></li>
</ul>
<p>The length of all rows of theta.des are the maximum number of random effects <span class="math inline">\(\times\)</span> the number of parameters. These two numbers are given in the call. In this case 4 <span class="math inline">\(\times\)</span> 2. So theta.des has rows of length <span class="math inline">\(8\)</span>, possibly including some 0’s for rows not relevant due to fewer random effects, as is the case here for pairs that do not share genetic effects.</p>
<p>For pair 1 that is a mother/farther pair, we see that they share 1 environmental random effect of size 1. There are also two genetic effects that are unshared between the two. So a total of 3 random effects are needed here. The theta.des relates the 3 random effects to possible relationships in the parameters. Here the genetic effects are full and so is the environmental effect. In contrast we also consider a mother/child pair that share half the genes, now with random effects with (1/2) gene variance. We there need 4 random effects, 2 non-shared half-gene, 1 shared half-gene, and one shared full environmental effect.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3 rvs here </span></span>
<span><span class="va">random.des</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    1    0    1    0</span></span>
<span><span class="co">#&gt; [2,]    0    1    1    0</span></span>
<span><span class="co">#&gt; [3,]    1    1    0    1</span></span>
<span><span class="co">#&gt; [4,]    1    0    1    1</span></span>
<span><span class="va">theta.des</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]</span></span>
<span><span class="co">#&gt; [1,]  1.0  1.0  0.0    0    0    0    1    0</span></span>
<span><span class="co">#&gt; [2,]  0.5  0.5  0.5    0    0    0    0    1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pairs.new</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">#&gt; [1,]    1    2    1    2    1    3</span></span>
<span><span class="co">#&gt; [2,]    2    3    3    4    2    4</span></span>
<span><span class="co">#&gt; [3,]    3    4    3    4    2    4</span></span>
<span><span class="co">#&gt; [4,]    5    6    1    2    1    3</span></span>
<span><span class="co">#&gt; [5,]    7    9    3    4    2    4</span></span>
<span><span class="co">#&gt; [6,]    8    9    3    4    2    4</span></span></code></pre></div>
<p>Now fitting the model, and we see that it is a lot quicker due to the fewer random effects needed for pairs. We need to also specify the number of parameters in this case.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsdid2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">aa</span>,data<span class="op">=</span><span class="va">dataid</span>,clusters<span class="op">=</span><span class="va">dataid</span><span class="op">$</span><span class="va">cluster</span>, theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>           random.design<span class="op">=</span><span class="va">random.des</span>,theta.des<span class="op">=</span><span class="va">theta.des</span>,pairs<span class="op">=</span><span class="va">pairs.new</span>,dim.theta<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsdid2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 theta        se</span></span>
<span><span class="co">#&gt; dependence1 1.8988989 0.7589513</span></span>
<span><span class="co">#&gt; dependence2 0.9469586 0.2573599</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt; dependence1   0.6673  0.1215 0.42907 0.9054 4.004e-08</span></span>
<span><span class="co">#&gt; dependence2   0.3327  0.1215 0.09457 0.5709 6.179e-03</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1    2.846  0.7236 1.428 4.264 8.393e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>The same model can be specifed even simpler via the kinship coefficient. For this speicification there are 4 random effects for each pair, but some have variance 0. The mother-father pair, here shares a random effect with variance 0, and have two non-shared genetic effects with full variance, in addition to a fully shared environmental effect.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kinship</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pair.types</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">kinship</span><span class="op">[</span><span class="va">pair.types</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">==</span><span class="st">"mother"</span> <span class="op">&amp;</span> <span class="va">pair.types</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="st">"father"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kinship</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 0.0 0.5 0.5 0.0 0.5 0.5 0.5 0.5 0.0 0.5</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">make.pairwise.design</a></span><span class="op">(</span><span class="va">pair.new</span>,<span class="va">kinship</span>,type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsdid3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">aa</span>,data<span class="op">=</span><span class="va">dataid</span>,clusters<span class="op">=</span><span class="va">dataid</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>             theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">9</span>,random.design<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">random.design</span>,</span>
<span>             theta.des<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">theta.des</span>,pairs<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">new.pairs</span>,dim.theta<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsdid3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 theta        se</span></span>
<span><span class="co">#&gt; dependence1 1.8988989 0.7589513</span></span>
<span><span class="co">#&gt; dependence2 0.9469586 0.2573599</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt; dependence1   0.6673  0.1215 0.42907 0.9054 4.004e-08</span></span>
<span><span class="co">#&gt; dependence2   0.3327  0.1215 0.09457 0.5709 6.179e-03</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1    2.846  0.7236 1.428 4.264 8.393e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<div class="section level3">
<h3 id="pairwise-dependence-modelling">Pairwise dependence modelling<a class="anchor" aria-label="anchor" href="#pairwise-dependence-modelling"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/mets/" class="external-link">mets</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">simbinClaytonOakes.family.ace</a></span><span class="op">(</span><span class="fl">10000</span>,<span class="fl">2</span>,<span class="fl">1</span>,beta<span class="op">=</span><span class="cn">NULL</span>,alpha<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ybin x   type cluster</span></span>
<span><span class="co">#&gt; 1    1 1 mother       1</span></span>
<span><span class="co">#&gt; 2    0 1 father       1</span></span>
<span><span class="co">#&gt; 3    1 1  child       1</span></span>
<span><span class="co">#&gt; 4    1 0  child       1</span></span>
<span><span class="co">#&gt; 5    1 1 mother       2</span></span>
<span><span class="co">#&gt; 6    1 1 father       2</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">child</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">number</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/familycluster.index.html">familycluster.index</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mm</span><span class="op">$</span><span class="va">familypairindex</span>,n<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1 2 1 3 1 4 2 3 2 4 3 4 5 6 5 7 5 8 6 7</span></span>
<span><span class="va">pairs</span> <span class="op">&lt;-</span> <span class="va">mm</span><span class="op">$</span><span class="va">pairs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 60000     2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pairs</span>,<span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt;  [1,]    1    2</span></span>
<span><span class="co">#&gt;  [2,]    1    3</span></span>
<span><span class="co">#&gt;  [3,]    1    4</span></span>
<span><span class="co">#&gt;  [4,]    2    3</span></span>
<span><span class="co">#&gt;  [5,]    2    4</span></span>
<span><span class="co">#&gt;  [6,]    3    4</span></span>
<span><span class="co">#&gt;  [7,]    5    6</span></span>
<span><span class="co">#&gt;  [8,]    5    7</span></span>
<span><span class="co">#&gt;  [9,]    5    8</span></span>
<span><span class="co">#&gt; [10,]    6    7</span></span>
<span><span class="co">#&gt; [11,]    6    8</span></span>
<span><span class="co">#&gt; [12,]    7    8</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">dtypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span> <span class="va">data</span><span class="op">[</span><span class="va">pairs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="st">"type"</span><span class="op">]</span>, <span class="va">data</span><span class="op">[</span><span class="va">pairs</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="st">"type"</span><span class="op">]</span><span class="op">)</span></span>
<span> <span class="va">dtypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">dtypes</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dtypes</span><span class="op">)</span></span>
<span><span class="co">#&gt; dtypes</span></span>
<span><span class="co">#&gt;   child.child  father.child  mother.child mother.father </span></span>
<span><span class="co">#&gt;         10000         20000         20000         10000</span></span>
<span> <span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dtypes</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now with the pairs we fit the model</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">ybin</span><span class="op">~</span><span class="va">x</span>,data<span class="op">=</span><span class="va">data</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tsp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binomial.twostage.html">binomial.twostage</a></span><span class="op">(</span><span class="va">aa</span>,data<span class="op">=</span><span class="va">data</span>, clusters<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>         theta.des<span class="op">=</span><span class="va">dm</span>,pairs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pairs</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                                theta         se</span></span>
<span><span class="co">#&gt; factor(dtypes)child.child   4.426619 0.20125594</span></span>
<span><span class="co">#&gt; factor(dtypes)father.child  4.439122 0.15953961</span></span>
<span><span class="co">#&gt; factor(dtypes)mother.child  4.348930 0.15659723</span></span>
<span><span class="co">#&gt; factor(dtypes)mother.father 2.045588 0.08999444</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $log.or</span></span>
<span><span class="co">#&gt;                             Estimate Std.Err   2.5%  97.5%    P-value</span></span>
<span><span class="co">#&gt; factor(dtypes)child.child     1.4876 0.04546 1.3985 1.5767 7.978e-235</span></span>
<span><span class="co">#&gt; factor(dtypes)father.....     1.4905 0.03594 1.4200 1.5609  0.000e+00</span></span>
<span><span class="co">#&gt; factor(dtypes)mother.....     1.4699 0.03601 1.3994 1.5405  0.000e+00</span></span>
<span><span class="co">#&gt; factor(dtypes)mother......1   0.7157 0.04399 0.6295 0.8019  1.675e-59</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "plackett"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="pairwise-odds-ratio-model">Pairwise odds ratio model<a class="anchor" aria-label="anchor" href="#pairwise-odds-ratio-model"></a>
</h2>
<p>To fit the pairwise odds-ratio model in the case of a pair-specification there are two options for fitting the model.</p>
<ol style="list-style-type: decimal">
<li>One option is to set up some artificial data similar to twin data with</li>
</ol>
<ul>
<li>a pair-cluster-id (clusters)</li>
<li>with a cluster-id to get GEE type standard errors (se.cluster)</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>We can also use the specify the design via the theta.des that is also a matrix of dimension pairs x design with the design for POR model.</li>
</ol>
<p>Starting by the second option. We need to start by specify the design of the odds-ratio of each pair. We set up the data and find all combinations within the pairs. Subsequently, we remove all the empty groups, by grouping together the factor levels 4:9, and then we construct the design.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tdp</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">dataid</span><span class="op">[</span><span class="va">pair.new</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="op">]</span>,<span class="va">dataid</span><span class="op">[</span><span class="va">pair.new</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tdp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dataid</span><span class="op">)</span>,<span class="st">"1"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dataid</span><span class="op">)</span>,<span class="st">"2"</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tdp</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">tdp</span>,tt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">type1</span>,<span class="va">type2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/drelevel.html">dlevel</a></span><span class="op">(</span><span class="va">tdp</span><span class="op">)</span></span>
<span><span class="co">#&gt; tt #levels=:6 </span></span>
<span><span class="co">#&gt; [1] "child.child"   "father.child"  "mother.child"  "child.father" </span></span>
<span><span class="co">#&gt; [5] "father.father" "mother.father"</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="fu"><a href="../reference/drelevel.html">drelevel</a></span><span class="op">(</span><span class="va">tdp</span>,newlevels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mother.father<span class="op">=</span><span class="fl">4</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span>  <span class="va">obs.types</span><span class="op">~</span><span class="va">tt</span></span>
<span><span class="fu"><a href="../reference/dtable.html">dtable</a></span><span class="op">(</span><span class="va">tdp</span>,<span class="op">~</span><span class="va">tt</span><span class="op">+</span><span class="va">obs.types</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               obs.types mother.father child.child father.child mother.child</span></span>
<span><span class="co">#&gt; tt                                                                         </span></span>
<span><span class="co">#&gt; child.child                         0         509            0            0</span></span>
<span><span class="co">#&gt; father.child                        0           0          986            0</span></span>
<span><span class="co">#&gt; mother.child                        0           0            0         1014</span></span>
<span><span class="co">#&gt; child.father                        0           0            0            0</span></span>
<span><span class="co">#&gt; father.father                       0           0            0            0</span></span>
<span><span class="co">#&gt; mother.father                     491           0            0            0</span></span>
<span><span class="va">tdp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">obs.types</span><span class="op">)</span>,<span class="va">tdp</span><span class="op">)</span></span></code></pre></div>
<p>We then can fit the pairwise model using the pairs and the pair-design for descrbing the OR. The results are consistent with the the ACE model as the mother-father have a lower dependence as is due only the environmental effects. All other combinations should have the same dependence as also seem to be the case.</p>
<p>To fit the OR model it is generally recommended to use the var.link to use the parmetrization with log-odd-ratio regression.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">###porpair &lt;- binomial.twostage(aa,data=dataid,clusters=dataid$cluster,</span></span>
<span><span class="co">###           theta.des=tdp,pairs=pair.new,model="or",var.link=1)</span></span>
<span><span class="co">###summary(porpair)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sessioninfo">SessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.2 (2022-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.1 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] mets_1.3.2     timereg_2.0.4  survival_3.4-0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] Rcpp_1.0.9          bslib_0.4.2         compiler_4.2.2     </span></span>
<span><span class="co">#&gt;  [4] jquerylib_0.1.4     tools_4.2.2         digest_0.6.31      </span></span>
<span><span class="co">#&gt;  [7] jsonlite_1.8.4      evaluate_0.19       memoise_2.0.1      </span></span>
<span><span class="co">#&gt; [10] lifecycle_1.0.3     lattice_0.20-45     rlang_1.0.6        </span></span>
<span><span class="co">#&gt; [13] Matrix_1.5-1        cli_3.6.0           parallel_4.2.2     </span></span>
<span><span class="co">#&gt; [16] yaml_2.3.6          mvtnorm_1.1-3       pkgdown_2.0.7      </span></span>
<span><span class="co">#&gt; [19] xfun_0.36           fastmap_1.1.0       stringr_1.5.0      </span></span>
<span><span class="co">#&gt; [22] knitr_1.41          desc_1.4.2          fs_1.5.2           </span></span>
<span><span class="co">#&gt; [25] vctrs_0.5.1         sass_0.4.4          systemfonts_1.0.4  </span></span>
<span><span class="co">#&gt; [28] globals_0.16.2      rprojroot_2.0.3     grid_4.2.2         </span></span>
<span><span class="co">#&gt; [31] glue_1.6.2          listenv_0.9.0       R6_2.5.1           </span></span>
<span><span class="co">#&gt; [34] textshaping_0.3.6   parallelly_1.34.0   future.apply_1.10.0</span></span>
<span><span class="co">#&gt; [37] rmarkdown_2.19      lava_1.7.1          purrr_1.0.1        </span></span>
<span><span class="co">#&gt; [40] magrittr_2.0.3      codetools_0.2-18    htmltools_0.5.4    </span></span>
<span><span class="co">#&gt; [43] splines_4.2.2       future_1.30.0       numDeriv_2016.8-1.1</span></span>
<span><span class="co">#&gt; [46] ragg_1.2.5          stringi_1.7.12      cachem_1.0.6</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

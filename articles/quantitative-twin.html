<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Twin models • mets</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Twin models">
<meta property="og:description" content="mets">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.8.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kkholst/mets/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="quantitative-twin_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="quantitative-twin_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Twin models</h1>
                        <h4 class="author">Klaus Holst &amp; Thomas Scheike</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/master/vignettes/quantitative-twin.Rmd"><code>vignettes/quantitative-twin.Rmd</code></a></small>
      <div class="hidden name"><code>quantitative-twin.Rmd</code></div>

    </div>

    
    
<p>This document provides a brief tutorial to analyzing twin data using the <strong><code>mets</code></strong> package:</p>
<p><span class="math inline">\(\newcommand{\cov}{\mathbb{C}\text{ov}} \newcommand{\cor}{\mathbb{C}\text{or}} \newcommand{\var}{\mathbb{V}\text{ar}} \newcommand{\E}{\mathbb{E}} \newcommand{\unitfrac}[2]{#1/#2} \newcommand{\n}{}\)</span> ’ The development version may be installed from <em>github</em>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="co"># install.packages("remotes")</span>
<span class="kw">remotes</span>::<span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"kkholst/mets"</span>, dependencies=<span class="st">"Suggests"</span>)
</pre></div>
<div id="twin-analysis-continuous-traits" class="section level1">
<h1 class="hasAnchor">
<a href="#twin-analysis-continuous-traits" class="anchor"></a>Twin analysis, continuous traits</h1>
<p>In the following we examine the heritability of Body Mass Index<sup id="b71edfd9bc946c317f4a732845bcaf93"><a href="#korkeila_bmi_1991" title="Korkeila, Kaprio, Rissanen \&amp; Koskenvuo, {{E}ffects of gender and age on the heritability of body mass index}, {Int J Obes}, v(10), 647--654 (1991).">korkeila_bmi_1991</a></sup><sup id="718839fcb6ade82ebb2d7de853582b80"><a href="#hjelmborg_bmi_2008" title="Hjelmborg, Fagnani, Silventoinen, McGue, Korkeila, Christensen, Rissanen \&amp; Kaprio, {{G}enetic influences on growth traits of {B}{M}{I}: a longitudinal study of adult twins}, {Obesity (Silver Spring)}, v(4), 847--852 (2008).">hjelmborg_bmi_2008</a></sup>, based on data on self-reported BMI-values from a random sample of 11,411 same-sex twins. First, we will load data</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"twinbmi"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">twinbmi</span>)
<span class="co">#&gt;   tvparnr      bmi      age gender zyg id num</span>
<span class="co">#&gt; 1       1 26.33289 57.51212   male  DZ  1   1</span>
<span class="co">#&gt; 2       1 25.46939 57.51212   male  DZ  1   2</span>
<span class="co">#&gt; 3       2 28.65014 56.62696   male  MZ  2   1</span>
<span class="co">#&gt; 5       3 28.40909 57.73097   male  DZ  3   1</span>
<span class="co">#&gt; 7       4 27.25089 53.68683   male  DZ  4   1</span>
<span class="co">#&gt; 8       4 28.07504 53.68683   male  DZ  4   2</span>
</pre></div>
<p>The data is on <em>long</em> format with one subject per row.</p>
<ul>
<li>
<strong><code>tvparnr</code>:</strong> twin id</li>
<li>
<strong><code>bmi</code>:</strong> Body Mass Index (<span class="math inline">\(\mathrm{kg}/{\mathrm{m}^2}\)</span>)</li>
<li>
<strong><code>age</code>:</strong> Age (years)</li>
<li>
<strong><code>gender</code>:</strong> Gender factor (male,female)</li>
<li>
<strong><code>zyg</code>:</strong> zygosity (MZ, DZ)</li>
</ul>
<p>We transpose the data allowing us to do pairwise analyses</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">twinwide</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fast.reshape.html">fast.reshape</a></span>(<span class="kw">twinbmi</span>, id=<span class="st">"tvparnr"</span>,varying=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"bmi"</span>))
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">twinwide</span>)
<span class="co">#&gt;    tvparnr     bmi1      age gender zyg id num     bmi2</span>
<span class="co">#&gt; 1        1 26.33289 57.51212   male  DZ  1   1 25.46939</span>
<span class="co">#&gt; 3        2 28.65014 56.62696   male  MZ  2   1       NA</span>
<span class="co">#&gt; 5        3 28.40909 57.73097   male  DZ  3   1       NA</span>
<span class="co">#&gt; 7        4 27.25089 53.68683   male  DZ  4   1 28.07504</span>
<span class="co">#&gt; 9        5 27.77778 52.55838   male  DZ  5   1       NA</span>
<span class="co">#&gt; 11       6 28.04282 52.52231   male  DZ  6   1 22.30936</span>
</pre></div>
<p>Next we plot the association within each zygosity group</p>
<p>We here show the log-transformed data which is slightly more symmetric and more appropiate for the twin analysis (see Figure @ref(fig:scatter1) and @ref(fig:scatter2))</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">mz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="kw">twinwide</span>, <span class="kw">zyg</span><span class="op">==</span><span class="st">"MZ"</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"bmi1"</span>,<span class="st">"bmi2"</span>)])
<span class="fu">scatterdens</span>(<span class="kw">mz</span>)
</pre></div>
<div class="figure">
<img src="quantitative-twin_files/figure-html/scatter1-1.png" alt="Scatter plot of logarithmic BMI measurements in MZ twins" width="70%"><p class="caption">
Scatter plot of logarithmic BMI measurements in MZ twins
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">dz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="kw">twinwide</span>, <span class="kw">zyg</span><span class="op">==</span><span class="st">"DZ"</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"bmi1"</span>,<span class="st">"bmi2"</span>)])
<span class="fu">scatterdens</span>(<span class="kw">dz</span>)
</pre></div>
<div class="figure">
<img src="quantitative-twin_files/figure-html/scatter2-1.png" alt="Scatter plot of logarithmic BMI measurements in DZ twins" width="70%"><p class="caption">
Scatter plot of logarithmic BMI measurements in DZ twins
</p>
</div>
<p>The plots and raw association measures shows considerable stronger dependence in the MZ twins, thus indicating genetic influence of the trait</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span>(<span class="kw">mz</span>[,<span class="fl">1</span>],<span class="kw">mz</span>[,<span class="fl">2</span>], method=<span class="st">"spearman"</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Spearman's rank correlation rho</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  mz[, 1] and mz[, 2]</span>
<span class="co">#&gt; S = 165457624, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: true rho is not equal to 0</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;       rho </span>
<span class="co">#&gt; 0.6956209</span>
</pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span>(<span class="kw">dz</span>[,<span class="fl">1</span>],<span class="kw">dz</span>[,<span class="fl">2</span>], method=<span class="st">"spearman"</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Spearman's rank correlation rho</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  dz[, 1] and dz[, 2]</span>
<span class="co">#&gt; S = 2162514570, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: true rho is not equal to 0</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;       rho </span>
<span class="co">#&gt; 0.4012686</span>
</pre></div>
<p>Ńext we examine the marginal distribution (GEE model with working independence)</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">l0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">bmi</span> <span class="op">~</span> <span class="kw">gender</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(<span class="kw">age</span><span class="op">-</span><span class="fl">40</span>), data=<span class="kw">twinbmi</span>)
<span class="fu"><a href="https://rdrr.io/pkg/lava/man/estimate.default.html">estimate</a></span>(<span class="kw">l0</span>, id=<span class="kw">twinbmi</span><span class="op">$</span><span class="kw">tvparnr</span>)
<span class="co">#&gt;             Estimate  Std.Err    2.5%   97.5%    P-value</span>
<span class="co">#&gt; (Intercept)  23.3687 0.054534 23.2618 23.4756  0.000e+00</span>
<span class="co">#&gt; gendermale    1.4077 0.073216  1.2642  1.5512  2.230e-82</span>
<span class="co">#&gt; I(age - 40)   0.1177 0.004787  0.1083  0.1271 1.499e-133</span>
</pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"splines"</span>)
<span class="kw">l1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">bmi</span> <span class="op">~</span> <span class="kw">gender</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span>(<span class="kw">age</span>,<span class="fl">3</span>), data=<span class="kw">twinbmi</span>)
<span class="kw">marg1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lava/man/estimate.default.html">estimate</a></span>(<span class="kw">l1</span>, id=<span class="kw">twinbmi</span><span class="op">$</span><span class="kw">tvparnr</span>)
</pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lava/man/Expand.html">Expand</a></span>(<span class="kw">twinbmi</span>,
        bmi=<span class="fl">0</span>,
        gender=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"male"</span>),
        age=<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">33</span>,<span class="fl">61</span>,length.out=<span class="fl">50</span>))
<span class="kw">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lava/man/Expand.html">Expand</a></span>(<span class="kw">twinbmi</span>,
        bmi=<span class="fl">0</span>,
        gender=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"female"</span>),
        age=<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">33</span>,<span class="fl">61</span>,length.out=<span class="fl">50</span>))

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">marg1</span>, <span class="fu">function</span>(<span class="kw">p</span>) <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(<span class="kw">l1</span>,data=<span class="kw">dm</span>)<span class="op">%*%</span><span class="kw">p</span>,
     data=<span class="kw">dm</span>[<span class="st">"age"</span>], ylab=<span class="st">"BMI"</span>, xlab=<span class="st">"Age"</span>,
     ylim=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">22</span>,<span class="fl">26.5</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span>(<span class="kw">marg1</span>, <span class="fu">function</span>(<span class="kw">p</span>) <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(<span class="kw">l1</span>,data=<span class="kw">df</span>)<span class="op">%*%</span><span class="kw">p</span>,
     data=<span class="kw">df</span>[<span class="st">"age"</span>], col=<span class="st">"red"</span>, add=<span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>),
       col=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"black"</span>,<span class="st">"red"</span>), lty=<span class="fl">1</span>, bty=<span class="st">"n"</span>)
</pre></div>
<div class="figure">
<img src="quantitative-twin_files/figure-html/marg1-1.png" alt="Marginal association between BMI and Age for males and females." width="70%"><p class="caption">
Marginal association between BMI and Age for males and females.
</p>
</div>
<div id="polygenic-model" class="section level2">
<h2 class="hasAnchor">
<a href="#polygenic-model" class="anchor"></a>Polygenic model</h2>
<p>We can decompose the trait into the following variance components</p>

<ul>
<li>
<strong><span class="math inline">\(A\)</span>:</strong> Additive genetic effects of alleles</li>
<li>
<strong><span class="math inline">\(D\)</span>:</strong> Dominante genetic effects of alleles</li>
<li>
<strong><span class="math inline">\(C\)</span>:</strong> Shared environmental effects</li>
<li>
<strong><span class="math inline">\(E\)</span>:</strong> Unique environmental genetic effects</li>
</ul>
<p>Dissimilarity of MZ twins arises from unshared environmental effects only, <span class="math inline">\(\cor(E_1,E_2)=0\)</span> and</p>





<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>(<span class="kw">twinbmi</span>)
<span class="kw">l0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/twinlm.html">twinlm</a></span>(<span class="kw">bmi</span> <span class="op">~</span> <span class="kw">age</span><span class="op">+</span><span class="kw">gender</span>, data=<span class="kw">dd</span>,
            DZ=<span class="st">"DZ"</span>, zyg=<span class="st">"zyg"</span>, id=<span class="st">"tvparnr"</span>, type=<span class="st">"sat"</span>)
</pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/twinlm.html">twinlm</a></span>(<span class="kw">bmi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span>(<span class="kw">age</span>,<span class="fl">1</span>)<span class="op">+</span><span class="kw">gender</span>, data=<span class="kw">twinbmi</span>,
           DZ=<span class="st">"DZ"</span>, zyg=<span class="st">"zyg"</span>, id=<span class="st">"tvparnr"</span>, type=<span class="st">"cor"</span>, missing=<span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">l</span>)
<span class="co">#&gt; ____________________________________________________</span>
<span class="co">#&gt; Group 1</span>
<span class="co">#&gt;                         Estimate Std. Error   Z value Pr(&gt;|z|)</span>
<span class="co">#&gt; Regressions:                                                  </span>
<span class="co">#&gt;    bmi.1~ns(age, 1).1    4.16937    0.16669  25.01334   &lt;1e-12</span>
<span class="co">#&gt;    bmi.1~gendermale.1    1.41160    0.07284  19.37839   &lt;1e-12</span>
<span class="co">#&gt; Intercepts:                                                   </span>
<span class="co">#&gt;    bmi.1                22.53618    0.07296 308.87100   &lt;1e-12</span>
<span class="co">#&gt; Additional Parameters:                                        </span>
<span class="co">#&gt;    log(var)              2.44580    0.01425 171.68256   &lt;1e-12</span>
<span class="co">#&gt;    atanh(rhoMZ)          0.78217    0.02290  34.16186   &lt;1e-12</span>
<span class="co">#&gt; ____________________________________________________</span>
<span class="co">#&gt; Group 2</span>
<span class="co">#&gt;                         Estimate Std. Error   Z value Pr(&gt;|z|)</span>
<span class="co">#&gt; Regressions:                                                  </span>
<span class="co">#&gt;    bmi.1~ns(age, 1).1    4.16937    0.16669  25.01334   &lt;1e-12</span>
<span class="co">#&gt;    bmi.1~gendermale.1    1.41160    0.07284  19.37839   &lt;1e-12</span>
<span class="co">#&gt; Intercepts:                                                   </span>
<span class="co">#&gt;    bmi.1                22.53618    0.07296 308.87100   &lt;1e-12</span>
<span class="co">#&gt; Additional Parameters:                                        </span>
<span class="co">#&gt;    log(var)              2.44580    0.01425 171.68256   &lt;1e-12</span>
<span class="co">#&gt;    atanh(rhoDZ)          0.29924    0.01848  16.19580   &lt;1e-12</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                        Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Correlation within MZ: 0.65395  0.62751 0.67889</span>
<span class="co">#&gt; Correlation within DZ: 0.29061  0.25712 0.32341</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 'log Lik.' -29020.12 (df=6)</span>
<span class="co">#&gt; AIC: 58052.24 </span>
<span class="co">#&gt; BIC: 58093.29</span>
</pre></div>
<p>A formal test of genetic effects can be obtained by comparing the MZ and DZ correlation:</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/lava/man/estimate.default.html">estimate</a></span>(<span class="kw">l</span>,<span class="fu"><a href="https://rdrr.io/pkg/lava/man/contr.html">contr</a></span>(<span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">6</span>))
<span class="co">#&gt;                           Estimate Std.Err   2.5%  97.5%   P-value</span>
<span class="co">#&gt; [atanh(rhoMZ)@1] - [a....   0.4829 0.04176 0.4011 0.5648 6.325e-31</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Null Hypothesis: </span>
<span class="co">#&gt;   [atanh(rhoMZ)@1] - [atanh(rhoDZ)@3] = 0</span>
</pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/twinlm.html">twinlm</a></span>(<span class="kw">bmi</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span>(<span class="kw">age</span>,<span class="fl">1</span>)<span class="op">+</span><span class="kw">gender</span>, data=<span class="kw">twinbmi</span>,
           DZ=<span class="st">"DZ"</span>, zyg=<span class="st">"zyg"</span>, id=<span class="st">"tvparnr"</span>, type=<span class="st">"cor"</span>, missing=<span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">l</span>)
<span class="co">#&gt; ____________________________________________________</span>
<span class="co">#&gt; Group 1</span>
<span class="co">#&gt;                         Estimate Std. Error   Z value Pr(&gt;|z|)</span>
<span class="co">#&gt; Regressions:                                                  </span>
<span class="co">#&gt;    bmi.1~ns(age, 1).1    4.16937    0.16669  25.01334   &lt;1e-12</span>
<span class="co">#&gt;    bmi.1~gendermale.1    1.41160    0.07284  19.37839   &lt;1e-12</span>
<span class="co">#&gt; Intercepts:                                                   </span>
<span class="co">#&gt;    bmi.1                22.53618    0.07296 308.87100   &lt;1e-12</span>
<span class="co">#&gt; Additional Parameters:                                        </span>
<span class="co">#&gt;    log(var)              2.44580    0.01425 171.68256   &lt;1e-12</span>
<span class="co">#&gt;    atanh(rhoMZ)          0.78217    0.02290  34.16186   &lt;1e-12</span>
<span class="co">#&gt; ____________________________________________________</span>
<span class="co">#&gt; Group 2</span>
<span class="co">#&gt;                         Estimate Std. Error   Z value Pr(&gt;|z|)</span>
<span class="co">#&gt; Regressions:                                                  </span>
<span class="co">#&gt;    bmi.1~ns(age, 1).1    4.16937    0.16669  25.01334   &lt;1e-12</span>
<span class="co">#&gt;    bmi.1~gendermale.1    1.41160    0.07284  19.37839   &lt;1e-12</span>
<span class="co">#&gt; Intercepts:                                                   </span>
<span class="co">#&gt;    bmi.1                22.53618    0.07296 308.87100   &lt;1e-12</span>
<span class="co">#&gt; Additional Parameters:                                        </span>
<span class="co">#&gt;    log(var)              2.44580    0.01425 171.68256   &lt;1e-12</span>
<span class="co">#&gt;    atanh(rhoDZ)          0.29924    0.01848  16.19580   &lt;1e-12</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                        Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Correlation within MZ: 0.65395  0.62751 0.67889</span>
<span class="co">#&gt; Correlation within DZ: 0.29061  0.25712 0.32341</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 'log Lik.' -29020.12 (df=6)</span>
<span class="co">#&gt; AIC: 58052.24 </span>
<span class="co">#&gt; BIC: 58093.29</span>
</pre></div>
</div>
</div>
<div id="twin-analysis-censored-outcomes" class="section level1">
<h1 class="hasAnchor">
<a href="#twin-analysis-censored-outcomes" class="anchor"></a>Twin analysis, censored outcomes</h1>
</div>
<div id="twin-analysis-binary-traits" class="section level1">
<h1 class="hasAnchor">
<a href="#twin-analysis-binary-traits" class="anchor"></a>Twin analysis, binary traits</h1>
</div>
<div id="time-to-event" class="section level1">
<h1 class="hasAnchor">
<a href="#time-to-event" class="anchor"></a>Time to event</h1>
</div>
<div id="bibliography" class="section level1">
<h1 class="hasAnchor">
<a href="#bibliography" class="anchor"></a>Bibliography</h1>
<p><a id="korkeila_bmi_1991"></a>[korkeila_bmi_1991] Korkeila, Kaprio, Rissanen &amp; Koskenvuo, Effects of gender and age on the heritability of body mass index, <i>Int J Obes</i>, <b>15(10)</b>, 647-654 (1991). <a href="#b71edfd9bc946c317f4a732845bcaf93">↩</a></p>
<p><a id="hjelmborg_bmi_2008"></a>[hjelmborg_bmi_2008] Hjelmborg, Fagnani, Silventoinen, McGue, Korkeila, Christensen, Rissanen &amp; Kaprio, Genetic influences on growth traits of BMI: a longitudinal study of adult twins, <i>Obesity (Silver Spring)</i>, <b>16(4)</b>, 847-852 (2008). <a href="#718839fcb6ade82ebb2d7de853582b80">↩</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A practical guide to Human Genetics with Lifetime Data â€¢ mets</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A practical guide to Human Genetics with Lifetime Data">
<meta property="og:description" content="mets">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic-dutils.html">dUtility data-frame manipulations</a>
    </li>
    <li>
      <a href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a>
    </li>
    <li>
      <a href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a>
    </li>
    <li>
      <a href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a>
    </li>
    <li>
      <a href="../articles/binreg.html">Binomial Regression</a>
    </li>
    <li>
      <a href="../articles/cifreg.html">Cumulative Incidence Regression</a>
    </li>
    <li>
      <a href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a>
    </li>
    <li>
      <a href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a>
    </li>
    <li>
      <a href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a>
    </li>
    <li>
      <a href="../articles/quantitative-twin.html">Twin models</a>
    </li>
    <li>
      <a href="../articles/recurrent-events.html">Recurrent events</a>
    </li>
    <li>
      <a href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a>
    </li>
    <li>
      <a href="../articles/twostage-survival.html">Analysis of multivariate survival data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kkholst/mets/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A practical guide to Human Genetics with Lifetime Data</h1>
                        <h4 class="author">Klaus Holst &amp; Thomas Scheike</h4>
            
            <h4 class="date">2021-09-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/master/vignettes/time-to-event-family-studies-arev.Rmd"><code>vignettes/time-to-event-family-studies-arev.Rmd</code></a></small>
      <div class="hidden name"><code>time-to-event-family-studies-arev.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates how to analyze familial resemblance for twins using the  {}-package and is accompanying the review by Holst and Scheike (2020).</p>
<p>We consider a data-set in that resembles the data of  that were based on the NorTwinCan a collaborative research project studying the genetic and environmental components of prostate cancer. The data comprises around 18,000 DZ twins and 11,000 MZ twins. It was a population based register study based on the Danish, Finnish, Norwegian, and Swedish twin registries.</p>
<p>We first illustrate a hazards based analysis to show how one would study dependence in survival data. This needs to be done under assumptions about independent competing risks when the outcome of interest is observed subject to competing risks (here death).</p>
<p>This seems reasonable here since the occurrence of cancer prior to death only contains weak association with the risk of death for the other twin, and vice-versa.</p>
<p>First looking at the data</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/mets/">mets</a></span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">prt</span><span class="op">)</span>
 
 <span class="fu"><a href="../reference/dtable.html">dtable</a></span><span class="op">(</span><span class="va">prt</span>,<span class="op">~</span><span class="va">status</span><span class="op">+</span><span class="va">cancer</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        cancer     0     1</span>
<span class="co">#&gt; status                   </span>
<span class="co">#&gt; 0             21283     0</span>
<span class="co">#&gt; 1              6997     0</span>
<span class="co">#&gt; 2                 0   942</span>
 <span class="fu"><a href="../reference/dtable.html">dtable</a></span><span class="op">(</span><span class="va">prt</span>,<span class="op">~</span><span class="va">zyg</span><span class="op">+</span><span class="va">country</span>,level<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; zyg</span>
<span class="co">#&gt;    DZ    MZ </span>
<span class="co">#&gt; 17991 11231 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; country</span>
<span class="co">#&gt; Denmark Finland  Norway  Sweden </span>
<span class="co">#&gt;    9671    3926    4107   11518</span></code></pre></div>
<p>we see that there are 21283 censorings and 6997 deaths (prior to cancer) and a total of 942 prostate cancers. Approximately half the data consist of DZ twins. In addition we see that there are around 10000 twins from Denmark and Sweden, and only 4000 from Norway and Finland, respectively.</p>
<div id="survival" class="section level1">
<h1 class="hasAnchor">
<a href="#survival" class="anchor"></a>Survival</h1>
<p>Under assumption of random effects acting independently on different cause specific hazards we can analyse competing risks data considering the cause-specific hazard. Typically, this can be questionable and the cumulative incidence modelling below does not rely on this assumption.</p>
<p>We consider the cause specific hazard of cancer in the competing risks model with death and cancer.</p>
<p>First estimating the marginal hazards for each country.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/mets/">mets</a></span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">prt</span><span class="op">)</span>
 
 <span class="co"># Marginal Cox model here stratified on country without covariates </span>
 <span class="va">margph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>,<span class="va">cancer</span><span class="op">)</span><span class="op">~</span><span class="fu">strata</span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">+</span><span class="fu">cluster</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">margph</span><span class="op">)</span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/survival-marginal-1.png" width="700"></p>
<p>We see that the marginal of Denmark in particular is quite different.</p>
<p>Then we fit a two-stage random effects models with country specific marginals and random-effects variances that differ for MZ and DZ twins.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="co"># Clayton-Oakes, MLE , overall variance</span>
 <span class="va">fitco1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/twostageMLE.html">twostageMLE</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">2.7</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fitco1</span><span class="op">)</span>
<span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span>
<span class="co">#&gt; Variance of Gamma distributed random effects</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                Coef.        SE        z        P-val Kendall tau        SE</span>
<span class="co">#&gt; dependence1 2.782962 0.4225572 6.586001 4.518319e-11   0.5818491 0.0369421</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>
 
 <span class="va">fitco2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">2.7</span>,clusters<span class="op">=</span><span class="va">prt</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fitco2</span><span class="op">)</span>
<span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span>
<span class="co">#&gt; Variance of Gamma distributed random effects</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                Coef.        SE        z        P-val Kendall tau         SE</span>
<span class="co">#&gt; dependence1 2.782962 0.4225529 6.586069 4.516254e-11   0.5818491 0.03694172</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "clayton.oakes"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>

 <span class="co">## now with different random effects for MZ and DZ</span>
 <span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span>,<span class="va">prt</span><span class="op">)</span>
 <span class="va">fitco3</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/twostageMLE.html">twostageMLE</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">1</span>,theta.des<span class="op">=</span><span class="va">mm</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fitco3</span><span class="op">)</span>
<span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span>
<span class="co">#&gt; Variance of Gamma distributed random effects</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                  Coef.        SE        z        P-val Kendall tau         SE</span>
<span class="co">#&gt; factor(zyg)DZ 1.318966 0.3861577 3.415614 6.363831e-04   0.3974027 0.07011148</span>
<span class="co">#&gt; factor(zyg)MZ 5.421921 0.9626267 5.632423 1.776956e-08   0.7305280 0.03495065</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>

 <span class="va">fitco4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">1</span>,clusters<span class="op">=</span><span class="va">prt</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">0</span>,theta.des<span class="op">=</span><span class="va">mm</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fitco4</span><span class="op">)</span>
<span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span>
<span class="co">#&gt; Variance of Gamma distributed random effects</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                  Coef.        SE        z        P-val Kendall tau         SE</span>
<span class="co">#&gt; factor(zyg)DZ 1.318966 0.3861745 3.415466 6.367306e-04   0.3974027 0.07011454</span>
<span class="co">#&gt; factor(zyg)MZ 5.421920 0.9625027 5.633148 1.769493e-08   0.7305280 0.03494615</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "clayton.oakes"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>
 <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://kkholst.github.io/lava/reference/estimate.default.html">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">fitco4</span><span class="op">$</span><span class="va">coef</span>,vcov<span class="op">=</span><span class="va">fitco4</span><span class="op">$</span><span class="va">var.theta</span><span class="op">)</span><span class="op">$</span><span class="va">coefmat</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;               Estimate 2.5% 97.5%</span>
<span class="co">#&gt; factor(zyg)DZ     1.32 0.56  2.08</span>
<span class="co">#&gt; factor(zyg)MZ     5.42 3.54  7.31</span>

 <span class="co">## mz kendalls tau</span>
 <span class="fu"><a href="../reference/npc.html">kendall.ClaytonOakes.twin.ace</a></span><span class="op">(</span><span class="va">fitco4</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="fl">0</span>,K<span class="op">=</span><span class="fl">10000</span><span class="op">)</span><span class="op">$</span><span class="va">mz.kendall</span>
<span class="co">#&gt; [1] 0.7232779</span>
 <span class="co">## dz kendalls tau</span>
 <span class="fu"><a href="../reference/npc.html">kendall.ClaytonOakes.twin.ace</a></span><span class="op">(</span><span class="va">fitco4</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">0</span>,K<span class="op">=</span><span class="fl">10000</span><span class="op">)</span><span class="op">$</span><span class="va">mz.kendall</span>
<span class="co">#&gt; [1] 0.3946366</span></code></pre></div>
<p>The dependence of MZ twins is much stronger, and is summarized by a variance at <span class="math inline">\(5.4\)</span> in contrast to the <span class="math inline">\(DZ\)</span> variance at <span class="math inline">\(1.3\)</span>.</p>
<p>Now we look at the polygenic modelling for survival data, here applied to the cause specific hazards.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
 <span class="co">### setting up design for random effects and parameters of random effects</span>
 <span class="va">desace</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/npc.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">prt</span>,type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span>

 <span class="co">### ace model </span>
 <span class="va">fitace</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">1</span>,
       clusters<span class="op">=</span><span class="va">prt</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">0</span>,model<span class="op">=</span><span class="st">"clayton.oakes"</span>,
       numDeriv<span class="op">=</span><span class="fl">1</span>,random.design<span class="op">=</span><span class="va">desace</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">desace</span><span class="op">$</span><span class="va">pardes</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fitace</span><span class="op">)</span>
<span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span>
<span class="co">#&gt; Variance of Gamma distributed random effects</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                 Coef.       SE         z        P-val Kendall tau          SE</span>
<span class="co">#&gt; dependence1  7.223855 1.841525  3.922757 8.754161e-05   0.7831709  0.04328951</span>
<span class="co">#&gt; dependence2 -1.582396 1.088423 -1.453843 1.459898e-01  -3.7892257 12.48240540</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "clayton.oakes"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $h</span>
<span class="co">#&gt;      Estimate Std.Err    2.5%   97.5%   P-value</span>
<span class="co">#&gt; [1,]   1.2805  0.1698  0.9477 1.61324 4.615e-14</span>
<span class="co">#&gt; [2,]  -0.2805  0.1698 -0.6132 0.05226 9.850e-02</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vare</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vartot</span>
<span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span>
<span class="co">#&gt; p1    5.641  0.9894 3.702 7.581 1.184e-08</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>

 <span class="co">### ace model with positive random effects variances</span>
  <span class="va">fitacee</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">1</span>,
       clusters<span class="op">=</span><span class="va">prt</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">1</span>,model<span class="op">=</span><span class="st">"clayton.oakes"</span>,
       numDeriv<span class="op">=</span><span class="fl">1</span>,random.design<span class="op">=</span><span class="va">desace</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">desace</span><span class="op">$</span><span class="va">pardes</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fitacee</span><span class="op">)</span>
<span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span>
<span class="co">#&gt; Variance of Gamma distributed random effects </span>
<span class="co">#&gt; With log-link</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;              log-Coef.           SE             z P-val  Kendall tau</span>
<span class="co">#&gt; dependence1   1.619814 1.630256e-01  9.935950e+00     0 7.163986e-01</span>
<span class="co">#&gt; dependence2 -41.699466 3.268555e-20 -1.275777e+21     0 3.882594e-19</span>
<span class="co">#&gt;                       SE</span>
<span class="co">#&gt; dependence1 3.312218e-02</span>
<span class="co">#&gt; dependence2 1.269047e-38</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "clayton.oakes"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $h</span>
<span class="co">#&gt;       Estimate   Std.Err      2.5%     97.5%   P-value</span>
<span class="co">#&gt; [1,] 1.000e+00 0.000e+00 1.000e+00 1.000e+00 0.000e+00</span>
<span class="co">#&gt; [2,] 1.537e-19 2.506e-20 1.046e-19 2.028e-19 8.569e-10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vare</span>
<span class="co">#&gt;       Estimate   Std.Err      2.5%     97.5%   P-value</span>
<span class="co">#&gt; [1,] 5.052e+00 8.236e-01 3.438e+00 6.666e+00 8.569e-10</span>
<span class="co">#&gt; [2,] 7.765e-19 2.538e-38 7.765e-19 7.765e-19 0.000e+00</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vartot</span>
<span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span>
<span class="co">#&gt; p1    5.052  0.8236 3.438 6.666 8.569e-10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>
 
 <span class="co">### ae model </span>
 <span class="va">desae</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/npc.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">prt</span>,type<span class="op">=</span><span class="st">"ae"</span><span class="op">)</span>
 <span class="va">fitae</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">1</span>,
       clusters<span class="op">=</span><span class="va">prt</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">0</span>,model<span class="op">=</span><span class="st">"clayton.oakes"</span>,
       numDeriv<span class="op">=</span><span class="fl">1</span>,random.design<span class="op">=</span><span class="va">desae</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">desae</span><span class="op">$</span><span class="va">pardes</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fitae</span><span class="op">)</span>
<span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span>
<span class="co">#&gt; Variance of Gamma distributed random effects</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;               Coef.        SE        z        P-val Kendall tau         SE</span>
<span class="co">#&gt; dependence1 5.05215 0.8236912 6.133549 8.594003e-10   0.7163986 0.03312465</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "clayton.oakes"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $h</span>
<span class="co">#&gt;      Estimate Std.Err 2.5% 97.5% P-value</span>
<span class="co">#&gt; [1,]        1       0    1     1       0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vare</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vartot</span>
<span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span>
<span class="co">#&gt; p1    5.052  0.8237 3.438 6.667 8.594e-10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span>

 <span class="co">### de model </span>
 <span class="va">desde</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/npc.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">prt</span>,type<span class="op">=</span><span class="st">"de"</span><span class="op">)</span>
 <span class="va">fitde</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">1</span>,
       clusters<span class="op">=</span><span class="va">prt</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">0</span>,model<span class="op">=</span><span class="st">"clayton.oakes"</span>,
       numDeriv<span class="op">=</span><span class="fl">1</span>,random.design<span class="op">=</span><span class="va">desde</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">desde</span><span class="op">$</span><span class="va">pardes</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fitde</span><span class="op">)</span>
<span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span>
<span class="co">#&gt; Variance of Gamma distributed random effects</span>
<span class="co">#&gt; $estimates</span>
<span class="co">#&gt;                Coef.        SE        z        P-val Kendall tau         SE</span>
<span class="co">#&gt; dependence1 5.940643 0.9837336 6.038873 1.551941e-09   0.7481312 0.03120299</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $type</span>
<span class="co">#&gt; [1] "clayton.oakes"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $h</span>
<span class="co">#&gt;      Estimate Std.Err 2.5% 97.5% P-value</span>
<span class="co">#&gt; [1,]        1       0    1     1       0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vare</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $vartot</span>
<span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span>
<span class="co">#&gt; p1    5.941  0.9837 4.013 7.869 1.552e-09</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "summary.mets.twostage"</span></code></pre></div>
<p>The DE model fits quite well. In summary all shared variance is due to genes and there is no suggestion of a shared environmental effect.</p>
</div>
<div id="concordance-and-casewise" class="section level1">
<h1 class="hasAnchor">
<a href="#concordance-and-casewise" class="anchor"></a>Concordance and Casewise</h1>
<p>First we estimate the concordance of joint prostate cancer. The two-twins are censored at the same time, otherwise we would enforce this in the data by artificially censor both twins at the first censoring time. Given, however, that we have the same-censoring assumption satisfied we can do the stanadar Aalen-Johansen product-limit estimator of the concordance probabilities for MZ and DZ twins.</p>
<p>For simplicity we do not do this for each country even though as we show there are big differences between the countries.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
 <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/mets/">mets</a></span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">prt</span><span class="op">)</span>
 <span class="va">prt</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/npc.html">force.same.cens</a></span><span class="op">(</span><span class="va">prt</span>,cause<span class="op">=</span><span class="st">"status"</span><span class="op">)</span>

 <span class="fu"><a href="../reference/dtable.html">dtable</a></span><span class="op">(</span><span class="va">prt</span>,<span class="op">~</span><span class="va">status</span><span class="op">+</span><span class="va">cancer</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        cancer     0     1</span>
<span class="co">#&gt; status                   </span>
<span class="co">#&gt; 0             21580    77</span>
<span class="co">#&gt; 1              6700     0</span>
<span class="co">#&gt; 2                 0   865</span>
 <span class="fu"><a href="../reference/dtable.html">dtable</a></span><span class="op">(</span><span class="va">prt</span>,<span class="op">~</span><span class="va">status</span><span class="op">+</span><span class="va">country</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        country Denmark Finland Norway Sweden</span>
<span class="co">#&gt; status                                      </span>
<span class="co">#&gt; 0                 7394    2622   3154   8487</span>
<span class="co">#&gt; 1                 2140    1138    830   2592</span>
<span class="co">#&gt; 2                  137     166    123    439</span>
 <span class="fu"><a href="../reference/dtable.html">dtable</a></span><span class="op">(</span><span class="va">prt</span>,<span class="op">~</span><span class="va">zyg</span><span class="op">+</span><span class="va">country</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     country Denmark Finland Norway Sweden</span>
<span class="co">#&gt; zyg                                      </span>
<span class="co">#&gt; DZ             6191    2833   2393   6574</span>
<span class="co">#&gt; MZ             3480    1093   1714   4944</span>

 <span class="co">## cumulative incidence with cluster standard errors.</span>
 <span class="va">cif1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cif.html">cif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu">strata</span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">+</span><span class="fu">cluster</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,<span class="va">prt</span>,cause<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cif1</span>,se<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/concordance-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
 <span class="va">cifa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cif.html">cif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fl">1</span>,<span class="va">prt</span>,cause<span class="op">=</span><span class="fl">2</span><span class="op">)</span>

 <span class="co">### concordance estimator, ignoring country differences. </span>
 <span class="va">p11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicomprisk.html">bicomprisk</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu">strata</span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Strata 'DZ'</span>
<span class="co">#&gt; Strata 'MZ'</span>

 <span class="va">p11mz</span> <span class="op">&lt;-</span> <span class="va">p11</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="st">"MZ"</span>
 <span class="va">p11dz</span> <span class="op">&lt;-</span> <span class="va">p11</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="st">"DZ"</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
 <span class="co">## Concordance</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p11mz</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>;
 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p11dz</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>;</code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/concordance-2.png" width="700"></p>
<p>Now we compare the concordance to the marginals to get a measure that takes the marginals into account when evaluating the strength of the association.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">prodlim</span><span class="op">)</span>
 <span class="va">outm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/prodlim.html">prodlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">prt</span><span class="op">)</span>

 <span class="va">cifzyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cif.html">cif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fu">strata</span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">cluster</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
 <span class="va">cifprt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cif.html">cif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="fu">cluster</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
     
 <span class="va">times</span> <span class="op">&lt;-</span> <span class="fl">70</span><span class="op">:</span><span class="fl">100</span>
 <span class="va">cifmz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">outm</span>,cause<span class="op">=</span><span class="fl">2</span>,time<span class="op">=</span><span class="va">times</span>,newdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>zyg<span class="op">=</span><span class="st">"MZ"</span><span class="op">)</span><span class="op">)</span> <span class="co">## cause is 2 (second cause) </span>
 <span class="va">cifdz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">outm</span>,cause<span class="op">=</span><span class="fl">2</span>,time<span class="op">=</span><span class="va">times</span>,newdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>zyg<span class="op">=</span><span class="st">"DZ"</span><span class="op">)</span><span class="op">)</span>
    
 <span class="co">### concordance for MZ and DZ twins&lt;</span>
 <span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicomprisk.html">bicomprisk</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu">strata</span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,prodlim<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Strata 'DZ'</span>
<span class="co">#&gt; Strata 'MZ'</span>
 <span class="va">ccdz</span> <span class="op">&lt;-</span> <span class="va">cc</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="st">"DZ"</span>
 <span class="va">ccmz</span> <span class="op">&lt;-</span> <span class="va">cc</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="st">"MZ"</span>
     
 <span class="va">cdz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/casewise.html">casewise</a></span><span class="op">(</span><span class="va">ccdz</span>,<span class="va">outm</span>,cause.marg<span class="op">=</span><span class="fl">2</span><span class="op">)</span> 
 <span class="va">cmz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/casewise.html">casewise</a></span><span class="op">(</span><span class="va">ccmz</span>,<span class="va">outm</span>,cause.marg<span class="op">=</span><span class="fl">2</span><span class="op">)</span>

 <span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicomprisk.html">bicompriskData</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="fu">strata</span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
 <span class="va">conczyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cif.html">cif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu">strata</span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">cluster</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">dd</span>,cause<span class="op">=</span><span class="fl">1</span><span class="op">)</span>

 <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">conczyg</span>,se<span class="op">=</span><span class="cn">TRUE</span>,col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>, legend<span class="op">=</span><span class="cn">FALSE</span>,xlab<span class="op">=</span><span class="st">"Age"</span>,ylab<span class="op">=</span><span class="st">"Concordance"</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"concordance-MZ"</span>,<span class="st">"concordance-DZ"</span><span class="op">)</span>,col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>

 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cmz</span>,ci<span class="op">=</span><span class="cn">NULL</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.8</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">70</span>,<span class="fl">97</span><span class="op">)</span>,legend<span class="op">=</span><span class="cn">FALSE</span>,col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,
      ylab<span class="op">=</span><span class="st">"Casewise"</span>,xlab<span class="op">=</span><span class="st">"Age"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cdz</span>,ci<span class="op">=</span><span class="cn">NULL</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.8</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">70</span>,<span class="fl">97</span><span class="op">)</span>,legend<span class="op">=</span><span class="cn">FALSE</span>,ylab<span class="op">=</span><span class="st">"Casewise"</span>,xlab<span class="op">=</span><span class="st">"Age"</span>,
      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">cmz</span><span class="op">$</span><span class="va">casewise</span><span class="op">)</span>,<span class="fu"><a href="../reference/basehazplot.phreg.html">plotConfRegionSE</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">casewise.conc</span>,<span class="va">se.casewise</span>,col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">cdz</span><span class="op">$</span><span class="va">casewise</span><span class="op">)</span>,<span class="fu"><a href="../reference/basehazplot.phreg.html">plotConfRegionSE</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">casewise.conc</span>,<span class="va">se.casewise</span>,col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"casewise-MZ"</span>,<span class="st">"casewise-DZ"</span>,<span class="st">"marginal"</span><span class="op">)</span>,col<span class="op">=</span><span class="va">cols</span>, lty<span class="op">=</span><span class="va">ltys</span>, bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/concordance2-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">cdz</span><span class="op">)</span>
<span class="co">#&gt; Casewise concordance and standard errors </span>
<span class="co">#&gt;        time casewise conc se casewise</span>
<span class="co">#&gt;  [1,]  59.5        0.0866      0.0865</span>
<span class="co">#&gt;  [2,]  60.5        0.0659      0.0659</span>
<span class="co">#&gt;  [3,]  61.6        0.0593      0.0593</span>
<span class="co">#&gt;  [4,]  62.7        0.0483      0.0483</span>
<span class="co">#&gt;  [5,]  63.7        0.0358      0.0358</span>
<span class="co">#&gt;  [6,]  64.8        0.0279      0.0279</span>
<span class="co">#&gt;  [7,]  65.8        0.0223      0.0223</span>
<span class="co">#&gt;  [8,]  66.9        0.0197      0.0197</span>
<span class="co">#&gt;  [9,]  68.0        0.0415      0.0297</span>
<span class="co">#&gt; [10,]  69.0        0.0335      0.0240</span>
<span class="co">#&gt; [11,]  70.1        0.0452      0.0264</span>
<span class="co">#&gt; [12,]  71.1        0.0855      0.0352</span>
<span class="co">#&gt; [13,]  72.2        0.0728      0.0300</span>
<span class="co">#&gt; [14,]  73.2        0.0888      0.0317</span>
<span class="co">#&gt; [15,]  74.3        0.1010      0.0321</span>
<span class="co">#&gt; [16,]  75.4        0.1020      0.0310</span>
<span class="co">#&gt; [17,]  76.4        0.1130      0.0318</span>
<span class="co">#&gt; [18,]  77.5        0.1230      0.0320</span>
<span class="co">#&gt; [19,]  78.5        0.1400      0.0334</span>
<span class="co">#&gt; [20,]  79.6        0.1470      0.0332</span>
<span class="co">#&gt; [21,]  80.7        0.1530      0.0329</span>
<span class="co">#&gt; [22,]  81.7        0.1460      0.0307</span>
<span class="co">#&gt; [23,]  82.8        0.1470      0.0298</span>
<span class="co">#&gt; [24,]  83.8        0.1600      0.0307</span>
<span class="co">#&gt; [25,]  84.9        0.1470      0.0282</span>
<span class="co">#&gt; [26,]  86.0        0.1620      0.0297</span>
<span class="co">#&gt; [27,]  87.0        0.1680      0.0300</span>
<span class="co">#&gt; [28,]  88.1        0.1820      0.0311</span>
<span class="co">#&gt; [29,]  89.1        0.1760      0.0301</span>
<span class="co">#&gt; [30,]  90.2        0.1950      0.0323</span>
<span class="co">#&gt; [31,]  91.2        0.2040      0.0332</span>
<span class="co">#&gt; [32,]  92.3        0.1970      0.0321</span>
<span class="co">#&gt; [33,]  93.4        0.1940      0.0315</span>
<span class="co">#&gt; [34,]  94.4        0.1970      0.0318</span>
<span class="co">#&gt; [35,]  95.5        0.1940      0.0314</span>
<span class="co">#&gt; [36,]  96.5        0.1930      0.0312</span>
<span class="co">#&gt; [37,]  97.6        0.2040      0.0330</span>
<span class="co">#&gt; [38,]  98.7        0.2010      0.0325</span>
<span class="co">#&gt; [39,]  99.7        0.1990      0.0322</span>
<span class="co">#&gt; [40,] 101.0        0.1980      0.0321</span>
<span class="co">#&gt; [41,] 102.0        0.1950      0.0316</span>
<span class="co">#&gt; [42,] 103.0        0.1940      0.0314</span>
<span class="co">#&gt; [43,] 104.0        0.1940      0.0314</span>
<span class="co">#&gt; [44,] 105.0        0.1930      0.0312</span>
<span class="co">#&gt; [45,] 106.0        0.1920      0.0311</span>
<span class="co">#&gt; [46,] 107.0        0.1920      0.0311</span>
<span class="co">#&gt; [47,] 108.0        0.1910      0.0309</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">cmz</span><span class="op">)</span>
<span class="co">#&gt; Casewise concordance and standard errors </span>
<span class="co">#&gt;        time casewise conc se casewise</span>
<span class="co">#&gt;  [1,]  60.6         0.519      0.2590</span>
<span class="co">#&gt;  [2,]  61.6         0.466      0.2330</span>
<span class="co">#&gt;  [3,]  62.7         0.380      0.1900</span>
<span class="co">#&gt;  [4,]  63.7         0.285      0.1420</span>
<span class="co">#&gt;  [5,]  64.8         0.286      0.1280</span>
<span class="co">#&gt;  [6,]  65.8         0.228      0.1020</span>
<span class="co">#&gt;  [7,]  66.9         0.295      0.1120</span>
<span class="co">#&gt;  [8,]  67.9         0.306      0.1090</span>
<span class="co">#&gt;  [9,]  68.9         0.327      0.1040</span>
<span class="co">#&gt; [10,]  70.0         0.338      0.0981</span>
<span class="co">#&gt; [11,]  71.0         0.345      0.0926</span>
<span class="co">#&gt; [12,]  72.1         0.399      0.0946</span>
<span class="co">#&gt; [13,]  73.1         0.414      0.0909</span>
<span class="co">#&gt; [14,]  74.2         0.426      0.0874</span>
<span class="co">#&gt; [15,]  75.2         0.388      0.0798</span>
<span class="co">#&gt; [16,]  76.3         0.391      0.0773</span>
<span class="co">#&gt; [17,]  77.3         0.410      0.0769</span>
<span class="co">#&gt; [18,]  78.4         0.392      0.0723</span>
<span class="co">#&gt; [19,]  79.4         0.410      0.0721</span>
<span class="co">#&gt; [20,]  80.5         0.423      0.0714</span>
<span class="co">#&gt; [21,]  81.5         0.400      0.0666</span>
<span class="co">#&gt; [22,]  82.6         0.442      0.0685</span>
<span class="co">#&gt; [23,]  83.6         0.446      0.0676</span>
<span class="co">#&gt; [24,]  84.7         0.433      0.0643</span>
<span class="co">#&gt; [25,]  85.7         0.413      0.0612</span>
<span class="co">#&gt; [26,]  86.8         0.389      0.0578</span>
<span class="co">#&gt; [27,]  87.8         0.396      0.0578</span>
<span class="co">#&gt; [28,]  88.9         0.396      0.0573</span>
<span class="co">#&gt; [29,]  89.9         0.399      0.0574</span>
<span class="co">#&gt; [30,]  91.0         0.386      0.0556</span>
<span class="co">#&gt; [31,]  92.0         0.400      0.0570</span>
<span class="co">#&gt; [32,]  93.1         0.393      0.0560</span>
<span class="co">#&gt; [33,]  94.1         0.415      0.0590</span>
<span class="co">#&gt; [34,]  95.2         0.477      0.0669</span>
<span class="co">#&gt; [35,]  96.2         0.493      0.0690</span>
<span class="co">#&gt; [36,]  97.3         0.511      0.0714</span>
<span class="co">#&gt; [37,]  98.3         0.507      0.0708</span>
<span class="co">#&gt; [38,]  99.4         0.500      0.0699</span>
<span class="co">#&gt; [39,] 100.0         0.525      0.0739</span>
<span class="co">#&gt; [40,] 101.0         0.520      0.0731</span>
<span class="co">#&gt; [41,] 103.0         0.514      0.0723</span>
<span class="co">#&gt; [42,] 104.0         0.541      0.0767</span>
<span class="co">#&gt; [43,] 105.0         0.541      0.0767</span>

 <span class="fu"><a href="https://rdrr.io/pkg/timereg/man/internal-addreg.html">Cpred</a></span><span class="op">(</span><span class="va">cmz</span><span class="op">$</span><span class="va">casewise</span>,<span class="fl">80</span><span class="op">)</span>
<span class="co">#&gt;      xval casewise conc se casewise</span>
<span class="co">#&gt; [1,]   80     0.4096715  0.07211013</span>
 <span class="fu"><a href="https://rdrr.io/pkg/timereg/man/internal-addreg.html">Cpred</a></span><span class="op">(</span><span class="va">cdz</span><span class="op">$</span><span class="va">casewise</span>,<span class="fl">80</span><span class="op">)</span>
<span class="co">#&gt;      xval casewise conc se casewise</span>
<span class="co">#&gt; [1,]   80     0.1469487  0.03321234</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
 <span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicomprisk.html">bicompriskData</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="fu">strata</span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
 <span class="va">conczyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cif.html">cif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu">strata</span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">cluster</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">dd</span>,cause<span class="op">=</span><span class="fl">1</span><span class="op">)</span>

 <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">conczyg</span>,se<span class="op">=</span><span class="cn">TRUE</span>,legend<span class="op">=</span><span class="cn">FALSE</span>,xlab<span class="op">=</span><span class="st">"Age"</span>,ylab<span class="op">=</span><span class="st">"Concordance"</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"concordance-DZ"</span>,<span class="st">"concordance-MZ"</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cmz</span>,ci<span class="op">=</span><span class="cn">NULL</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">70</span>,<span class="fl">100</span><span class="op">)</span>,legend<span class="op">=</span><span class="cn">FALSE</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>,ylab<span class="op">=</span><span class="st">"Casewise"</span>,xlab<span class="op">=</span><span class="st">"Age"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cdz</span>,ci<span class="op">=</span><span class="cn">NULL</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">70</span>,<span class="fl">100</span><span class="op">)</span>,legend<span class="op">=</span><span class="cn">FALSE</span>,ylab<span class="op">=</span><span class="st">"Casewise"</span>,xlab<span class="op">=</span><span class="st">"Age"</span>,
      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"casewise-MZ"</span>,<span class="st">"casewise-DZ"</span>,<span class="st">"marginal"</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">cmz</span><span class="op">$</span><span class="va">casewise</span><span class="op">)</span>,<span class="fu"><a href="../reference/basehazplot.phreg.html">plotConfRegionSE</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">casewise.conc</span>,<span class="va">se.casewise</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">cdz</span><span class="op">$</span><span class="va">casewise</span><span class="op">)</span>,<span class="fu"><a href="../reference/basehazplot.phreg.html">plotConfRegionSE</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">casewise.conc</span>,<span class="va">se.casewise</span>,col<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/concordance3-1.png" width="700"></p>
<p>The standard errors above are slightly off since they only reflect the uncertainty from the concordance estimation. This can be improved by doing specific calculations for a specific time-point uisng the binomial regression function that gives and iid decomposition for the paramters. We thus apply the binomial regression to estimate the concordance as well as the marginal, and combine the iid decompositions when estimating the standard error. We also do this ignoring country differences.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="co">### new version of Casewise for specific time-point based on binreg </span>
 <span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicomprisk.html">bicompriskData</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="fu">strata</span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
 <span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>zyg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DZ"</span>,<span class="st">"MZ"</span><span class="op">)</span>,id<span class="op">=</span><span class="fl">1</span><span class="op">)</span>

 <span class="co">## concordance </span>
 <span class="va">bcif1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binreg.html">binreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">cluster</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,<span class="va">dd</span>,time<span class="op">=</span><span class="fl">80</span>,cause<span class="op">=</span><span class="fl">1</span>,cens.model<span class="op">=</span><span class="op">~</span><span class="fu">strata</span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">)</span>
 <span class="va">pconc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bcif1</span>,<span class="va">newdata</span><span class="op">)</span>

 <span class="co">## marginal estimates</span>
 <span class="va">mbcif1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binreg.html">binreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu">cluster</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,<span class="va">prt</span>,time<span class="op">=</span><span class="fl">80</span>,cause<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
 <span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mbcif1</span>,<span class="va">newdata</span><span class="op">)</span>

 <span class="co">### casewise with improved se's from log-scale </span>
 <span class="va">cse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binregCasewise.html">binregCasewise</a></span><span class="op">(</span><span class="va">bcif1</span>,<span class="va">mbcif1</span><span class="op">)</span>
 <span class="va">cse</span>
<span class="co">#&gt; $coef</span>
<span class="co">#&gt;     Estimate      2.5%     97.5%</span>
<span class="co">#&gt; p1 0.1586277 0.1029195 0.2444898</span>
<span class="co">#&gt; p2 0.4041311 0.2843829 0.5743030</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $logcoef</span>
<span class="co">#&gt;    Estimate Std.Err   2.5%   97.5%   P-value</span>
<span class="co">#&gt; p1   -1.841  0.2207 -2.274 -1.4086 7.331e-17</span>
<span class="co">#&gt; p2   -0.906  0.1793 -1.257 -0.5546 4.346e-07</span></code></pre></div>
<p>It can be useful also to simply model the concordance given covariates, and in this case we might find it important to adjust for country, or to see if the differences between MZ and DZ are comparable across contries even though clearly DK has a much lower cumulative incidence of prostate cancer.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="co">### semi-parametric modelling of concordance </span>
 <span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicomprisk.html">bicompriskData</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="fu">strata</span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
 <span class="va">regconc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cifreg.html">cifreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">*</span><span class="va">zyg</span>,data<span class="op">=</span><span class="va">dd</span>,prop<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>
 <span class="va">regconc</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; cifreg(formula = Event(time, status) ~ country * zyg, data = dd, </span>
<span class="co">#&gt;     propodds = NULL)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      n events</span>
<span class="co">#&gt;  14222    106</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  14222 clusters</span>
<span class="co">#&gt; coeffients:</span>
<span class="co">#&gt;                      Estimate     S.E.  dU^-1/2 P-value</span>
<span class="co">#&gt; countryFinland        2.20738  0.76281  0.76379  0.0038</span>
<span class="co">#&gt; countryNorway         2.31658  0.78992  0.79059  0.0034</span>
<span class="co">#&gt; countrySweden         2.02237  0.73973  0.74002  0.0063</span>
<span class="co">#&gt; zygMZ                 2.30872  0.77397  0.77460  0.0029</span>
<span class="co">#&gt; countryFinland:zygMZ -1.26737  0.87061  0.87193  0.1455</span>
<span class="co">#&gt; countryNorway:zygMZ  -2.14613  0.94349  0.94430  0.0229</span>
<span class="co">#&gt; countrySweden:zygMZ  -1.32560  0.82195  0.82282  0.1068</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; exp(coeffients):</span>
<span class="co">#&gt;                       Estimate      2.5%   97.5%</span>
<span class="co">#&gt; countryFinland        9.091833  2.038674 40.5467</span>
<span class="co">#&gt; countryNorway        10.140896  2.156230 47.6933</span>
<span class="co">#&gt; countrySweden         7.556217  1.772747 32.2079</span>
<span class="co">#&gt; zygMZ                10.061559  2.207303 45.8637</span>
<span class="co">#&gt; countryFinland:zygMZ  0.281571  0.051112  1.5511</span>
<span class="co">#&gt; countryNorway:zygMZ   0.116936  0.018401  0.7431</span>
<span class="co">#&gt; countrySweden:zygMZ   0.265643  0.053046  1.3303</span>
 <span class="co">### interaction test</span>
 <span class="fu"><a href="https://rdrr.io/pkg/timereg/man/wald.test.html">wald.test</a></span><span class="op">(</span><span class="va">regconc</span>,coef.null<span class="op">=</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>
<span class="co">#&gt;       lin.comb        se     lower      upper       pval</span>
<span class="co">#&gt; [1,] -1.267372 0.8706072 -2.973731  0.4389867 0.14546630</span>
<span class="co">#&gt; [2,] -2.146126 0.9434944 -3.995341 -0.2969109 0.02292653</span>
<span class="co">#&gt; [3,] -1.325604 0.8219473 -2.936591  0.2853834 0.10679668</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Wald test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  </span>
<span class="co">#&gt; chisq = 5.2661, df = 3, p-value = 0.1533</span>

 <span class="va">regconc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cifreg.html">cifreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="va">zyg</span>,data<span class="op">=</span><span class="va">dd</span>,prop<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>
 <span class="va">regconc</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; cifreg(formula = Event(time, status) ~ country + zyg, data = dd, </span>
<span class="co">#&gt;     propodds = NULL)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      n events</span>
<span class="co">#&gt;  14222    106</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  14222 clusters</span>
<span class="co">#&gt; coeffients:</span>
<span class="co">#&gt;                Estimate    S.E. dU^-1/2 P-value</span>
<span class="co">#&gt; countryFinland  1.29246 0.34863 0.35151  0.0002</span>
<span class="co">#&gt; countryNorway   0.93336 0.39545 0.39366  0.0183</span>
<span class="co">#&gt; countrySweden   1.07439 0.31940 0.31876  0.0008</span>
<span class="co">#&gt; zygMZ           1.01055 0.19995 0.19877  0.0000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; exp(coeffients):</span>
<span class="co">#&gt;                Estimate   2.5%  97.5%</span>
<span class="co">#&gt; countryFinland   3.6417 1.8389 7.2121</span>
<span class="co">#&gt; countryNorway    2.5430 1.1715 5.5203</span>
<span class="co">#&gt; countrySweden    2.9282 1.5658 5.4762</span>
<span class="co">#&gt; zygMZ            2.7471 1.8564 4.0651</span>

 <span class="co">## logistic link </span>
 <span class="va">logitregconc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cifreg.html">cifreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="va">zyg</span>,data<span class="op">=</span><span class="va">dd</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">logitregconc</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      n events</span>
<span class="co">#&gt;  14222    106</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  14222 clusters</span>
<span class="co">#&gt; coeffients:</span>
<span class="co">#&gt;                Estimate    S.E. dU^-1/2 P-value</span>
<span class="co">#&gt; countryFinland  1.30427 0.35262 0.35146  0.0002</span>
<span class="co">#&gt; countryNorway   0.94077 0.39999 0.39365  0.0187</span>
<span class="co">#&gt; countrySweden   1.08494 0.32247 0.31871  0.0008</span>
<span class="co">#&gt; zygMZ           1.02335 0.20283 0.19873  0.0000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; exp(coeffients):</span>
<span class="co">#&gt;                Estimate   2.5%  97.5%</span>
<span class="co">#&gt; countryFinland   3.6850 1.8462 7.3552</span>
<span class="co">#&gt; countryNorway    2.5620 1.1698 5.6111</span>
<span class="co">#&gt; countrySweden    2.9593 1.5729 5.5676</span>
<span class="co">#&gt; zygMZ            2.7825 1.8697 4.1408</span>

<span class="co">### library(Publish)</span>
<span class="co">### publish(round(summary(logitregconc)$exp.coef[,-c(2,5)],2),latex=TRUE,digits=2)</span></code></pre></div>
</div>
<div id="competing-risk-using-additive-gamma" class="section level1">
<h1 class="hasAnchor">
<a href="#competing-risk-using-additive-gamma" class="anchor"></a>Competing risk using additive Gamma</h1>
<p>Here we do the cumulative incidence random effects modelling</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">90</span>,by<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
  <span class="va">cif1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/timereg/man/comp.risk.html">comp.risk</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">+</span><span class="fu">cluster</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,<span class="va">prt</span>,
           cause<span class="op">=</span><span class="fl">2</span>,times<span class="op">=</span><span class="va">times</span>,max.clust<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>

  <span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span>,<span class="va">prt</span><span class="op">)</span>
  <span class="va">out1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/random.cif.html">random.cif</a></span><span class="op">(</span><span class="va">cif1</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">2</span>,cause2<span class="op">=</span><span class="fl">2</span>,theta<span class="op">=</span><span class="fl">1</span>,
          theta.des<span class="op">=</span><span class="va">mm</span>,same.cens<span class="op">=</span><span class="cn">TRUE</span>,step<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">out1</span><span class="op">)</span>
<span class="co">#&gt; Random effect variance for variation due to clusters</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cause 2 and cause 2</span>
<span class="co">#&gt;                  Coef.        SE        z        P-val Cross odds ratio</span>
<span class="co">#&gt; factor(zyg)DZ 1.034939 0.4379824 2.362969 0.0181292052         2.034939</span>
<span class="co">#&gt; factor(zyg)MZ 3.877446 1.1338630 3.419678 0.0006269539         4.877446</span>
<span class="co">#&gt;                      SE</span>
<span class="co">#&gt; factor(zyg)DZ 0.4379824</span>
<span class="co">#&gt; factor(zyg)MZ 1.1338630</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://kkholst.github.io/lava/reference/estimate.default.html">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">out1</span><span class="op">$</span><span class="va">theta</span>,vcov<span class="op">=</span><span class="va">out1</span><span class="op">$</span><span class="va">var.theta</span><span class="op">)</span><span class="op">$</span><span class="va">coefmat</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;    Estimate 2.5% 97.5%</span>
<span class="co">#&gt; p1     1.03 0.18  1.89</span>
<span class="co">#&gt; p2     3.88 1.66  6.10</span>

  <span class="va">desace</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/npc.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">prt</span>,type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span>
 
  <span class="va">outacem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Grandom.cif.html">Grandom.cif</a></span><span class="op">(</span><span class="va">cif1</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">2</span>,cause2<span class="op">=</span><span class="fl">2</span>,
     same.cens<span class="op">=</span><span class="cn">TRUE</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">0.15</span><span class="op">)</span>,var.link<span class="op">=</span><span class="fl">0</span>,
         step<span class="op">=</span><span class="fl">0.5</span>,theta.des<span class="op">=</span><span class="va">desace</span><span class="op">$</span><span class="va">pardes</span>,random.design<span class="op">=</span><span class="va">desace</span><span class="op">$</span><span class="va">des.rv</span><span class="op">)</span>
  <span class="va">outacem</span><span class="op">$</span><span class="va">score</span>
<span class="co">#&gt;              [,1]</span>
<span class="co">#&gt; [1,] 4.494686e-07</span>
<span class="co">#&gt; [2,] 2.722077e-08</span>
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">outacem</span><span class="op">)</span>
<span class="co">#&gt; Random effect parameters for additive gamma random effects </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cause 2 and cause 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        Coef.     SE     z    P-val</span>
<span class="co">#&gt; [1,]  0.3360 0.0905  3.71 0.000206</span>
<span class="co">#&gt; [2,] -0.0798 0.0673 -1.19 0.236000</span>
<span class="co">#&gt; $estimate</span>
<span class="co">#&gt;        Coef.     SE     z    P-val</span>
<span class="co">#&gt; [1,]  0.3360 0.0905  3.71 0.000206</span>
<span class="co">#&gt; [2,] -0.0798 0.0673 -1.19 0.236000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $h</span>
<span class="co">#&gt;    Estimate Std.Err    2.5%  97.5%   P-value</span>
<span class="co">#&gt; p1   1.3118  0.2941  0.7354 1.8881 8.157e-06</span>
<span class="co">#&gt; p2  -0.3118  0.2941 -0.8881 0.2646 2.890e-01</span>

 <span class="co">###  variances</span>
 <span class="fu"><a href="https://kkholst.github.io/lava/reference/estimate.default.html">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">outacem</span><span class="op">$</span><span class="va">theta</span>,vcov<span class="op">=</span><span class="va">outacem</span><span class="op">$</span><span class="va">var.theta</span>,f<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="va">p</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;    Estimate Std.Err    2.5% 97.5% P-value</span>
<span class="co">#&gt; p1    5.125   2.278  0.6612 9.590 0.02443</span>
<span class="co">#&gt; p2   -1.218   1.355 -3.8737 1.437 0.36862</span>

 <span class="va">desae</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/npc.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">prt</span>,type<span class="op">=</span><span class="st">"ae"</span><span class="op">)</span>
 <span class="va">outaem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Grandom.cif.html">Grandom.cif</a></span><span class="op">(</span><span class="va">cif1</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">2</span>,cause2<span class="op">=</span><span class="fl">2</span>,
    same.cens<span class="op">=</span><span class="cn">TRUE</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">0.15</span><span class="op">)</span>,var.link<span class="op">=</span><span class="fl">0</span>,
        step<span class="op">=</span><span class="fl">0.5</span>,theta.des<span class="op">=</span><span class="va">desae</span><span class="op">$</span><span class="va">pardes</span>,random.design<span class="op">=</span><span class="va">desae</span><span class="op">$</span><span class="va">des.rv</span><span class="op">)</span>
 <span class="va">outaem</span><span class="op">$</span><span class="va">score</span>
<span class="co">#&gt;              [,1]</span>
<span class="co">#&gt; [1,] 3.667445e-07</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">outaem</span><span class="op">)</span>
<span class="co">#&gt; Random effect parameters for additive gamma random effects </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cause 2 and cause 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      Coef.     SE    z   P-val</span>
<span class="co">#&gt; [1,] 0.291 0.0723 4.02 5.7e-05</span>
<span class="co">#&gt; $estimate</span>
<span class="co">#&gt;      Coef.     SE    z   P-val</span>
<span class="co">#&gt; [1,] 0.291 0.0723 4.02 5.7e-05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $h</span>
<span class="co">#&gt;    Estimate Std.Err 2.5% 97.5% P-value</span>
<span class="co">#&gt; p1        1       0    1     1       0</span>
 <span class="fu"><a href="https://kkholst.github.io/lava/reference/estimate.default.html">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">outaem</span><span class="op">$</span><span class="va">theta</span>,vcov<span class="op">=</span><span class="va">outaem</span><span class="op">$</span><span class="va">var.theta</span>,f<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="va">p</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span>
<span class="co">#&gt; p1    3.438  0.8542 1.764 5.112 5.702e-05</span>

 <span class="va">desde</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/npc.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">prt</span>,type<span class="op">=</span><span class="st">"de"</span><span class="op">)</span>
 <span class="va">outaem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Grandom.cif.html">Grandom.cif</a></span><span class="op">(</span><span class="va">cif1</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">2</span>,cause2<span class="op">=</span><span class="fl">2</span>,
    same.cens<span class="op">=</span><span class="cn">TRUE</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.35</span><span class="op">)</span>,var.link<span class="op">=</span><span class="fl">0</span>,
        step<span class="op">=</span><span class="fl">0.5</span>,theta.des<span class="op">=</span><span class="va">desde</span><span class="op">$</span><span class="va">pardes</span>,random.design<span class="op">=</span><span class="va">desde</span><span class="op">$</span><span class="va">des.rv</span><span class="op">)</span>
 <span class="va">outaem</span><span class="op">$</span><span class="va">score</span>
<span class="co">#&gt;             [,1]</span>
<span class="co">#&gt; [1,] 4.00184e-07</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">outaem</span><span class="op">)</span>
<span class="co">#&gt; Random effect parameters for additive gamma random effects </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cause 2 and cause 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      Coef.     SE    z    P-val</span>
<span class="co">#&gt; [1,] 0.245 0.0656 3.73 0.000194</span>
<span class="co">#&gt; $estimate</span>
<span class="co">#&gt;      Coef.     SE    z    P-val</span>
<span class="co">#&gt; [1,] 0.245 0.0656 3.73 0.000194</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $h</span>
<span class="co">#&gt;    Estimate Std.Err 2.5% 97.5% P-value</span>
<span class="co">#&gt; p1        1       0    1     1       0</span>
 <span class="fu"><a href="https://kkholst.github.io/lava/reference/estimate.default.html">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">outaem</span><span class="op">$</span><span class="va">theta</span>,vcov<span class="op">=</span><span class="va">outaem</span><span class="op">$</span><span class="va">var.theta</span>,f<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="va">p</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span>
<span class="co">#&gt; p1    4.088   1.097 1.938 6.239 0.0001944</span>

  <span class="va">times</span> <span class="op">&lt;-</span> <span class="fl">90</span>
  <span class="va">cif1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/timereg/man/comp.risk.html">comp.risk</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">+</span><span class="fu">cluster</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,<span class="va">prt</span>,
           cause<span class="op">=</span><span class="fl">2</span>,times<span class="op">=</span><span class="va">times</span>,max.clust<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>

  <span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span>,<span class="va">prt</span><span class="op">)</span>
  <span class="va">out1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/random.cif.html">random.cif</a></span><span class="op">(</span><span class="va">cif1</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">2</span>,cause2<span class="op">=</span><span class="fl">2</span>,theta<span class="op">=</span><span class="fl">1</span>,
          theta.des<span class="op">=</span><span class="va">mm</span>,same.cens<span class="op">=</span><span class="cn">TRUE</span>,step<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">out1</span><span class="op">)</span>
<span class="co">#&gt; Random effect variance for variation due to clusters</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cause 2 and cause 2</span>
<span class="co">#&gt;                   Coef.        SE        z       P-val Cross odds ratio</span>
<span class="co">#&gt; factor(zyg)DZ 0.8737827 0.4091680 2.135511 0.032719303         1.873783</span>
<span class="co">#&gt; factor(zyg)MZ 3.1990114 0.9791185 3.267236 0.001086031         4.199011</span>
<span class="co">#&gt;                      SE</span>
<span class="co">#&gt; factor(zyg)DZ 0.4091680</span>
<span class="co">#&gt; factor(zyg)MZ 0.9791185</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://kkholst.github.io/lava/reference/estimate.default.html">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">out1</span><span class="op">$</span><span class="va">theta</span>,vcov<span class="op">=</span><span class="va">out1</span><span class="op">$</span><span class="va">var.theta</span><span class="op">)</span><span class="op">$</span><span class="va">coefmat</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;    Estimate 2.5% 97.5%</span>
<span class="co">#&gt; p1     0.87 0.07  1.68</span>
<span class="co">#&gt; p2     3.20 1.28  5.12</span>

 <span class="va">desde</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/npc.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">prt</span>,type<span class="op">=</span><span class="st">"de"</span><span class="op">)</span>
 <span class="va">outaem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Grandom.cif.html">Grandom.cif</a></span><span class="op">(</span><span class="va">cif1</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">2</span>,cause2<span class="op">=</span><span class="fl">2</span>,
    same.cens<span class="op">=</span><span class="cn">TRUE</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.35</span><span class="op">)</span>,var.link<span class="op">=</span><span class="fl">0</span>,
        step<span class="op">=</span><span class="fl">0.5</span>,theta.des<span class="op">=</span><span class="va">desde</span><span class="op">$</span><span class="va">pardes</span>,random.design<span class="op">=</span><span class="va">desde</span><span class="op">$</span><span class="va">des.rv</span><span class="op">)</span>
 <span class="va">outaem</span><span class="op">$</span><span class="va">score</span>
<span class="co">#&gt;              [,1]</span>
<span class="co">#&gt; [1,] 4.250029e-07</span>
 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">outaem</span><span class="op">)</span>
<span class="co">#&gt; Random effect parameters for additive gamma random effects </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cause 2 and cause 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      Coef.     SE    z    P-val</span>
<span class="co">#&gt; [1,] 0.299 0.0842 3.55 0.000384</span>
<span class="co">#&gt; $estimate</span>
<span class="co">#&gt;      Coef.     SE    z    P-val</span>
<span class="co">#&gt; [1,] 0.299 0.0842 3.55 0.000384</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $h</span>
<span class="co">#&gt;    Estimate Std.Err 2.5% 97.5% P-value</span>
<span class="co">#&gt; p1        1       0    1     1       0</span>
 <span class="fu"><a href="https://kkholst.github.io/lava/reference/estimate.default.html">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">outaem</span><span class="op">$</span><span class="va">theta</span>,vcov<span class="op">=</span><span class="va">outaem</span><span class="op">$</span><span class="va">var.theta</span>,f<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="va">p</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span>
<span class="co">#&gt; p1    3.346  0.9422 1.499 5.192 0.0003842</span></code></pre></div>
</div>
<div id="competing-risk-modeling-using-the-liabilty-threshold-model" class="section level1">
<h1 class="hasAnchor">
<a href="#competing-risk-modeling-using-the-liabilty-threshold-model" class="anchor"></a>Competing risk modeling using the Liabilty Threshold model</h1>
<p>First we fit the bivariate probit model (same marginals in MZ and DZ twins but different correlation parameter). Here we evaluate the risk of getting cancer before the last double cancer event (97 years)</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">prt</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">prt</span><span class="op">)</span>
<span class="va">prt0</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/npc.html">force.same.cens</a></span><span class="op">(</span><span class="va">prt</span>, cause<span class="op">=</span><span class="st">"status"</span>, cens.code<span class="op">=</span><span class="fl">0</span>, time<span class="op">=</span><span class="st">"time"</span>, id<span class="op">=</span><span class="st">"id"</span><span class="op">)</span>
<span class="va">prt0</span><span class="op">$</span><span class="va">country</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">prt0</span><span class="op">$</span><span class="va">country</span>, ref<span class="op">=</span><span class="st">"Sweden"</span><span class="op">)</span>
<span class="va">prt_wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fast.reshape.html">fast.reshape</a></span><span class="op">(</span><span class="va">prt0</span>, id<span class="op">=</span><span class="st">"id"</span>, num<span class="op">=</span><span class="st">"num"</span>, varying<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"time"</span>,<span class="st">"status"</span>,<span class="st">"cancer"</span><span class="op">)</span><span class="op">)</span>
<span class="va">prt_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">prt_wide</span>,  <span class="va">cancer1</span> <span class="op">&amp;</span> <span class="va">cancer2</span>, select<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">time1</span>, <span class="va">time2</span>, <span class="va">zyg</span><span class="op">)</span><span class="op">)</span>
<span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">95</span>
<span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">70</span>, <span class="va">tau</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co">## Time points to evaluate model in</span>

<span class="va">b0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin.time</a></span><span class="op">(</span><span class="va">cancer</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">prt0</span>, id<span class="op">=</span><span class="st">"id"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, type<span class="op">=</span><span class="st">"cor"</span>,
              cens.formula<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">zyg</span>, breaks<span class="op">=</span><span class="va">tau</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">b0</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                Estimate   Std.Err        Z   p-value    </span>
<span class="co">#&gt; (Intercept)   -1.348188  0.026276 -51.3086 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; atanh(rho) MZ  0.735992  0.087838   8.3789 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; atanh(rho) DZ  0.353023  0.068234   5.1737 2.295e-07 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total MZ/DZ Complete pairs MZ/DZ</span>
<span class="co">#&gt;  1994/3618   997/1809            </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                            Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Tetrachoric correlation MZ 0.62672  0.51081 0.72024</span>
<span class="co">#&gt; Tetrachoric correlation DZ 0.33905  0.21584 0.45164</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MZ:</span>
<span class="co">#&gt;                      Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Concordance          0.03504  0.02779 0.04409</span>
<span class="co">#&gt; Casewise Concordance 0.39458  0.31876 0.47584</span>
<span class="co">#&gt; Marginal             0.08880  0.08086 0.09743</span>
<span class="co">#&gt; Rel.Recur.Risk       4.44351  3.50521 5.38182</span>
<span class="co">#&gt; log(OR)              2.34131  1.87105 2.81157</span>
<span class="co">#&gt; DZ:</span>
<span class="co">#&gt;                      Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Concordance          0.01952  0.01449 0.02625</span>
<span class="co">#&gt; Casewise Concordance 0.21983  0.16667 0.28415</span>
<span class="co">#&gt; Marginal             0.08880  0.08086 0.09743</span>
<span class="co">#&gt; Rel.Recur.Risk       2.47556  1.81096 3.14017</span>
<span class="co">#&gt; log(OR)              1.23088  0.81020 1.65156</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Broad-sense heritability 0.57533  0.25790 0.89276</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Event of interest before time 95</span></code></pre></div>
<p>Liability threshold model with ACE random effects structure</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin.time</a></span><span class="op">(</span><span class="va">cancer</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">prt0</span>, id<span class="op">=</span><span class="st">"id"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, type<span class="op">=</span><span class="st">"ace"</span>,
              cens.formula<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">zyg</span>, breaks<span class="op">=</span><span class="va">tau</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">b1</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;             Estimate  Std.Err        Z p-value    </span>
<span class="co">#&gt; (Intercept) -2.20664  0.16463 -13.4034  &lt;2e-16 ***</span>
<span class="co">#&gt; log(var(A))  0.43261  0.39149   1.1050  0.2691    </span>
<span class="co">#&gt; log(var(C)) -1.98291  2.52347  -0.7858  0.4320    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total MZ/DZ Complete pairs MZ/DZ</span>
<span class="co">#&gt;  1994/3618   997/1809            </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                    Estimate 2.5%     97.5%   </span>
<span class="co">#&gt; A                   0.57533  0.25790  0.89276</span>
<span class="co">#&gt; C                   0.05139 -0.20836  0.31114</span>
<span class="co">#&gt; E                   0.37328  0.26874  0.47782</span>
<span class="co">#&gt; MZ Tetrachoric Cor  0.62672  0.51081  0.72024</span>
<span class="co">#&gt; DZ Tetrachoric Cor  0.33905  0.21584  0.45164</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MZ:</span>
<span class="co">#&gt;                      Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Concordance          0.03504  0.02779 0.04409</span>
<span class="co">#&gt; Casewise Concordance 0.39458  0.31876 0.47584</span>
<span class="co">#&gt; Marginal             0.08880  0.08086 0.09743</span>
<span class="co">#&gt; Rel.Recur.Risk       4.44351  3.50520 5.38182</span>
<span class="co">#&gt; log(OR)              2.34131  1.87105 2.81157</span>
<span class="co">#&gt; DZ:</span>
<span class="co">#&gt;                      Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Concordance          0.01952  0.01449 0.02625</span>
<span class="co">#&gt; Casewise Concordance 0.21983  0.16667 0.28415</span>
<span class="co">#&gt; Marginal             0.08880  0.08086 0.09743</span>
<span class="co">#&gt; Rel.Recur.Risk       2.47556  1.81095 3.14016</span>
<span class="co">#&gt; log(OR)              1.23088  0.81020 1.65156</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Broad-sense heritability 0.57533  0.25790 0.89276</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Event of interest before time 95</span></code></pre></div>
<p>In this case the ACE model fits the data well - it is in fact indistinguishable from the flexible bivariate Probit model as seen by the IPCW weighted AIC measure</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">b0</span>, <span class="va">b1</span><span class="op">)</span>
<span class="co">#&gt;    df      AIC</span>
<span class="co">#&gt; b0  3 17340.12</span>
<span class="co">#&gt; b1  3 17340.13</span></code></pre></div>
<p>ACE model with marginal adjusted for country</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin.time</a></span><span class="op">(</span><span class="va">cancer</span> <span class="op">~</span> <span class="va">country</span>, data<span class="op">=</span><span class="va">prt0</span>, id<span class="op">=</span><span class="st">"id"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, type<span class="op">=</span><span class="st">"ace"</span>,
              cens.formula<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">zyg</span><span class="op">+</span><span class="va">country</span>, breaks<span class="op">=</span><span class="fl">95</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">b2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                Estimate  Std.Err        Z   p-value    </span>
<span class="co">#&gt; (Intercept)    -1.97165  0.15371 -12.8267 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; countryDenmark -0.72489  0.11920  -6.0813 1.192e-09 ***</span>
<span class="co">#&gt; countryFinland  0.18968  0.12518   1.5152    0.1297    </span>
<span class="co">#&gt; countryNorway  -0.11611  0.16621  -0.6986    0.4848    </span>
<span class="co">#&gt; log(var(A))     0.40388  0.40524   0.9966    0.3189    </span>
<span class="co">#&gt; log(var(C))    -3.88744 17.56121  -0.2214    0.8248    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Total MZ/DZ Complete pairs MZ/DZ</span>
<span class="co">#&gt;  1994/3618   997/1809            </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                    Estimate 2.5%     97.5%   </span>
<span class="co">#&gt; A                   0.59474  0.25169  0.93779</span>
<span class="co">#&gt; C                   0.00814 -0.27297  0.28925</span>
<span class="co">#&gt; E                   0.39712  0.28435  0.50989</span>
<span class="co">#&gt; MZ Tetrachoric Cor  0.60288  0.47809  0.70381</span>
<span class="co">#&gt; DZ Tetrachoric Cor  0.30551  0.17238  0.42767</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MZ:</span>
<span class="co">#&gt;                      Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Concordance          0.04295  0.03307 0.05561</span>
<span class="co">#&gt; Casewise Concordance 0.40128  0.32263 0.48535</span>
<span class="co">#&gt; Marginal             0.10703  0.09453 0.12096</span>
<span class="co">#&gt; Rel.Recur.Risk       3.74923  2.94155 4.55690</span>
<span class="co">#&gt; log(OR)              2.15979  1.67935 2.64023</span>
<span class="co">#&gt; DZ:</span>
<span class="co">#&gt;                      Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Concordance          0.02439  0.01747 0.03396</span>
<span class="co">#&gt; Casewise Concordance 0.22788  0.17060 0.29749</span>
<span class="co">#&gt; Marginal             0.10703  0.09453 0.12096</span>
<span class="co">#&gt; Rel.Recur.Risk       2.12912  1.54509 2.71315</span>
<span class="co">#&gt; log(OR)              1.06262  0.62460 1.50064</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          Estimate 2.5%    97.5%  </span>
<span class="co">#&gt; Broad-sense heritability 0.59474  0.25169 0.93779</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Event of interest before time 95</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bt0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin.time</a></span><span class="op">(</span><span class="va">cancer</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">prt0</span>, id<span class="op">=</span><span class="st">"id"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, type<span class="op">=</span><span class="st">"ace"</span>, 
              cens.formula<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">zyg</span>,
              summary.function<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span>, breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span>
<span class="va">h2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">bt0</span><span class="op">$</span><span class="va">coef</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">heritability</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
<span class="va">concMZ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">bt0</span><span class="op">$</span><span class="va">coef</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">probMZ</span><span class="op">[</span><span class="st">"Concordance"</span>,,drop<span class="op">=</span><span class="cn">TRUE</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tt</span>, <span class="va">h2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"s"</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylab<span class="op">=</span><span class="st">"Heritability"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://kkholst.github.io/lava/reference/confband.html">confband</a></span><span class="op">(</span><span class="va">tt</span>, <span class="va">h2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">h2</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,polygon<span class="op">=</span><span class="cn">TRUE</span>, step<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fu"><a href="https://kkholst.github.io/lava/reference/Col.html">Col</a></span><span class="op">(</span><span class="va">cols</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">0.1</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tt</span>, <span class="va">concMZ</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"s"</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylab<span class="op">=</span><span class="st">"Concordance"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://kkholst.github.io/lava/reference/confband.html">confband</a></span><span class="op">(</span><span class="va">tt</span>, <span class="va">concMZ</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">concMZ</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,polygon<span class="op">=</span><span class="cn">TRUE</span>, step<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fu"><a href="https://kkholst.github.io/lava/reference/Col.html">Col</a></span><span class="op">(</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">0.1</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/bptime1-1.png" width="700"></p>
<p>Bivariate probit model at time different time points</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="va">a.mz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biprobit.html">biprobit.time</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">~</span><span class="fl">1</span>, id<span class="op">=</span><span class="st">"id"</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">prt0</span>, <span class="va">zyg</span><span class="op">==</span><span class="st">"MZ"</span><span class="op">)</span>,
                               cens.formula <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, pairs.only<span class="op">=</span><span class="cn">TRUE</span>,
                                breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   1.268   0.000   1.268</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="va">a.dz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biprobit.html">biprobit.time</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">~</span><span class="fl">1</span>, id<span class="op">=</span><span class="st">"id"</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">prt0</span>, <span class="va">zyg</span><span class="op">==</span><span class="st">"DZ"</span><span class="op">)</span>,
                               cens.formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, pairs.only<span class="op">=</span><span class="cn">TRUE</span>,
                               breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   1.765   0.000   1.765</span>

<span class="co">#system.time(a.zyg &lt;- biprobit.time(cancer~1, rho=~1+zyg, id="id", data=prt, </span>
<span class="co">#                               cens.formula = Event(time,status==0)~1,</span>
<span class="co">#                               eqmarg=FALSE, fix.cens.weight</span>
<span class="co">#                               breaks=seq(75,100,by=10)))</span>

<span class="va">a.mz</span>
<span class="co">#&gt;                           </span>
<span class="co">#&gt;  1:Concordance            </span>
<span class="co">#&gt;  2:Casewise Concordance   </span>
<span class="co">#&gt;  3:Marginal               </span>
<span class="co">#&gt;  4:Rel.Recur.Risk         </span>
<span class="co">#&gt;  5:OR                     </span>
<span class="co">#&gt;  6:Tetrachoric correlation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Time 1:Concor... 2:Casewi... 3:Marginal 4:Rel.Re...    5:OR 6:Tetrac...</span>
<span class="co">#&gt;  [1,]   70      0.0049      0.2976     0.0166     17.9649 35.3875      0.6973</span>
<span class="co">#&gt;  [2,]   71      0.0059      0.3254     0.0182     17.9058 38.1514      0.7194</span>
<span class="co">#&gt;  [3,]   72      0.0075      0.3419     0.0219     15.6453 34.8146      0.7223</span>
<span class="co">#&gt;  [4,]   73      0.0096      0.3695     0.0260     14.2029 34.2145      0.7362</span>
<span class="co">#&gt;  [5,]   74      0.0113      0.3734     0.0303     12.3242 29.8429      0.7278</span>
<span class="co">#&gt;  [6,]   75      0.0113      0.3466     0.0326     10.6189 23.5313      0.6931</span>
<span class="co">#&gt;  [7,]   76      0.0119      0.3373     0.0353      9.5430 20.4513      0.6748</span>
<span class="co">#&gt;  [8,]   77      0.0138      0.3610     0.0382      9.4430 21.6757      0.6936</span>
<span class="co">#&gt;  [9,]   78      0.0144      0.3453     0.0418      8.2562 17.9275      0.6662</span>
<span class="co">#&gt; [10,]   79      0.0158      0.3501     0.0450      7.7749 17.0411      0.6637</span>
<span class="co">#&gt; [11,]   80      0.0178      0.3590     0.0497      7.2229 16.1440      0.6628</span>
<span class="co">#&gt; [12,]   81      0.0193      0.3711     0.0519      7.1488 16.5478      0.6720</span>
<span class="co">#&gt; [13,]   82      0.0215      0.3508     0.0614      5.7160 12.1885      0.6253</span>
<span class="co">#&gt; [14,]   83      0.0255      0.3809     0.0668      5.7006 13.2646      0.6518</span>
<span class="co">#&gt; [15,]   84      0.0271      0.3860     0.0702      5.5017 12.9391      0.6514</span>
<span class="co">#&gt; [16,]   85      0.0279      0.3764     0.0742      5.0762 11.4822      0.6312</span>
<span class="co">#&gt; [17,]   86      0.0279      0.3718     0.0751      4.9517 11.0125      0.6232</span>
<span class="co">#&gt; [18,]   87      0.0279      0.3504     0.0797      4.3992  9.0556      0.5844</span>
<span class="co">#&gt; [19,]   88      0.0299      0.3626     0.0823      4.4046  9.3800      0.5959</span>
<span class="co">#&gt; [20,]   89      0.0308      0.3647     0.0846      4.3118  9.2050      0.5942</span>
<span class="co">#&gt; [21,]   90      0.0319      0.3724     0.0856      4.3502  9.5056      0.6028</span>
<span class="co">#&gt; [22,]   91      0.0319      0.3634     0.0877      4.1413  8.7503      0.5859</span>
<span class="co">#&gt; [23,]   92      0.0342      0.3735     0.0916      4.0758  8.8355      0.5924</span>
<span class="co">#&gt; [24,]   93      0.0342      0.3675     0.0931      3.9476  8.3690      0.5811</span>
<span class="co">#&gt; [25,]   94      0.0368      0.3805     0.0967      3.9342  8.6453      0.5925</span>
<span class="co">#&gt; [26,]   95      0.0409      0.4144     0.0988      4.1952 10.3180      0.6352</span>
<span class="va">a.dz</span>
<span class="co">#&gt;                           </span>
<span class="co">#&gt;  1:Concordance            </span>
<span class="co">#&gt;  2:Casewise Concordance   </span>
<span class="co">#&gt;  3:Marginal               </span>
<span class="co">#&gt;  4:Rel.Recur.Risk         </span>
<span class="co">#&gt;  5:OR                     </span>
<span class="co">#&gt;  6:Tetrachoric correlation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Time 1:Concor... 2:Casewi... 3:Marginal 4:Rel.Re...    5:OR 6:Tetrac...</span>
<span class="co">#&gt;  [1,]   70      0.0007      0.0767     0.0088      8.6698  9.9963      0.3855</span>
<span class="co">#&gt;  [2,]   71      0.0010      0.0896     0.0106      8.4527  9.9925      0.4016</span>
<span class="co">#&gt;  [3,]   72      0.0015      0.1198     0.0125      9.5630 12.0529      0.4559</span>
<span class="co">#&gt;  [4,]   73      0.0021      0.1342     0.0156      8.6270 11.1739      0.4618</span>
<span class="co">#&gt;  [5,]   74      0.0027      0.1549     0.0174      8.8955 12.0556      0.4897</span>
<span class="co">#&gt;  [6,]   75      0.0030      0.1597     0.0189      8.4554 11.5598      0.4891</span>
<span class="co">#&gt;  [7,]   76      0.0033      0.1492     0.0224      6.6561  8.8141      0.4469</span>
<span class="co">#&gt;  [8,]   77      0.0040      0.1676     0.0240      6.9803  9.6310      0.4738</span>
<span class="co">#&gt;  [9,]   78      0.0044      0.1625     0.0269      6.0388  8.1837      0.4484</span>
<span class="co">#&gt; [10,]   79      0.0062      0.2015     0.0308      6.5458  9.6973      0.5012</span>
<span class="co">#&gt; [11,]   80      0.0070      0.1996     0.0350      5.7087  8.3499      0.4799</span>
<span class="co">#&gt; [12,]   81      0.0074      0.1986     0.0372      5.3458  7.7672      0.4690</span>
<span class="co">#&gt; [13,]   82      0.0074      0.1753     0.0421      4.1618  5.6484      0.4040</span>
<span class="co">#&gt; [14,]   83      0.0087      0.1858     0.0467      3.9771  5.4904      0.4069</span>
<span class="co">#&gt; [15,]   84      0.0096      0.1913     0.0499      3.8320  5.3305      0.4058</span>
<span class="co">#&gt; [16,]   85      0.0096      0.1728     0.0553      3.1269  4.1086      0.3480</span>
<span class="co">#&gt; [17,]   86      0.0110      0.1854     0.0593      3.1273  4.2056      0.3603</span>
<span class="co">#&gt; [18,]   87      0.0120      0.1928     0.0623      3.0948  4.2149      0.3653</span>
<span class="co">#&gt; [19,]   88      0.0131      0.1964     0.0666      2.9496  4.0186      0.3584</span>
<span class="co">#&gt; [20,]   89      0.0136      0.1971     0.0691      2.8539  3.8759      0.3519</span>
<span class="co">#&gt; [21,]   90      0.0142      0.1997     0.0711      2.8075  3.8220      0.3507</span>
<span class="co">#&gt; [22,]   91      0.0167      0.2249     0.0741      3.0362  4.3888      0.3918</span>
<span class="co">#&gt; [23,]   92      0.0167      0.2163     0.0770      2.8086  3.9444      0.3662</span>
<span class="co">#&gt; [24,]   93      0.0167      0.2107     0.0790      2.6655  3.6733      0.3489</span>
<span class="co">#&gt; [25,]   94      0.0167      0.2051     0.0812      2.5257  3.4144      0.3308</span>
<span class="co">#&gt; [26,]   95      0.0174      0.2091     0.0831      2.5163  3.4242      0.3335</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">conczyg</span>,se<span class="op">=</span><span class="cn">TRUE</span>,legend<span class="op">=</span><span class="cn">FALSE</span>,xlab<span class="op">=</span><span class="st">"Age"</span>,ylab<span class="op">=</span><span class="st">"Concordance"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.07</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">a.mz</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.07</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, legend<span class="op">=</span><span class="cn">FALSE</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">a.dz</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/biprobittime1-1.png" width="700"></p>
<p>Bivariate probit model adjusting for country</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="va">a.mz_country</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biprobit.html">biprobit.time</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">~</span><span class="va">country</span>, id<span class="op">=</span><span class="st">"id"</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">prt0</span>, <span class="va">zyg</span><span class="op">==</span><span class="st">"MZ"</span><span class="op">)</span>,
                               cens.formula <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">country</span>, pairs.only<span class="op">=</span><span class="cn">TRUE</span>,
                                breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   2.410   0.004   2.414</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="va">a.dz_country</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biprobit.html">biprobit.time</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">~</span><span class="va">country</span>, id<span class="op">=</span><span class="st">"id"</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">prt0</span>, <span class="va">zyg</span><span class="op">==</span><span class="st">"DZ"</span><span class="op">)</span>,
                               cens.formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timereg/man/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">country</span>, pairs.only<span class="op">=</span><span class="cn">TRUE</span>,
                               breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   2.821   0.012   2.834</span>

<span class="va">a.mz_country</span>
<span class="co">#&gt;                           </span>
<span class="co">#&gt;  1:Concordance            </span>
<span class="co">#&gt;  2:Casewise Concordance   </span>
<span class="co">#&gt;  3:Marginal               </span>
<span class="co">#&gt;  4:Rel.Recur.Risk         </span>
<span class="co">#&gt;  5:OR                     </span>
<span class="co">#&gt;  6:Tetrachoric correlation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Time 1:Concor... 2:Casewi... 3:Marginal 4:Rel.Re...    5:OR 6:Tetrac...</span>
<span class="co">#&gt;  [1,]   70      0.0059      0.3061     0.0193     15.8281 31.7992      0.6944</span>
<span class="co">#&gt;  [2,]   71      0.0072      0.3285     0.0219     15.0095 32.0714      0.7084</span>
<span class="co">#&gt;  [3,]   72      0.0086      0.3487     0.0248     14.0806 31.8381      0.7194</span>
<span class="co">#&gt;  [4,]   73      0.0118      0.3756     0.0314     11.9720 29.1380      0.7271</span>
<span class="co">#&gt;  [5,]   74      0.0130      0.3786     0.0344     11.0025 26.9065      0.7222</span>
<span class="co">#&gt;  [6,]   75      0.0135      0.3553     0.0380      9.3456 21.0810      0.6878</span>
<span class="co">#&gt;  [7,]   76      0.0138      0.3422     0.0405      8.4586 18.2354      0.6662</span>
<span class="co">#&gt;  [8,]   77      0.0161      0.3605     0.0446      8.0851 18.3248      0.6769</span>
<span class="co">#&gt;  [9,]   78      0.0177      0.3502     0.0506      6.9206 15.0198      0.6499</span>
<span class="co">#&gt; [10,]   79      0.0193      0.3555     0.0542      6.5555 14.3750      0.6478</span>
<span class="co">#&gt; [11,]   80      0.0219      0.3682     0.0594      6.2014 14.0286      0.6518</span>
<span class="co">#&gt; [12,]   81      0.0226      0.3773     0.0600      6.2921 14.6466      0.6617</span>
<span class="co">#&gt; [13,]   82      0.0259      0.3606     0.0718      5.0239 10.8424      0.6153</span>
<span class="co">#&gt; [14,]   83      0.0301      0.3931     0.0766      5.1296 12.2112      0.6477</span>
<span class="co">#&gt; [15,]   84      0.0332      0.4010     0.0829      4.8392 11.6986      0.6460</span>
<span class="co">#&gt; [16,]   85      0.0336      0.3903     0.0860      4.5398 10.5234      0.6264</span>
<span class="co">#&gt; [17,]   86      0.0341      0.3874     0.0881      4.3993 10.0589      0.6185</span>
<span class="co">#&gt; [18,]   87      0.0360      0.3728     0.0966      3.8587  8.2669      0.5817</span>
<span class="co">#&gt; [19,]   88      0.0391      0.3863     0.1013      3.8142  8.4716      0.5921</span>
<span class="co">#&gt; [20,]   89      0.0407      0.3890     0.1047      3.7152  8.2726      0.5896</span>
<span class="co">#&gt; [21,]   90      0.0420      0.3963     0.1060      3.7376  8.5113      0.5976</span>
<span class="co">#&gt; [22,]   91      0.0418      0.3847     0.1086      3.5429  7.7170      0.5763</span>
<span class="co">#&gt; [23,]   92      0.0437      0.3877     0.1126      3.4421  7.5146      0.5732</span>
<span class="co">#&gt; [24,]   93      0.0436      0.3820     0.1142      3.3443  7.1373      0.5617</span>
<span class="co">#&gt; [25,]   94      0.0447      0.3853     0.1160      3.3213  7.1428      0.5634</span>
<span class="co">#&gt; [26,]   95      0.0497      0.4190     0.1186      3.5322  8.5017      0.6079</span>
<span class="va">a.dz_country</span>
<span class="co">#&gt;                           </span>
<span class="co">#&gt;  1:Concordance            </span>
<span class="co">#&gt;  2:Casewise Concordance   </span>
<span class="co">#&gt;  3:Marginal               </span>
<span class="co">#&gt;  4:Rel.Recur.Risk         </span>
<span class="co">#&gt;  5:OR                     </span>
<span class="co">#&gt;  6:Tetrachoric correlation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Time 1:Concor... 2:Casewi... 3:Marginal 4:Rel.Re...    5:OR 6:Tetrac...</span>
<span class="co">#&gt;  [1,]   70      0.0009      0.0824     0.0113      7.2626  8.4384      0.3735</span>
<span class="co">#&gt;  [2,]   71      0.0012      0.0884     0.0131      6.7203  7.8831      0.3724</span>
<span class="co">#&gt;  [3,]   72      0.0018      0.1219     0.0150      8.1122 10.2237      0.4394</span>
<span class="co">#&gt;  [4,]   73      0.0030      0.1482     0.0200      7.4102  9.8344      0.4597</span>
<span class="co">#&gt;  [5,]   74      0.0037      0.1689     0.0221      7.6314 10.6014      0.4867</span>
<span class="co">#&gt;  [6,]   75      0.0043      0.1743     0.0246      7.0866  9.9272      0.4830</span>
<span class="co">#&gt;  [7,]   76      0.0048      0.1653     0.0293      5.6443  7.6654      0.4417</span>
<span class="co">#&gt;  [8,]   77      0.0061      0.1885     0.0323      5.8417  8.3515      0.4716</span>
<span class="co">#&gt;  [9,]   78      0.0062      0.1776     0.0348      5.1095  7.0767      0.4401</span>
<span class="co">#&gt; [10,]   79      0.0088      0.2171     0.0405      5.3636  8.1188      0.4884</span>
<span class="co">#&gt; [11,]   80      0.0098      0.2118     0.0463      4.5703  6.7465      0.4574</span>
<span class="co">#&gt; [12,]   81      0.0099      0.2066     0.0479      4.3136  6.2634      0.4423</span>
<span class="co">#&gt; [13,]   82      0.0093      0.1759     0.0531      3.3130  4.4056      0.3626</span>
<span class="co">#&gt; [14,]   83      0.0107      0.1895     0.0563      3.3683  4.6055      0.3794</span>
<span class="co">#&gt; [15,]   84      0.0122      0.2018     0.0606      3.3328  4.6616      0.3893</span>
<span class="co">#&gt; [16,]   85      0.0122      0.1812     0.0674      2.6888  3.5187      0.3237</span>
<span class="co">#&gt; [17,]   86      0.0142      0.1943     0.0731      2.6587  3.5551      0.3332</span>
<span class="co">#&gt; [18,]   87      0.0157      0.2018     0.0777      2.5985  3.5090      0.3347</span>
<span class="co">#&gt; [19,]   88      0.0166      0.2046     0.0813      2.5171  3.3978      0.3295</span>
<span class="co">#&gt; [20,]   89      0.0174      0.2055     0.0847      2.4248  3.2569      0.3211</span>
<span class="co">#&gt; [21,]   90      0.0186      0.2096     0.0887      2.3625  3.1807      0.3181</span>
<span class="co">#&gt; [22,]   91      0.0212      0.2318     0.0914      2.5354  3.6017      0.3558</span>
<span class="co">#&gt; [23,]   92      0.0215      0.2248     0.0957      2.3479  3.2429      0.3298</span>
<span class="co">#&gt; [24,]   93      0.0208      0.2156     0.0964      2.2372  3.0109      0.3089</span>
<span class="co">#&gt; [25,]   94      0.0208      0.2088     0.0995      2.0993  2.7561      0.2857</span>
<span class="co">#&gt; [26,]   95      0.0221      0.2184     0.1012      2.1575  2.8949      0.3014</span></code></pre></div>
<p>ACE model (time-varying) with and without adjustment for country</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin.time</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">~</span><span class="fl">1</span>, id<span class="op">=</span><span class="st">"id"</span>, data<span class="op">=</span><span class="va">prt0</span>, type<span class="op">=</span><span class="st">"ace"</span>,
                              zyg<span class="op">=</span><span class="st">"zyg"</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, 
                              cens.formula<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">zyg</span>,
                              breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;  11.661   0.032  11.695</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="va">a2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin.time</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">~</span><span class="va">country</span>, id<span class="op">=</span><span class="st">"id"</span>, data<span class="op">=</span><span class="va">prt0</span>, type<span class="op">=</span><span class="st">"ace"</span>,
                              zyg<span class="op">=</span><span class="st">"zyg"</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, 
                              cens.formula<span class="op">=</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="va">zyg</span>,
                              breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;  17.930   0.008  17.940</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">a.mz</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylab<span class="op">=</span><span class="st">"Correlation"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, legend<span class="op">=</span><span class="cn">NULL</span>, alpha<span class="op">=</span><span class="fl">.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">a.dz</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, legend<span class="op">=</span><span class="cn">NULL</span>, add<span class="op">=</span><span class="cn">TRUE</span>, alpha<span class="op">=</span><span class="fl">.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MZ tetrachoric correlation"</span>, <span class="st">"DZ tetrachoric correlation"</span><span class="op">)</span>,
       col<span class="op">=</span><span class="va">cols</span>, lty<span class="op">=</span><span class="va">ltys</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">a.mz</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylab<span class="op">=</span><span class="st">"Relative Recurrence Risk"</span>,
     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">20</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, legend<span class="op">=</span><span class="cn">NULL</span>, lwd<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">a.dz</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, legend<span class="op">=</span><span class="cn">NULL</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MZ relative recurrence risk"</span>, <span class="st">"DZ relative recurrence risk"</span><span class="op">)</span>,
       col<span class="op">=</span><span class="va">cols</span>, lty<span class="op">=</span><span class="va">ltys</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">a1</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylab<span class="op">=</span><span class="st">"Correlation"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">0.1</span>,
     legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MZ tetrachoric correlation"</span>, <span class="st">"DZ tetrachoric correlation"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/unnamed-chunk-2-3.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">a1</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"black"</span>, lty<span class="op">=</span><span class="fl">1</span>, ylab<span class="op">=</span><span class="st">"Heritability"</span>, legend<span class="op">=</span><span class="cn">NULL</span>, alpha<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/unnamed-chunk-2-4.png" width="700"></p>
</div>
<div id="sessioninfo" class="section level1">
<h1 class="hasAnchor">
<a href="#sessioninfo" class="anchor"></a>SessionInfo</h1>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.1.1 (2021-08-10)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 20.04.3 LTS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0</span>
<span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span>
<span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span>
<span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span>
<span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] prodlim_2019.11.13 mets_1.2.9         lava_1.6.10        timereg_2.0.0     </span>
<span class="co">#&gt; [5] survival_3.2-11   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] Rcpp_1.0.7          compiler_4.1.1      highr_0.9          </span>
<span class="co">#&gt;  [4] tools_4.1.1         digest_0.6.27       evaluate_0.14      </span>
<span class="co">#&gt;  [7] memoise_2.0.0       lattice_0.20-44     ucminf_1.1-4       </span>
<span class="co">#&gt; [10] rlang_0.4.11        Matrix_1.3-4        yaml_2.2.1         </span>
<span class="co">#&gt; [13] parallel_4.1.1      mvtnorm_1.1-2       pkgdown_1.6.1      </span>
<span class="co">#&gt; [16] xfun_0.25           fastmap_1.1.0       stringr_1.4.0      </span>
<span class="co">#&gt; [19] knitr_1.33          desc_1.3.0          fs_1.5.0           </span>
<span class="co">#&gt; [22] systemfonts_1.0.2   globals_0.14.0      rprojroot_2.0.2    </span>
<span class="co">#&gt; [25] grid_4.1.1          listenv_0.8.0       R6_2.5.1           </span>
<span class="co">#&gt; [28] textshaping_0.3.5   future.apply_1.8.1  parallelly_1.27.0  </span>
<span class="co">#&gt; [31] rmarkdown_2.10      magrittr_2.0.1      codetools_0.2-18   </span>
<span class="co">#&gt; [34] htmltools_0.5.2     splines_4.1.1       future_1.22.1      </span>
<span class="co">#&gt; [37] numDeriv_2016.8-1.1 ragg_1.1.3          stringi_1.7.4      </span>
<span class="co">#&gt; [40] cachem_1.0.6        crayon_1.4.1</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A practical guide to Human Genetics with Lifetime Data â€¢ mets</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A practical guide to Human Genetics with Lifetime Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/basic-dutils.html">dUtility data-frame manipulations</a></li>
    <li><a class="dropdown-item" href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a></li>
    <li><a class="dropdown-item" href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a></li>
    <li><a class="dropdown-item" href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/binreg-TRS.html">Two-Stage Randomization for for Competing risks and Survival outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/binreg.html">Binomial Regression for Survival and Competing Risks Data</a></li>
    <li><a class="dropdown-item" href="../articles/cifreg.html">Cumulative Incidence Regression</a></li>
    <li><a class="dropdown-item" href="../articles/cooking-survival-data.html">WIP: Cooking survival data, 5 minute recipes</a></li>
    <li><a class="dropdown-item" href="../articles/cumulative-cost.html">IPCW Cumulative Cost</a></li>
    <li><a class="dropdown-item" href="../articles/glm-utility.html">GEE cluster standard errors and predictions for glm objects</a></li>
    <li><a class="dropdown-item" href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a></li>
    <li><a class="dropdown-item" href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a></li>
    <li><a class="dropdown-item" href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a></li>
    <li><a class="dropdown-item" href="../articles/mediation-survival.html">Mediation Analysis for survival data</a></li>
    <li><a class="dropdown-item" href="../articles/phreg_rct.html">Randomization for Cox Type rate models </a></li>
    <li><a class="dropdown-item" href="../articles/quantitative-twin.html">Twin models</a></li>
    <li><a class="dropdown-item" href="../articles/recurrent-events.html">Recurrent events</a></li>
    <li><a class="dropdown-item" href="../articles/rmst-ate.html">Average treatment effect (ATE) for Restricted mean survival and years lost of Competing risks</a></li>
    <li><a class="dropdown-item" href="../articles/survival-ate.html">G-Computation or standardization for the Cox, Fine-Gray and binomial regression models for survival data</a></li>
    <li><a class="dropdown-item" href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a></li>
    <li><a class="dropdown-item" href="../articles/twostage-survival.html">Analysis of multivariate survival data</a></li>
    <li><a class="dropdown-item" href="../articles/while-alive.html">While Alive estimands for Recurrent Events</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kkholst/mets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>A practical guide to Human Genetics with Lifetime Data</h1>
                        <h4 data-toc-skip class="author">Klaus Holst
&amp; Thomas Scheike</h4>
            
            <h4 data-toc-skip class="date">2026-01-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/main/vignettes/time-to-event-family-studies-arev.Rmd" class="external-link"><code>vignettes/time-to-event-family-studies-arev.Rmd</code></a></small>
      <div class="d-none name"><code>time-to-event-family-studies-arev.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates how to analyze familial resemblance for
twins using the {}-package and is accompanying the review by Scheike and
Holst (2020).</p>
<p>We consider a data-set in that resembles the data of that were based
on the NorTwinCan a collaborative research project studying the genetic
and environmental components of prostate cancer. The data comprises
around 18,000 DZ twins and 11,000 MZ twins. It was a population based
register study based on the Danish, Finnish, Norwegian, and Swedish twin
registries.</p>
<p>We first illustrate a hazards based analysis to show how one would
study dependence in survival data. This needs to be done under
assumptions about independent competing risks when the outcome of
interest is observed subject to competing risks (here death).</p>
<p>This seems reasonable here since the occurrence of cancer prior to
death only contains weak association with the risk of death for the
other twin, and vice-versa.</p>
<p>First looking at the data</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/mets/" class="external-link">mets</a></span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">122</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">prt</span><span class="op">)</span></span>
<span> </span>
<span> <span class="fu"><a href="../reference/dtable.html">dtable</a></span><span class="op">(</span><span class="va">prt</span>,<span class="op">~</span><span class="va">status</span><span class="op">+</span><span class="va">cancer</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        cancer     0     1</span></span>
<span><span class="co">#&gt; status                   </span></span>
<span><span class="co">#&gt; 0             21283     0</span></span>
<span><span class="co">#&gt; 1              6997     0</span></span>
<span><span class="co">#&gt; 2                 0   942</span></span>
<span> <span class="fu"><a href="../reference/dtable.html">dtable</a></span><span class="op">(</span><span class="va">prt</span>,<span class="op">~</span><span class="va">zyg</span><span class="op">+</span><span class="va">country</span>,level<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; zyg</span></span>
<span><span class="co">#&gt;    DZ    MZ </span></span>
<span><span class="co">#&gt; 17991 11231 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; country</span></span>
<span><span class="co">#&gt; Denmark Finland  Norway  Sweden </span></span>
<span><span class="co">#&gt;    9671    3926    4107   11518</span></span></code></pre></div>
<p>we see that there are 21283 censorings and 6997 deaths (prior to
cancer) and a total of 942 prostate cancers. Approximately half the data
consist of DZ twins. In addition we see that there are around 10000
twins from Denmark and Sweden, and only 4000 from Norway and Finland,
respectively.</p>
<div class="section level2">
<h2 id="survival">Survival<a class="anchor" aria-label="anchor" href="#survival"></a>
</h2>
<p>Under assumption of random effects acting independently on different
cause specific hazards we can analyse competing risks data considering
the cause-specific hazard. Typically, this can be questionable and the
cumulative incidence modelling below does not rely on this
assumption.</p>
<p>We consider the cause specific hazard of cancer in the competing
risks model with death and cancer.</p>
<p>First estimating the marginal hazards for each country.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># Marginal Cox model here stratified on country without covariates </span></span>
<span> <span class="va">margph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">cancer</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">margph</span><span class="op">)</span></span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/survival-marginal-1.png" class="r-plt" alt="" width="600px"></p>
<p>We see that the marginal of Denmark in particular is quite
different.</p>
<p>Then we fit a two-stage random effects models with country specific
marginals and random-effects variances that differ for MZ and DZ
twins.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Clayton-Oakes, MLE , overall variance</span></span>
<span><span class="va">fitco1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/twostageMLE.html">twostageMLE</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">2.7</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitco1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                Coef.        SE        z        P-val Kendall tau        SE</span></span>
<span><span class="co">#&gt; dependence1 2.782962 0.4225572 6.586001 4.518319e-11   0.5818491 0.0369421</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitco2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">2.7</span>,clusters<span class="op">=</span><span class="va">prt</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitco2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                Coef.        SE        z        P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 2.782962 0.4225529 6.586069 4.516254e-11   0.5818491 0.03694172</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>With different random effects for MZ and DZ</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span>,<span class="va">prt</span><span class="op">)</span></span>
<span> <span class="va">fitco3</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/twostageMLE.html">twostageMLE</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">1</span>,theta.des<span class="op">=</span><span class="va">mm</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitco3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                  Coef.        SE        z        P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; factor(zyg)DZ 1.318966 0.3861577 3.415614 6.363831e-04   0.3974027 0.07011148</span></span>
<span><span class="co">#&gt; factor(zyg)MZ 5.421921 0.9626267 5.632423 1.776956e-08   0.7305280 0.03495065</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitco4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">1</span>,clusters<span class="op">=</span><span class="va">prt</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">0</span>,theta.des<span class="op">=</span><span class="va">mm</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitco4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                  Coef.        SE        z        P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; factor(zyg)DZ 1.318966 0.3861745 3.415466 6.367306e-04   0.3974027 0.07011454</span></span>
<span><span class="co">#&gt; factor(zyg)MZ 5.421920 0.9625027 5.633148 1.769493e-08   0.7305280 0.03494615</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="http://kkholst.github.io/lava/reference/estimate.default.html" class="external-link">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">fitco4</span><span class="op">$</span><span class="va">coef</span>,vcov<span class="op">=</span><span class="va">fitco4</span><span class="op">$</span><span class="va">var.theta</span><span class="op">)</span><span class="op">$</span><span class="va">coefmat</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;               Estimate 2.5% 97.5%</span></span>
<span><span class="co">#&gt; factor(zyg)DZ     1.32 0.56  2.08</span></span>
<span><span class="co">#&gt; factor(zyg)MZ     5.42 3.54  7.31</span></span>
<span></span>
<span> <span class="co">## mz kendalls tau</span></span>
<span> <span class="fu"><a href="../reference/internal.html">kendall.ClaytonOakes.twin.ace</a></span><span class="op">(</span><span class="va">fitco4</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="fl">0</span>,K<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">$</span><span class="va">mz.kendall</span></span>
<span><span class="co">#&gt; [1] 0.7380818</span></span>
<span> <span class="co">## dz kendalls tau</span></span>
<span> <span class="fu"><a href="../reference/internal.html">kendall.ClaytonOakes.twin.ace</a></span><span class="op">(</span><span class="va">fitco4</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">0</span>,K<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">$</span><span class="va">mz.kendall</span></span>
<span><span class="co">#&gt; [1] 0.4154807</span></span></code></pre></div>
<p>The dependence of MZ twins is much stronger, and is summarized by a
variance at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>5.42</mn><annotation encoding="application/x-tex">5.42</annotation></semantics></math>
in contrast to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">DZ</annotation></semantics></math>
variance at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1.32</mn><annotation encoding="application/x-tex">1.32</annotation></semantics></math>.</p>
<p>Now we look at the polygenic modelling for survival data, here
applied to the cause specific hazards.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co">### setting up design for random effects and parameters of random effects</span></span>
<span> <span class="va">desace</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">prt</span>,type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span></span>
<span></span>
<span> <span class="co">### ace model </span></span>
<span> <span class="va">fitace</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">1</span>,</span>
<span>       clusters<span class="op">=</span><span class="va">prt</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">0</span>,model<span class="op">=</span><span class="st">"clayton.oakes"</span>,</span>
<span>       numDeriv<span class="op">=</span><span class="fl">1</span>,random.design<span class="op">=</span><span class="va">desace</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">desace</span><span class="op">$</span><span class="va">pardes</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitace</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.       SE         z        P-val Kendall tau          SE</span></span>
<span><span class="co">#&gt; dependence1  7.223855 1.841525  3.922757 8.754161e-05   0.7831709  0.04328951</span></span>
<span><span class="co">#&gt; dependence2 -1.582396 1.088423 -1.453843 1.459898e-01  -3.7892257 12.48240540</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;      Estimate Std.Err    2.5%   97.5%   P-value</span></span>
<span><span class="co">#&gt; [1,]   1.2805  0.1698  0.9477 1.61324 4.615e-14</span></span>
<span><span class="co">#&gt; [2,]  -0.2805  0.1698 -0.6132 0.05226 9.850e-02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1    5.641  0.9894 3.702 7.581 1.184e-08</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co">### ace model with positive random effects variances</span></span>
<span> <span class="co"># fitacee &lt;- survival.twostage(margph,data=prt,theta=1,</span></span>
<span> <span class="co">#      clusters=prt$id,var.link=1,model="clayton.oakes",</span></span>
<span> <span class="co">#      numDeriv=1,random.design=desace$des.rv,theta.des=desace$pardes)</span></span>
<span> <span class="co">#summary(fitacee)</span></span>
<span> </span>
<span> <span class="co">### ae model </span></span>
<span> <span class="co">#desae &lt;- twin.polygen.design(prt,type="ae")</span></span>
<span> <span class="co">#fitae &lt;- survival.twostage(margph,data=prt,theta=1,</span></span>
<span> <span class="co">#      clusters=prt$id,var.link=0,model="clayton.oakes",</span></span>
<span> <span class="co">#      numDeriv=1,random.design=desae$des.rv,theta.des=desae$pardes)</span></span>
<span> <span class="co">#summary(fitae)</span></span>
<span></span>
<span> <span class="co">### de model </span></span>
<span> <span class="va">desde</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">prt</span>,type<span class="op">=</span><span class="st">"de"</span><span class="op">)</span></span>
<span> <span class="va">fitde</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">prt</span>,theta<span class="op">=</span><span class="fl">1</span>,clusters<span class="op">=</span><span class="va">prt</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">0</span>,model<span class="op">=</span><span class="st">"clayton.oakes"</span>,</span>
<span>numDeriv<span class="op">=</span><span class="fl">1</span>,random.design<span class="op">=</span><span class="va">desde</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">desde</span><span class="op">$</span><span class="va">pardes</span><span class="op">)</span>                            </span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitde</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                Coef.        SE        z        P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 5.940643 0.9837336 6.038873 1.551941e-09   0.7481312 0.03120299</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;      Estimate Std.Err 2.5% 97.5% P-value</span></span>
<span><span class="co">#&gt; [1,]        1       0    1     1       0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1    5.941  0.9837 4.013 7.869 1.552e-09</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>The DE model fits quite well. In summary all shared variance is due
to genes and there is no suggestion of a shared environmental
effect.</p>
</div>
<div class="section level2">
<h2 id="concordance-and-casewise">Concordance and Casewise<a class="anchor" aria-label="anchor" href="#concordance-and-casewise"></a>
</h2>
<p>First we estimate the concordance of joint prostate cancer. The
two-twins are censored at the same time, otherwise we would enforce this
in the data by artificially censor both twins at the first censoring
time. Given, however, that we have the same-censoring assumption
satisfied we can do the stanadar Aalen-Johansen product-limit estimator
of the concordance probabilities for MZ and DZ twins.</p>
<p>For simplicity we do not do this for each country even though as we
show there are big differences between the countries.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prt</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/internal.html">force.same.cens</a></span><span class="op">(</span><span class="va">prt</span>,cause<span class="op">=</span><span class="st">"status"</span><span class="op">)</span></span>
<span></span>
<span> <span class="fu"><a href="../reference/dtable.html">dtable</a></span><span class="op">(</span><span class="va">prt</span>,<span class="op">~</span><span class="va">status</span><span class="op">+</span><span class="va">cancer</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        cancer     0     1</span></span>
<span><span class="co">#&gt; status                   </span></span>
<span><span class="co">#&gt; 0             21580    77</span></span>
<span><span class="co">#&gt; 1              6700     0</span></span>
<span><span class="co">#&gt; 2                 0   865</span></span>
<span> <span class="fu"><a href="../reference/dtable.html">dtable</a></span><span class="op">(</span><span class="va">prt</span>,<span class="op">~</span><span class="va">status</span><span class="op">+</span><span class="va">country</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        country Denmark Finland Norway Sweden</span></span>
<span><span class="co">#&gt; status                                      </span></span>
<span><span class="co">#&gt; 0                 7394    2622   3154   8487</span></span>
<span><span class="co">#&gt; 1                 2140    1138    830   2592</span></span>
<span><span class="co">#&gt; 2                  137     166    123    439</span></span>
<span> <span class="fu"><a href="../reference/dtable.html">dtable</a></span><span class="op">(</span><span class="va">prt</span>,<span class="op">~</span><span class="va">zyg</span><span class="op">+</span><span class="va">country</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     country Denmark Finland Norway Sweden</span></span>
<span><span class="co">#&gt; zyg                                      </span></span>
<span><span class="co">#&gt; DZ             6191    2833   2393   6574</span></span>
<span><span class="co">#&gt; MZ             3480    1093   1714   4944</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co">## cumulative incidence with cluster standard errors.</span></span>
<span> <span class="va">cif1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cif.html">cif</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,<span class="va">prt</span>,cause<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cif1</span>,se<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/concordance-1.png" class="r-plt" alt="" width="600px"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span> <span class="va">cifa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cif.html">cif</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fl">1</span>,<span class="va">prt</span>,cause<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span> <span class="co">### concordance estimator, ignoring country differences. </span></span>
<span> <span class="va">p11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicomprisk.html">bicomprisk</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Strata 'DZ'</span></span>
<span><span class="co">#&gt; Strata 'MZ'</span></span>
<span><span class="va">p11mz</span> <span class="op">&lt;-</span> <span class="va">p11</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="st">"MZ"</span></span>
<span><span class="va">p11dz</span> <span class="op">&lt;-</span> <span class="va">p11</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="st">"DZ"</span> </span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="co">## Concordance</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p11mz</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>;</span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p11dz</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>;</span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" alt="" width="600px"></p>
<p>Now we compare the concordance to the marginals to get a measure that
takes the marginals into account when evaluating the strength of the
association.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">prodlim</span><span class="op">)</span></span>
<span> <span class="va">outm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/prodlim.html" class="external-link">prodlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">prt</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">cifzyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cif.html">cif</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span> <span class="va">cifprt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cif.html">cif</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>     </span>
<span> <span class="va">times</span> <span class="op">&lt;-</span> <span class="fl">70</span><span class="op">:</span><span class="fl">100</span></span>
<span> <span class="va">cifmz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlogit.html">predict</a></span><span class="op">(</span><span class="va">outm</span>,cause<span class="op">=</span><span class="fl">2</span>,time<span class="op">=</span><span class="va">times</span>,newdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>zyg<span class="op">=</span><span class="st">"MZ"</span><span class="op">)</span><span class="op">)</span> <span class="co">## cause is 2 (second cause) </span></span>
<span> <span class="va">cifdz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlogit.html">predict</a></span><span class="op">(</span><span class="va">outm</span>,cause<span class="op">=</span><span class="fl">2</span>,time<span class="op">=</span><span class="va">times</span>,newdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>zyg<span class="op">=</span><span class="st">"DZ"</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span> <span class="co">### concordance for MZ and DZ twins&lt;</span></span>
<span> <span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicomprisk.html">bicomprisk</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,prodlim<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Strata 'DZ'</span></span>
<span><span class="co">#&gt; Strata 'MZ'</span></span>
<span> <span class="va">ccdz</span> <span class="op">&lt;-</span> <span class="va">cc</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="st">"DZ"</span></span>
<span> <span class="va">ccmz</span> <span class="op">&lt;-</span> <span class="va">cc</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="st">"MZ"</span></span>
<span>     </span>
<span> <span class="va">cdz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/casewise.html">casewise</a></span><span class="op">(</span><span class="va">ccdz</span>,<span class="va">outm</span>,cause.marg<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </span>
<span> <span class="va">cmz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/casewise.html">casewise</a></span><span class="op">(</span><span class="va">ccmz</span>,<span class="va">outm</span>,cause.marg<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicomprisk.html">bicompriskData</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="va">conczyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cif.html">cif</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">dd</span>,cause<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">conczyg</span>,se<span class="op">=</span><span class="cn">TRUE</span>,col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>, legend<span class="op">=</span><span class="cn">FALSE</span>,xlab<span class="op">=</span><span class="st">"Age"</span>,ylab<span class="op">=</span><span class="st">"Concordance"</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"concordance-MZ"</span>,<span class="st">"concordance-DZ"</span><span class="op">)</span>,col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cmz</span>,ci<span class="op">=</span><span class="cn">NULL</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.8</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>,<span class="fl">97</span><span class="op">)</span>,legend<span class="op">=</span><span class="cn">FALSE</span>,col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,</span>
<span>      ylab<span class="op">=</span><span class="st">"Casewise"</span>,xlab<span class="op">=</span><span class="st">"Age"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cdz</span>,ci<span class="op">=</span><span class="cn">NULL</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.8</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>,<span class="fl">97</span><span class="op">)</span>,legend<span class="op">=</span><span class="cn">FALSE</span>,ylab<span class="op">=</span><span class="st">"Casewise"</span>,xlab<span class="op">=</span><span class="st">"Age"</span>,</span>
<span>      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">cmz</span><span class="op">$</span><span class="va">casewise</span><span class="op">)</span>,<span class="fu"><a href="../reference/plot.phreg.html">plotConfRegionSE</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">casewise.conc</span>,<span class="va">se.casewise</span>,col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">cdz</span><span class="op">$</span><span class="va">casewise</span><span class="op">)</span>,<span class="fu"><a href="../reference/plot.phreg.html">plotConfRegionSE</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">casewise.conc</span>,<span class="va">se.casewise</span>,col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"casewise-MZ"</span>,<span class="st">"casewise-DZ"</span>,<span class="st">"marginal"</span><span class="op">)</span>,col<span class="op">=</span><span class="va">cols</span>, lty<span class="op">=</span><span class="va">ltys</span>, bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/concordance2-1.png" class="r-plt" alt="" width="600px"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cdz</span><span class="op">)</span></span>
<span><span class="co">#&gt; Casewise concordance and standard errors </span></span>
<span><span class="co">#&gt;        time casewise conc se casewise</span></span>
<span><span class="co">#&gt;  [1,]  59.5        0.0866      0.0865</span></span>
<span><span class="co">#&gt;  [2,]  60.5        0.0659      0.0659</span></span>
<span><span class="co">#&gt;  [3,]  61.6        0.0593      0.0593</span></span>
<span><span class="co">#&gt;  [4,]  62.7        0.0483      0.0483</span></span>
<span><span class="co">#&gt;  [5,]  63.7        0.0358      0.0358</span></span>
<span><span class="co">#&gt;  [6,]  64.8        0.0279      0.0279</span></span>
<span><span class="co">#&gt;  [7,]  65.8        0.0223      0.0223</span></span>
<span><span class="co">#&gt;  [8,]  66.9        0.0197      0.0197</span></span>
<span><span class="co">#&gt;  [9,]  68.0        0.0415      0.0297</span></span>
<span><span class="co">#&gt; [10,]  69.0        0.0335      0.0240</span></span>
<span><span class="co">#&gt; [11,]  70.1        0.0452      0.0264</span></span>
<span><span class="co">#&gt; [12,]  71.1        0.0855      0.0352</span></span>
<span><span class="co">#&gt; [13,]  72.2        0.0728      0.0300</span></span>
<span><span class="co">#&gt; [14,]  73.2        0.0888      0.0317</span></span>
<span><span class="co">#&gt; [15,]  74.3        0.1010      0.0321</span></span>
<span><span class="co">#&gt; [16,]  75.4        0.1020      0.0310</span></span>
<span><span class="co">#&gt; [17,]  76.4        0.1130      0.0318</span></span>
<span><span class="co">#&gt; [18,]  77.5        0.1230      0.0320</span></span>
<span><span class="co">#&gt; [19,]  78.5        0.1400      0.0334</span></span>
<span><span class="co">#&gt; [20,]  79.6        0.1470      0.0332</span></span>
<span><span class="co">#&gt; [21,]  80.7        0.1530      0.0329</span></span>
<span><span class="co">#&gt; [22,]  81.7        0.1460      0.0307</span></span>
<span><span class="co">#&gt; [23,]  82.8        0.1470      0.0298</span></span>
<span><span class="co">#&gt; [24,]  83.8        0.1600      0.0307</span></span>
<span><span class="co">#&gt; [25,]  84.9        0.1470      0.0282</span></span>
<span><span class="co">#&gt; [26,]  86.0        0.1620      0.0297</span></span>
<span><span class="co">#&gt; [27,]  87.0        0.1680      0.0300</span></span>
<span><span class="co">#&gt; [28,]  88.1        0.1820      0.0311</span></span>
<span><span class="co">#&gt; [29,]  89.1        0.1760      0.0301</span></span>
<span><span class="co">#&gt; [30,]  90.2        0.1950      0.0323</span></span>
<span><span class="co">#&gt; [31,]  91.2        0.2040      0.0332</span></span>
<span><span class="co">#&gt; [32,]  92.3        0.1970      0.0321</span></span>
<span><span class="co">#&gt; [33,]  93.4        0.1940      0.0315</span></span>
<span><span class="co">#&gt; [34,]  94.4        0.1970      0.0318</span></span>
<span><span class="co">#&gt; [35,]  95.5        0.1940      0.0314</span></span>
<span><span class="co">#&gt; [36,]  96.5        0.1930      0.0312</span></span>
<span><span class="co">#&gt; [37,]  97.6        0.2040      0.0330</span></span>
<span><span class="co">#&gt; [38,]  98.7        0.2010      0.0325</span></span>
<span><span class="co">#&gt; [39,]  99.7        0.1990      0.0322</span></span>
<span><span class="co">#&gt; [40,] 101.0        0.1980      0.0321</span></span>
<span><span class="co">#&gt; [41,] 102.0        0.1950      0.0316</span></span>
<span><span class="co">#&gt; [42,] 103.0        0.1940      0.0314</span></span>
<span><span class="co">#&gt; [43,] 104.0        0.1940      0.0314</span></span>
<span><span class="co">#&gt; [44,] 105.0        0.1930      0.0312</span></span>
<span><span class="co">#&gt; [45,] 106.0        0.1920      0.0311</span></span>
<span><span class="co">#&gt; [46,] 107.0        0.1920      0.0311</span></span>
<span><span class="co">#&gt; [47,] 108.0        0.1910         NaN</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cmz</span><span class="op">)</span></span>
<span><span class="co">#&gt; Casewise concordance and standard errors </span></span>
<span><span class="co">#&gt;        time casewise conc se casewise</span></span>
<span><span class="co">#&gt;  [1,]  60.6         0.519      0.2590</span></span>
<span><span class="co">#&gt;  [2,]  61.6         0.466      0.2330</span></span>
<span><span class="co">#&gt;  [3,]  62.7         0.380      0.1900</span></span>
<span><span class="co">#&gt;  [4,]  63.7         0.285      0.1420</span></span>
<span><span class="co">#&gt;  [5,]  64.8         0.286      0.1280</span></span>
<span><span class="co">#&gt;  [6,]  65.8         0.228      0.1020</span></span>
<span><span class="co">#&gt;  [7,]  66.9         0.295      0.1120</span></span>
<span><span class="co">#&gt;  [8,]  67.9         0.306      0.1090</span></span>
<span><span class="co">#&gt;  [9,]  68.9         0.327      0.1040</span></span>
<span><span class="co">#&gt; [10,]  70.0         0.338      0.0981</span></span>
<span><span class="co">#&gt; [11,]  71.0         0.345      0.0926</span></span>
<span><span class="co">#&gt; [12,]  72.1         0.399      0.0946</span></span>
<span><span class="co">#&gt; [13,]  73.1         0.414      0.0909</span></span>
<span><span class="co">#&gt; [14,]  74.2         0.426      0.0874</span></span>
<span><span class="co">#&gt; [15,]  75.2         0.388      0.0798</span></span>
<span><span class="co">#&gt; [16,]  76.3         0.391      0.0773</span></span>
<span><span class="co">#&gt; [17,]  77.3         0.410      0.0769</span></span>
<span><span class="co">#&gt; [18,]  78.4         0.392      0.0723</span></span>
<span><span class="co">#&gt; [19,]  79.4         0.410      0.0721</span></span>
<span><span class="co">#&gt; [20,]  80.5         0.423      0.0714</span></span>
<span><span class="co">#&gt; [21,]  81.5         0.400      0.0666</span></span>
<span><span class="co">#&gt; [22,]  82.6         0.442      0.0685</span></span>
<span><span class="co">#&gt; [23,]  83.6         0.446      0.0676</span></span>
<span><span class="co">#&gt; [24,]  84.7         0.433      0.0643</span></span>
<span><span class="co">#&gt; [25,]  85.7         0.413      0.0612</span></span>
<span><span class="co">#&gt; [26,]  86.8         0.389      0.0578</span></span>
<span><span class="co">#&gt; [27,]  87.8         0.396      0.0578</span></span>
<span><span class="co">#&gt; [28,]  88.9         0.396      0.0573</span></span>
<span><span class="co">#&gt; [29,]  89.9         0.399      0.0574</span></span>
<span><span class="co">#&gt; [30,]  91.0         0.386      0.0556</span></span>
<span><span class="co">#&gt; [31,]  92.0         0.400      0.0570</span></span>
<span><span class="co">#&gt; [32,]  93.1         0.393      0.0560</span></span>
<span><span class="co">#&gt; [33,]  94.1         0.415      0.0590</span></span>
<span><span class="co">#&gt; [34,]  95.2         0.477      0.0669</span></span>
<span><span class="co">#&gt; [35,]  96.2         0.493      0.0690</span></span>
<span><span class="co">#&gt; [36,]  97.3         0.511      0.0714</span></span>
<span><span class="co">#&gt; [37,]  98.3         0.507      0.0708</span></span>
<span><span class="co">#&gt; [38,]  99.4         0.500      0.0699</span></span>
<span><span class="co">#&gt; [39,] 100.0         0.525      0.0739</span></span>
<span><span class="co">#&gt; [40,] 101.0         0.520      0.0731</span></span>
<span><span class="co">#&gt; [41,] 103.0         0.514      0.0723</span></span>
<span><span class="co">#&gt; [42,] 104.0         0.541      0.0767</span></span>
<span><span class="co">#&gt; [43,] 105.0         0.541      0.0767</span></span>
<span></span>
<span> <span class="fu"><a href="../reference/fast.approx.html">cpred</a></span><span class="op">(</span><span class="va">cmz</span><span class="op">$</span><span class="va">casewise</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>,<span class="fl">80</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      new.time casewise conc se casewise</span></span>
<span><span class="co">#&gt; [1,]       70     0.3381311  0.09811729</span></span>
<span><span class="co">#&gt; [2,]       80     0.4096715  0.07211013</span></span>
<span> <span class="fu"><a href="../reference/fast.approx.html">cpred</a></span><span class="op">(</span><span class="va">cdz</span><span class="op">$</span><span class="va">casewise</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>,<span class="fl">80</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      new.time casewise conc se casewise</span></span>
<span><span class="co">#&gt; [1,]       70    0.03351513  0.02398337</span></span>
<span><span class="co">#&gt; [2,]       80    0.14694869  0.03321234</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span> <span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicomprisk.html">bicompriskData</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="va">conczyg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cif.html">cif</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">dd</span>,cause<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">conczyg</span>,se<span class="op">=</span><span class="cn">TRUE</span>,legend<span class="op">=</span><span class="cn">FALSE</span>,xlab<span class="op">=</span><span class="st">"Age"</span>,ylab<span class="op">=</span><span class="st">"Concordance"</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"concordance-DZ"</span>,<span class="st">"concordance-MZ"</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cmz</span>,ci<span class="op">=</span><span class="cn">NULL</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>,<span class="fl">100</span><span class="op">)</span>,legend<span class="op">=</span><span class="cn">FALSE</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>,ylab<span class="op">=</span><span class="st">"Casewise"</span>,xlab<span class="op">=</span><span class="st">"Age"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cdz</span>,ci<span class="op">=</span><span class="cn">NULL</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>,<span class="fl">100</span><span class="op">)</span>,legend<span class="op">=</span><span class="cn">FALSE</span>,ylab<span class="op">=</span><span class="st">"Casewise"</span>,xlab<span class="op">=</span><span class="st">"Age"</span>,</span>
<span>      col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"casewise-MZ"</span>,<span class="st">"casewise-DZ"</span>,<span class="st">"marginal"</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">cmz</span><span class="op">$</span><span class="va">casewise</span><span class="op">)</span>,<span class="fu"><a href="../reference/plot.phreg.html">plotConfRegionSE</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">casewise.conc</span>,<span class="va">se.casewise</span>,col<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">cdz</span><span class="op">$</span><span class="va">casewise</span><span class="op">)</span>,<span class="fu"><a href="../reference/plot.phreg.html">plotConfRegionSE</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">casewise.conc</span>,<span class="va">se.casewise</span>,col<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/concordance3-1.png" class="r-plt" alt="" width="600px"></p>
<p>The standard errors above are slightly off since they only reflect
the uncertainty from the concordance estimation. This can be improved by
doing specific calculations for a specific time-point uisng the binomial
regression function that gives and iid decomposition for the paramters.
We thus apply the binomial regression to estimate the concordance as
well as the marginal, and combine the iid decompositions when estimating
the standard error. We also do this ignoring country differences.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co">### new version of Casewise for specific time-point based on binreg </span></span>
<span> <span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicomprisk.html">bicompriskData</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>zyg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DZ"</span>,<span class="st">"MZ"</span><span class="op">)</span>,id<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span> <span class="co">## concordance </span></span>
<span> <span class="va">bcif1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binreg.html">binreg</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,<span class="va">dd</span>,time<span class="op">=</span><span class="fl">80</span>,cause<span class="op">=</span><span class="fl">1</span>,cens.model<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="va">pconc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlogit.html">predict</a></span><span class="op">(</span><span class="va">bcif1</span>,<span class="va">newdata</span><span class="op">)</span></span>
<span></span>
<span> <span class="co">## marginal estimates</span></span>
<span> <span class="va">mbcif1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binreg.html">binreg</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,<span class="va">prt</span>,time<span class="op">=</span><span class="fl">80</span>,cause<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span> <span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlogit.html">predict</a></span><span class="op">(</span><span class="va">mbcif1</span>,<span class="va">newdata</span><span class="op">)</span></span>
<span></span>
<span> <span class="co">### casewise with improved se's from log-scale </span></span>
<span> <span class="va">cse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binregCasewise.html">binregCasewise</a></span><span class="op">(</span><span class="va">bcif1</span>,<span class="va">mbcif1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">cse</span> </span>
<span><span class="co">#&gt; $coef</span></span>
<span><span class="co">#&gt;     Estimate      2.5%     97.5%</span></span>
<span><span class="co">#&gt; p1 0.1586277 0.1445496 0.1740770</span></span>
<span><span class="co">#&gt; p2 0.4041311 0.3682646 0.4434908</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $logcoef</span></span>
<span><span class="co">#&gt;    Estimate Std.Err   2.5%   97.5%   P-value</span></span>
<span><span class="co">#&gt; p1   -1.841 0.04742 -1.934 -1.7483 0.000e+00</span></span>
<span><span class="co">#&gt; p2   -0.906 0.04742 -0.999 -0.8131 2.208e-81</span></span></code></pre></div>
<p>It can be useful also to simply model the concordance given
covariates, and in this case we might find it important to adjust for
country, or to see if the differences between MZ and DZ are comparable
across contries even though clearly DK has a much lower cumulative
incidence of prostate cancer.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co">### semi-parametric modelling of concordance </span></span>
<span> <span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicomprisk.html">bicompriskData</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span><span class="op">+</span><span class="fu">id</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">prt</span>,cause<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="va">regconc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cifreg.html">cifreg</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">*</span><span class="va">zyg</span>,data<span class="op">=</span><span class="va">dd</span>,prop<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span> <span class="va">regconc</span></span>
<span> <span class="co">### interaction test</span></span>
<span> <span class="fu"><a href="https://rdrr.io/pkg/timereg/man/wald.test.html" class="external-link">wald.test</a></span><span class="op">(</span><span class="va">regconc</span>,coef.null<span class="op">=</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">regconc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cifreg.html">cifreg</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="va">zyg</span>,data<span class="op">=</span><span class="va">dd</span>,prop<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span> <span class="va">regconc</span></span>
<span></span>
<span> <span class="co">## logistic link </span></span>
<span> <span class="va">logitregconc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cifreg.html">cifreg</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">country</span><span class="op">+</span><span class="va">zyg</span>,data<span class="op">=</span><span class="va">dd</span><span class="op">)</span></span>
<span> <span class="va">slr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">logitregconc</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      n events</span></span>
<span><span class="co">#&gt;  14222    106</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  14222 clusters</span></span>
<span><span class="co">#&gt; coeffients:</span></span>
<span><span class="co">#&gt;                Estimate    S.E. dU^-1/2 P-value</span></span>
<span><span class="co">#&gt; countryFinland  1.30427 0.35262 0.35146  0.0002</span></span>
<span><span class="co">#&gt; countryNorway   0.94077 0.39999 0.39365  0.0187</span></span>
<span><span class="co">#&gt; countrySweden   1.08494 0.32247 0.31871  0.0008</span></span>
<span><span class="co">#&gt; zygMZ           1.02335 0.20283 0.19873  0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; exp(coeffients):</span></span>
<span><span class="co">#&gt;                Estimate   2.5%  97.5%</span></span>
<span><span class="co">#&gt; countryFinland   3.6850 1.8462 7.3552</span></span>
<span><span class="co">#&gt; countryNorway    2.5619 1.1698 5.6111</span></span>
<span><span class="co">#&gt; countrySweden    2.9592 1.5729 5.5676</span></span>
<span><span class="co">#&gt; zygMZ            2.7825 1.8697 4.1408</span></span>
<span><span class="co">### library(Publish)</span></span>
<span><span class="co">### publish(round(slr$exp.coef[,-c(2,5)],2),latex=TRUE,digits=2)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="competing-risk-using-additive-gamma">Competing risk using additive Gamma<a class="anchor" aria-label="anchor" href="#competing-risk-using-additive-gamma"></a>
</h2>
<p>Here we do the cumulative incidence random effects modelling
(commented out to avoid timereg dependence)</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">timereg</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">timereg</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">90</span>,length.out<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="va">cif1</span> <span class="op">&lt;-</span> <span class="fu">timereg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/comp.risk.html" class="external-link">comp.risk</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,<span class="va">prt</span>,</span>
<span>           cause<span class="op">=</span><span class="fl">2</span>,times<span class="op">=</span><span class="va">times</span>,max.clust<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span>,<span class="va">prt</span><span class="op">)</span></span>
<span>  <span class="va">out1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/random.cif.html">random.cif</a></span><span class="op">(</span><span class="va">cif1</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">2</span>,cause2<span class="op">=</span><span class="fl">2</span>,theta<span class="op">=</span><span class="fl">1</span>,</span>
<span>          theta.des<span class="op">=</span><span class="va">mm</span>,same.cens<span class="op">=</span><span class="cn">TRUE</span>,step<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="http://kkholst.github.io/lava/reference/estimate.default.html" class="external-link">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">out1</span><span class="op">$</span><span class="va">theta</span>,vcov<span class="op">=</span><span class="va">out1</span><span class="op">$</span><span class="va">var.theta</span><span class="op">)</span><span class="op">$</span><span class="va">coefmat</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">desace</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">prt</span>,type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span></span>
<span> </span>
<span>  <span class="va">outacem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Grandom.cif.html">Grandom.cif</a></span><span class="op">(</span><span class="va">cif1</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">2</span>,cause2<span class="op">=</span><span class="fl">2</span>,</span>
<span>     same.cens<span class="op">=</span><span class="cn">TRUE</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">0.15</span><span class="op">)</span>,var.link<span class="op">=</span><span class="fl">0</span>,</span>
<span>         step<span class="op">=</span><span class="fl">0.5</span>,theta.des<span class="op">=</span><span class="va">desace</span><span class="op">$</span><span class="va">pardes</span>,random.design<span class="op">=</span><span class="va">desace</span><span class="op">$</span><span class="va">des.rv</span><span class="op">)</span></span>
<span>  <span class="co">##outacem$score</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">timereg</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">timereg</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">outacem</span><span class="op">)</span></span>
<span></span>
<span> <span class="co">###  variances</span></span>
<span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/estimate.default.html" class="external-link">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">outacem</span><span class="op">$</span><span class="va">theta</span>,vcov<span class="op">=</span><span class="va">outacem</span><span class="op">$</span><span class="va">var.theta</span>,f<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="va">p</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span> <span class="co">## AE polygenic model</span></span>
<span> <span class="co"># desae &lt;- twin.polygen.design(prt,type="ae")</span></span>
<span> <span class="co"># outaem &lt;- Grandom.cif(cif1,data=prt,cause1=2,cause2=2,</span></span>
<span> <span class="co">#    same.cens=TRUE,theta=c(0.45,0.15),var.link=0,</span></span>
<span> <span class="co">#        step=0.5,theta.des=desae$pardes,random.design=desae$des.rv)</span></span>
<span> <span class="co"># outaem$score</span></span>
<span> <span class="co"># summary(outaem)</span></span>
<span> <span class="co"># estimate(coef=outaem$theta,vcov=outaem$var.theta,f=function(p)     p/sum(p)^2)</span></span>
<span></span>
<span> <span class="co">## AE polygenic model</span></span>
<span> <span class="co"># desde &lt;- twin.polygen.design(prt,type="de")</span></span>
<span> <span class="co"># outaem &lt;- Grandom.cif(cif1,data=prt,cause1=2,cause2=2,</span></span>
<span> <span class="co">#   same.cens=TRUE,theta=c(0.35),var.link=0,</span></span>
<span> <span class="co">#   step=0.5,theta.des=desde$pardes,random.design=desde$des.rv)</span></span>
<span> <span class="co"># outaem$score</span></span>
<span> <span class="co"># summary(outaem)</span></span>
<span> <span class="co"># estimate(coef=outaem$theta,vcov=outaem$var.theta,f=function(p) p/sum(p)^2)</span></span>
<span></span>
<span>  <span class="va">times</span> <span class="op">&lt;-</span> <span class="fl">90</span></span>
<span>  <span class="va">cif1</span> <span class="op">&lt;-</span> <span class="fu">timereg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/timereg/man/comp.risk.html" class="external-link">comp.risk</a></span><span class="op">(</span><span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,<span class="va">prt</span>,</span>
<span>           cause<span class="op">=</span><span class="fl">2</span>,times<span class="op">=</span><span class="va">times</span>,max.clust<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">zyg</span><span class="op">)</span>,<span class="va">prt</span><span class="op">)</span></span>
<span>  <span class="va">out1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/random.cif.html">random.cif</a></span><span class="op">(</span><span class="va">cif1</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">2</span>,cause2<span class="op">=</span><span class="fl">2</span>,theta<span class="op">=</span><span class="fl">1</span>,</span>
<span>          theta.des<span class="op">=</span><span class="va">mm</span>,same.cens<span class="op">=</span><span class="cn">TRUE</span>,step<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="http://kkholst.github.io/lava/reference/estimate.default.html" class="external-link">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">out1</span><span class="op">$</span><span class="va">theta</span>,vcov<span class="op">=</span><span class="va">out1</span><span class="op">$</span><span class="va">var.theta</span><span class="op">)</span><span class="op">$</span><span class="va">coefmat</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">desde</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">prt</span>,type<span class="op">=</span><span class="st">"de"</span><span class="op">)</span></span>
<span> <span class="va">outaem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Grandom.cif.html">Grandom.cif</a></span><span class="op">(</span><span class="va">cif1</span>,data<span class="op">=</span><span class="va">prt</span>,cause1<span class="op">=</span><span class="fl">2</span>,cause2<span class="op">=</span><span class="fl">2</span>,</span>
<span>    same.cens<span class="op">=</span><span class="cn">TRUE</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.35</span><span class="op">)</span>,var.link<span class="op">=</span><span class="fl">0</span>,</span>
<span>        step<span class="op">=</span><span class="fl">0.5</span>,theta.des<span class="op">=</span><span class="va">desde</span><span class="op">$</span><span class="va">pardes</span>,random.design<span class="op">=</span><span class="va">desde</span><span class="op">$</span><span class="va">des.rv</span><span class="op">)</span></span>
<span> <span class="va">outaem</span><span class="op">$</span><span class="va">score</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">outaem</span><span class="op">)</span></span>
<span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/estimate.default.html" class="external-link">estimate</a></span><span class="op">(</span>coef<span class="op">=</span><span class="va">outaem</span><span class="op">$</span><span class="va">theta</span>,vcov<span class="op">=</span><span class="va">outaem</span><span class="op">$</span><span class="va">var.theta</span>,f<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="va">p</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="competing-risk-modeling-using-the-liabilty-threshold-model">Competing risk modeling using the Liabilty Threshold model<a class="anchor" aria-label="anchor" href="#competing-risk-modeling-using-the-liabilty-threshold-model"></a>
</h2>
<p>First we fit the bivariate probit model (same marginals in MZ and DZ
twins but different correlation parameter). Here we evaluate the risk of
getting cancer before the last double cancer event (95 years)</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">prt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">prt</span><span class="op">)</span></span>
<span><span class="va">prt0</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/internal.html">force.same.cens</a></span><span class="op">(</span><span class="va">prt</span>, cause<span class="op">=</span><span class="st">"status"</span>, cens.code<span class="op">=</span><span class="fl">0</span>, time<span class="op">=</span><span class="st">"time"</span>, id<span class="op">=</span><span class="st">"id"</span><span class="op">)</span></span>
<span><span class="va">prt0</span><span class="op">$</span><span class="va">country</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html" class="external-link">relevel</a></span><span class="op">(</span><span class="va">prt0</span><span class="op">$</span><span class="va">country</span>, ref<span class="op">=</span><span class="st">"Sweden"</span><span class="op">)</span></span>
<span><span class="va">prt_wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fast.reshape.html">fast.reshape</a></span><span class="op">(</span><span class="va">prt0</span>, id<span class="op">=</span><span class="st">"id"</span>, num<span class="op">=</span><span class="st">"num"</span>, varying<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>,<span class="st">"status"</span>,<span class="st">"cancer"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prt_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">prt_wide</span>,  <span class="va">cancer1</span> <span class="op">&amp;</span> <span class="va">cancer2</span>, select<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">time1</span>, <span class="va">time2</span>, <span class="va">zyg</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">95</span></span>
<span><span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">70</span>, <span class="va">tau</span>, length.out<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="co">## Time points to evaluate model in</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin.time</a></span><span class="op">(</span><span class="va">cancer</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">prt0</span>, id<span class="op">=</span><span class="st">"id"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, type<span class="op">=</span><span class="st">"cor"</span>,</span>
<span>              cens.formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">zyg</span>, breaks<span class="op">=</span><span class="va">tau</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">b0</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                Estimate   Std.Err        Z   p-value    </span></span>
<span><span class="co">#&gt; (Intercept)   -1.348188  0.026276 -51.3086 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; atanh(rho) MZ  0.735992  0.087838   8.3789 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; atanh(rho) DZ  0.353023  0.068234   5.1737 2.295e-07 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Total MZ/DZ Complete pairs MZ/DZ</span></span>
<span><span class="co">#&gt;  1994/3618   997/1809            </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Tetrachoric correlation MZ 0.62672  0.51081 0.72024</span></span>
<span><span class="co">#&gt; Tetrachoric correlation DZ 0.33905  0.21584 0.45164</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MZ:</span></span>
<span><span class="co">#&gt;                      Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Concordance          0.03504  0.02779 0.04409</span></span>
<span><span class="co">#&gt; Casewise Concordance 0.39458  0.31876 0.47584</span></span>
<span><span class="co">#&gt; Marginal             0.08880  0.08086 0.09743</span></span>
<span><span class="co">#&gt; Rel.Recur.Risk       4.44351  3.50521 5.38182</span></span>
<span><span class="co">#&gt; log(OR)              2.34131  1.87105 2.81157</span></span>
<span><span class="co">#&gt; DZ:</span></span>
<span><span class="co">#&gt;                      Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Concordance          0.01952  0.01449 0.02625</span></span>
<span><span class="co">#&gt; Casewise Concordance 0.21983  0.16667 0.28415</span></span>
<span><span class="co">#&gt; Marginal             0.08880  0.08086 0.09743</span></span>
<span><span class="co">#&gt; Rel.Recur.Risk       2.47556  1.81095 3.14016</span></span>
<span><span class="co">#&gt; log(OR)              1.23088  0.81020 1.65156</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Broad-sense heritability 0.57533  0.25790 0.89276</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Event of interest before time 95</span></span></code></pre></div>
<p>Liability threshold model with ACE random effects structure</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin.time</a></span><span class="op">(</span><span class="va">cancer</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">prt0</span>, id<span class="op">=</span><span class="st">"id"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, type<span class="op">=</span><span class="st">"ace"</span>,</span>
<span>              cens.formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">zyg</span>, breaks<span class="op">=</span><span class="va">tau</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">b1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Estimate  Std.Err        Z p-value    </span></span>
<span><span class="co">#&gt; (Intercept) -2.20664  0.16463 -13.4034  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; log(var(A))  0.43260  0.39149   1.1050  0.2691    </span></span>
<span><span class="co">#&gt; log(var(C)) -1.98290  2.52343  -0.7858  0.4320    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Total MZ/DZ Complete pairs MZ/DZ</span></span>
<span><span class="co">#&gt;  1994/3618   997/1809            </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                    Estimate 2.5%     97.5%   </span></span>
<span><span class="co">#&gt; A                   0.57533  0.25790  0.89276</span></span>
<span><span class="co">#&gt; C                   0.05139 -0.20836  0.31114</span></span>
<span><span class="co">#&gt; E                   0.37328  0.26874  0.47782</span></span>
<span><span class="co">#&gt; MZ Tetrachoric Cor  0.62672  0.51081  0.72024</span></span>
<span><span class="co">#&gt; DZ Tetrachoric Cor  0.33905  0.21584  0.45164</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MZ:</span></span>
<span><span class="co">#&gt;                      Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Concordance          0.03504  0.02779 0.04409</span></span>
<span><span class="co">#&gt; Casewise Concordance 0.39458  0.31876 0.47584</span></span>
<span><span class="co">#&gt; Marginal             0.08880  0.08086 0.09743</span></span>
<span><span class="co">#&gt; Rel.Recur.Risk       4.44351  3.50521 5.38182</span></span>
<span><span class="co">#&gt; log(OR)              2.34131  1.87105 2.81157</span></span>
<span><span class="co">#&gt; DZ:</span></span>
<span><span class="co">#&gt;                      Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Concordance          0.01952  0.01449 0.02625</span></span>
<span><span class="co">#&gt; Casewise Concordance 0.21983  0.16667 0.28415</span></span>
<span><span class="co">#&gt; Marginal             0.08880  0.08086 0.09743</span></span>
<span><span class="co">#&gt; Rel.Recur.Risk       2.47556  1.81096 3.14017</span></span>
<span><span class="co">#&gt; log(OR)              1.23088  0.81020 1.65156</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Broad-sense heritability 0.57533  0.25790 0.89276</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Event of interest before time 95</span></span></code></pre></div>
<p>In this case the ACE model fits the data well - it is in fact
indistinguishable from the flexible bivariate Probit model as seen by
the IPCW weighted AIC measure</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">b0</span>, <span class="va">b1</span><span class="op">)</span></span>
<span><span class="co">#&gt;    df AIC</span></span>
<span><span class="co">#&gt; b0  3   6</span></span>
<span><span class="co">#&gt; b1  3   6</span></span></code></pre></div>
<p>ACE model with marginal adjusted for country</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin.time</a></span><span class="op">(</span><span class="va">cancer</span> <span class="op">~</span> <span class="va">country</span>, data<span class="op">=</span><span class="va">prt0</span>, id<span class="op">=</span><span class="st">"id"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, type<span class="op">=</span><span class="st">"ace"</span>,</span>
<span>              cens.formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">zyg</span><span class="op">+</span><span class="va">country</span>, breaks<span class="op">=</span><span class="fl">95</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">b2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                Estimate  Std.Err        Z   p-value    </span></span>
<span><span class="co">#&gt; (Intercept)    -1.97165  0.15371 -12.8267 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; countryDenmark -0.72489  0.11920  -6.0812 1.193e-09 ***</span></span>
<span><span class="co">#&gt; countryFinland  0.18968  0.12518   1.5152    0.1297    </span></span>
<span><span class="co">#&gt; countryNorway  -0.11611  0.16621  -0.6986    0.4848    </span></span>
<span><span class="co">#&gt; log(var(A))     0.40388  0.40524   0.9966    0.3189    </span></span>
<span><span class="co">#&gt; log(var(C))    -3.88761 17.56413  -0.2213    0.8248    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Total MZ/DZ Complete pairs MZ/DZ</span></span>
<span><span class="co">#&gt;  1994/3618   997/1809            </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                    Estimate 2.5%     97.5%   </span></span>
<span><span class="co">#&gt; A                   0.59474  0.25169  0.93779</span></span>
<span><span class="co">#&gt; C                   0.00814 -0.27297  0.28925</span></span>
<span><span class="co">#&gt; E                   0.39712  0.28435  0.50989</span></span>
<span><span class="co">#&gt; MZ Tetrachoric Cor  0.60288  0.47809  0.70381</span></span>
<span><span class="co">#&gt; DZ Tetrachoric Cor  0.30551  0.17238  0.42767</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MZ:</span></span>
<span><span class="co">#&gt;                      Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Concordance          0.04295  0.03307 0.05561</span></span>
<span><span class="co">#&gt; Casewise Concordance 0.40128  0.32263 0.48535</span></span>
<span><span class="co">#&gt; Marginal             0.10703  0.09453 0.12096</span></span>
<span><span class="co">#&gt; Rel.Recur.Risk       3.74923  2.94156 4.55691</span></span>
<span><span class="co">#&gt; log(OR)              2.15979  1.67935 2.64023</span></span>
<span><span class="co">#&gt; DZ:</span></span>
<span><span class="co">#&gt;                      Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Concordance          0.02439  0.01747 0.03396</span></span>
<span><span class="co">#&gt; Casewise Concordance 0.22788  0.17060 0.29749</span></span>
<span><span class="co">#&gt; Marginal             0.10703  0.09453 0.12096</span></span>
<span><span class="co">#&gt; Rel.Recur.Risk       2.12912  1.54508 2.71315</span></span>
<span><span class="co">#&gt; log(OR)              1.06262  0.62460 1.50064</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          Estimate 2.5%    97.5%  </span></span>
<span><span class="co">#&gt; Broad-sense heritability 0.59474  0.25169 0.93779</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Event of interest before time 95</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin.time</a></span><span class="op">(</span><span class="va">cancer</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">prt0</span>, id<span class="op">=</span><span class="st">"id"</span>, zyg<span class="op">=</span><span class="st">"zyg"</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, type<span class="op">=</span><span class="st">"ace"</span>, </span>
<span>              cens.formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">zyg</span>,</span>
<span>              summary.function<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span>, breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span></span>
<span><span class="va">h2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">bt0</span><span class="op">$</span><span class="va">coef</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">heritability</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span></span>
<span><span class="va">concMZ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">bt0</span><span class="op">$</span><span class="va">coef</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">probMZ</span><span class="op">[</span><span class="st">"Concordance"</span>,,drop<span class="op">=</span><span class="cn">TRUE</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tt</span>, <span class="va">h2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"s"</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylab<span class="op">=</span><span class="st">"Heritability"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">lava</span><span class="fu">::</span><span class="fu"><a href="http://kkholst.github.io/lava/reference/confband.html" class="external-link">confband</a></span><span class="op">(</span><span class="va">tt</span>, <span class="va">h2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">h2</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,polygon<span class="op">=</span><span class="cn">TRUE</span>, step<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fu">lava</span><span class="fu">::</span><span class="fu"><a href="http://kkholst.github.io/lava/reference/Col.html" class="external-link">Col</a></span><span class="op">(</span><span class="va">cols</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">0.1</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tt</span>, <span class="va">concMZ</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"s"</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylab<span class="op">=</span><span class="st">"Concordance"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">lava</span><span class="fu">::</span><span class="fu"><a href="http://kkholst.github.io/lava/reference/confband.html" class="external-link">confband</a></span><span class="op">(</span><span class="va">tt</span>, <span class="va">concMZ</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">concMZ</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,polygon<span class="op">=</span><span class="cn">TRUE</span>, step<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="fu">lava</span><span class="fu">::</span><span class="fu"><a href="http://kkholst.github.io/lava/reference/Col.html" class="external-link">Col</a></span><span class="op">(</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">0.1</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/unnamed-chunk-17-1.png" class="r-plt" alt="" width="600px"></p>
<p>Bivariate probit model at time different time points</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">a.mz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biprobit.html">biprobit.time</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">~</span><span class="fl">1</span>, id<span class="op">=</span><span class="st">"id"</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">prt0</span>, <span class="va">zyg</span><span class="op">==</span><span class="st">"MZ"</span><span class="op">)</span>,</span>
<span>                               cens.formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, pairs.only<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.288   0.279   0.238</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">a.dz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biprobit.html">biprobit.time</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">~</span><span class="fl">1</span>, id<span class="op">=</span><span class="st">"id"</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">prt0</span>, <span class="va">zyg</span><span class="op">==</span><span class="st">"DZ"</span><span class="op">)</span>,</span>
<span>                               cens.formula <span class="op">=</span> <span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, pairs.only<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                               breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.402   0.281   0.355</span></span>
<span></span>
<span><span class="co">#system.time(a.zyg &lt;- biprobit.time(cancer~1, rho=~1+zyg, id="id", data=prt, </span></span>
<span><span class="co">#                               cens.formula = Event(time,status==0)~1,</span></span>
<span><span class="co">#                               eqmarg=FALSE, fix.cens.weight</span></span>
<span><span class="co">#                               breaks=seq(75,100,by=10)))</span></span>
<span></span>
<span><span class="va">a.mz</span></span>
<span><span class="co">#&gt;                           </span></span>
<span><span class="co">#&gt;  1:Concordance            </span></span>
<span><span class="co">#&gt;  2:Casewise Concordance   </span></span>
<span><span class="co">#&gt;  3:Marginal               </span></span>
<span><span class="co">#&gt;  4:Rel.Recur.Risk         </span></span>
<span><span class="co">#&gt;  5:OR                     </span></span>
<span><span class="co">#&gt;  6:Tetrachoric correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Time 1:Concor... 2:Casewi... 3:Marginal 4:Rel.Re...    5:OR 6:Tetrac...</span></span>
<span><span class="co">#&gt; [1,] 70.00      0.0049      0.2976     0.0166     17.9645 35.3860      0.6973</span></span>
<span><span class="co">#&gt; [2,] 76.25      0.0125      0.3468     0.0362      9.5939 21.1447      0.6834</span></span>
<span><span class="co">#&gt; [3,] 82.50      0.0247      0.3759     0.0656      5.7307 13.1452      0.6481</span></span>
<span><span class="co">#&gt; [4,] 88.75      0.0308      0.3675     0.0839      4.3780  9.4430      0.5993</span></span>
<span><span class="co">#&gt; [5,] 95.00      0.0409      0.4144     0.0988      4.1952 10.3179      0.6352</span></span>
<span><span class="va">a.dz</span></span>
<span><span class="co">#&gt;                           </span></span>
<span><span class="co">#&gt;  1:Concordance            </span></span>
<span><span class="co">#&gt;  2:Casewise Concordance   </span></span>
<span><span class="co">#&gt;  3:Marginal               </span></span>
<span><span class="co">#&gt;  4:Rel.Recur.Risk         </span></span>
<span><span class="co">#&gt;  5:OR                     </span></span>
<span><span class="co">#&gt;  6:Tetrachoric correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Time 1:Concor... 2:Casewi... 3:Marginal 4:Rel.Re...   5:OR 6:Tetrac...</span></span>
<span><span class="co">#&gt; [1,] 70.00      0.0007      0.0767     0.0088      8.6699 9.9965      0.3855</span></span>
<span><span class="co">#&gt; [2,] 76.25      0.0037      0.1612     0.0228      7.0632 9.6179      0.4682</span></span>
<span><span class="co">#&gt; [3,] 82.50      0.0074      0.1660     0.0445      3.7328 4.9289      0.3752</span></span>
<span><span class="co">#&gt; [4,] 88.75      0.0136      0.2001     0.0680      2.9417 4.0347      0.3614</span></span>
<span><span class="co">#&gt; [5,] 95.00      0.0174      0.2091     0.0831      2.5163 3.4242      0.3335</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">conczyg</span>,se<span class="op">=</span><span class="cn">TRUE</span>,legend<span class="op">=</span><span class="cn">FALSE</span>,xlab<span class="op">=</span><span class="st">"Age"</span>,ylab<span class="op">=</span><span class="st">"Concordance"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.07</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a.mz</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.07</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, legend<span class="op">=</span><span class="cn">FALSE</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a.dz</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/biprobittime1-1.png" class="r-plt" alt="" width="600px"></p>
<p>Bivariate probit model adjusting for country</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a.mz_country</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biprobit.html">biprobit.time</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">~</span><span class="va">country</span>, id<span class="op">=</span><span class="st">"id"</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">prt0</span>, <span class="va">zyg</span><span class="op">==</span><span class="st">"MZ"</span><span class="op">)</span>,</span>
<span>                               cens.formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">country</span>, pairs.only<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">a.dz_country</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biprobit.html">biprobit.time</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">~</span><span class="va">country</span>, id<span class="op">=</span><span class="st">"id"</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">prt0</span>, <span class="va">zyg</span><span class="op">==</span><span class="st">"DZ"</span><span class="op">)</span>,</span>
<span>                               cens.formula <span class="op">=</span> <span class="fu"><a href="../reference/Event.html">Event</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">country</span>, pairs.only<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                               breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s_mz_country</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">a.mz_country</span><span class="op">)</span></span>
<span><span class="va">s_dz_country</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">a.dz_country</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_mz_country</span></span>
<span><span class="co">#&gt; $Concordance</span></span>
<span><span class="co">#&gt;    Time    Estimate        2.5%      97.5%</span></span>
<span><span class="co">#&gt; 1 70.00 0.005921119 0.002986156 0.01170686</span></span>
<span><span class="co">#&gt; 2 76.25 0.014322088 0.008753641 0.02334935</span></span>
<span><span class="co">#&gt; 3 82.50 0.029210106 0.020110767 0.04224903</span></span>
<span><span class="co">#&gt; 4 88.75 0.040377886 0.029107601 0.05576133</span></span>
<span><span class="co">#&gt; 5 95.00 0.049707538 0.035563146 0.06907461</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Casewise Concordance`</span></span>
<span><span class="co">#&gt;    Time  Estimate      2.5%     97.5%</span></span>
<span><span class="co">#&gt; 1 70.00 0.3061371 0.1804979 0.4691630</span></span>
<span><span class="co">#&gt; 2 76.25 0.3502181 0.2491875 0.4667465</span></span>
<span><span class="co">#&gt; 3 82.50 0.3867062 0.3017293 0.4791916</span></span>
<span><span class="co">#&gt; 4 88.75 0.3906921 0.3129417 0.4744209</span></span>
<span><span class="co">#&gt; 5 95.00 0.4190261 0.3369792 0.5058097</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Marginal</span></span>
<span><span class="co">#&gt;    Time   Estimate       2.5%      97.5%</span></span>
<span><span class="co">#&gt; 1 70.00 0.01934140 0.01265755 0.02944940</span></span>
<span><span class="co">#&gt; 2 76.25 0.04089476 0.02990124 0.05569812</span></span>
<span><span class="co">#&gt; 3 82.50 0.07553566 0.05950394 0.09544834</span></span>
<span><span class="co">#&gt; 4 88.75 0.10334964 0.08432130 0.12608075</span></span>
<span><span class="co">#&gt; 5 95.00 0.11862636 0.09701847 0.14427781</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Rel.Recur.Risk</span></span>
<span><span class="co">#&gt;    Time  Estimate     2.5%     97.5%</span></span>
<span><span class="co">#&gt; 1 70.00 15.828074 6.402374 25.253774</span></span>
<span><span class="co">#&gt; 2 76.25  8.563886 5.232398 11.895375</span></span>
<span><span class="co">#&gt; 3 82.50  5.119518 3.659925  6.579110</span></span>
<span><span class="co">#&gt; 4 88.75  3.780295 2.838451  4.722138</span></span>
<span><span class="co">#&gt; 5 95.00  3.532318 2.733224  4.331412</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $OR</span></span>
<span><span class="co">#&gt;    Time  Estimate      2.5%    97.5%</span></span>
<span><span class="co">#&gt; 1 70.00 31.799055 12.251068 82.53810</span></span>
<span><span class="co">#&gt; 2 76.25 18.914711  9.701256 36.87835</span></span>
<span><span class="co">#&gt; 3 82.50 11.952397  7.033118 20.31244</span></span>
<span><span class="co">#&gt; 4 88.75  8.488885  5.238209 13.75683</span></span>
<span><span class="co">#&gt; 5 95.00  8.502483  5.276008 13.70207</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Tetrachoric correlation`</span></span>
<span><span class="co">#&gt;    Time  Estimate      2.5%     97.5%</span></span>
<span><span class="co">#&gt; 1 70.00 0.6943823 0.4989166 0.8226225</span></span>
<span><span class="co">#&gt; 2 76.25 0.6744434 0.5302710 0.7807066</span></span>
<span><span class="co">#&gt; 3 82.50 0.6416812 0.5173782 0.7394660</span></span>
<span><span class="co">#&gt; 4 88.75 0.5945675 0.4712828 0.6950631</span></span>
<span><span class="co">#&gt; 5 95.00 0.6079229 0.4838930 0.7080114</span></span>
<span><span class="va">s_dz_country</span></span>
<span><span class="co">#&gt; $Concordance</span></span>
<span><span class="co">#&gt;    Time     Estimate         2.5%       97.5%</span></span>
<span><span class="co">#&gt; 1 70.00 0.0009355048 0.0003014643 0.002899194</span></span>
<span><span class="co">#&gt; 2 76.25 0.0053848911 0.0030067721 0.009625755</span></span>
<span><span class="co">#&gt; 3 82.50 0.0090012330 0.0055138848 0.014661695</span></span>
<span><span class="co">#&gt; 4 88.75 0.0172555605 0.0117010082 0.025379187</span></span>
<span><span class="co">#&gt; 5 95.00 0.0221107866 0.0153703841 0.031711870</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Casewise Concordance`</span></span>
<span><span class="co">#&gt;    Time   Estimate      2.5%     97.5%</span></span>
<span><span class="co">#&gt; 1 70.00 0.08242727 0.0282508 0.2172686</span></span>
<span><span class="co">#&gt; 2 76.25 0.17830235 0.1097646 0.2763507</span></span>
<span><span class="co">#&gt; 3 82.50 0.16491567 0.1103378 0.2392308</span></span>
<span><span class="co">#&gt; 4 88.75 0.20763649 0.1517489 0.2773763</span></span>
<span><span class="co">#&gt; 5 95.00 0.21840901 0.1627051 0.2866548</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Marginal</span></span>
<span><span class="co">#&gt;    Time   Estimate        2.5%      97.5%</span></span>
<span><span class="co">#&gt; 1 70.00 0.01134946 0.007572602 0.01697780</span></span>
<span><span class="co">#&gt; 2 76.25 0.03020090 0.022824941 0.03986318</span></span>
<span><span class="co">#&gt; 3 82.50 0.05458082 0.044179949 0.06725798</span></span>
<span><span class="co">#&gt; 4 88.75 0.08310466 0.069910511 0.09852516</span></span>
<span><span class="co">#&gt; 5 95.00 0.10123569 0.086502805 0.11815328</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Rel.Recur.Risk</span></span>
<span><span class="co">#&gt;    Time Estimate       2.5%     97.5%</span></span>
<span><span class="co">#&gt; 1 70.00 7.262662 -0.6527461 15.178071</span></span>
<span><span class="co">#&gt; 2 76.25 5.903876  2.9616475  8.846104</span></span>
<span><span class="co">#&gt; 3 82.50 3.021495  1.8476374  4.195352</span></span>
<span><span class="co">#&gt; 4 88.75 2.498494  1.7411952  3.255792</span></span>
<span><span class="co">#&gt; 5 95.00 2.157431  1.5524847  2.762377</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $OR</span></span>
<span><span class="co">#&gt;    Time Estimate     2.5%     97.5%</span></span>
<span><span class="co">#&gt; 1 70.00 8.438374 2.374773 29.984401</span></span>
<span><span class="co">#&gt; 2 76.25 8.262989 4.176810 16.346681</span></span>
<span><span class="co">#&gt; 3 82.50 3.898758 2.289207  6.639992</span></span>
<span><span class="co">#&gt; 4 88.75 3.386745 2.150865  5.332756</span></span>
<span><span class="co">#&gt; 5 95.00 2.894681 1.876189  4.466063</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Tetrachoric correlation`</span></span>
<span><span class="co">#&gt;    Time  Estimate      2.5%     97.5%</span></span>
<span><span class="co">#&gt; 1 70.00 0.3735045 0.1024582 0.5929219</span></span>
<span><span class="co">#&gt; 2 76.25 0.4623453 0.2958921 0.6015477</span></span>
<span><span class="co">#&gt; 3 82.50 0.3333246 0.1903659 0.4624401</span></span>
<span><span class="co">#&gt; 4 88.75 0.3304659 0.1996083 0.4497427</span></span>
<span><span class="co">#&gt; 5 95.00 0.3013345 0.1715485 0.4208396</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## ACE model (time-varying) with and without adjustment for country</span></span>
<span><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bptwin.html">bptwin.time</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">~</span><span class="fl">1</span>, id<span class="op">=</span><span class="st">"id"</span>, data<span class="op">=</span><span class="va">prt0</span>, type<span class="op">=</span><span class="st">"ace"</span>,</span>
<span>                              zyg<span class="op">=</span><span class="st">"zyg"</span>, DZ<span class="op">=</span><span class="st">"DZ"</span>, </span>
<span>                              cens.formula<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">~</span><span class="va">zyg</span>,</span>
<span>                              breaks<span class="op">=</span><span class="va">tt</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#a2 &lt;- bptwin.time(cancer~country, id="id", data=prt0, #type="ace",</span></span>
<span><span class="co">#                              zyg="zyg", DZ="DZ", </span></span>
<span><span class="co">#                              #cens.formula=Surv(time,status==0)~country+zyg,</span></span>
<span><span class="co">#                              breaks=tt)</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a.mz</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylab<span class="op">=</span><span class="st">"Correlation"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, legend<span class="op">=</span><span class="cn">NULL</span>, alpha<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a.dz</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, legend<span class="op">=</span><span class="cn">NULL</span>, add<span class="op">=</span><span class="cn">TRUE</span>, alpha<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MZ tetrachoric correlation"</span>, <span class="st">"DZ tetrachoric correlation"</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="va">cols</span>, lty<span class="op">=</span><span class="va">ltys</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/unnamed-chunk-19-1.png" class="r-plt" alt="" width="600px"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a.mz</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylab<span class="op">=</span><span class="st">"Relative Recurrence Risk"</span>,</span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">20</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, legend<span class="op">=</span><span class="cn">NULL</span>, lwd<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a.dz</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, legend<span class="op">=</span><span class="cn">NULL</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MZ relative recurrence risk"</span>, <span class="st">"DZ relative recurrence risk"</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="va">cols</span>, lty<span class="op">=</span><span class="va">ltys</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/unnamed-chunk-19-2.png" class="r-plt" alt="" width="600px"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a1</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylab<span class="op">=</span><span class="st">"Correlation"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, lty<span class="op">=</span><span class="va">ltys</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>     legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MZ tetrachoric correlation"</span>, <span class="st">"DZ tetrachoric correlation"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/unnamed-chunk-19-3.png" class="r-plt" alt="" width="600px"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a1</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"black"</span>, lty<span class="op">=</span><span class="fl">1</span>, ylab<span class="op">=</span><span class="st">"Heritability"</span>, legend<span class="op">=</span><span class="cn">NULL</span>, alpha<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="time-to-event-family-studies-arev_files/figure-html/unnamed-chunk-19-4.png" class="r-plt" alt="" width="600px"></p>
</div>
<div class="section level2">
<h2 id="sessioninfo">SessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] prodlim_2025.04.28 mets_1.3.9        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] Matrix_1.7-4           future.apply_1.20.1    jsonlite_2.0.0        </span></span>
<span><span class="co">#&gt;  [4] compiler_4.5.2         Rcpp_1.1.1             parallel_4.5.2        </span></span>
<span><span class="co">#&gt;  [7] jquerylib_0.1.4        globals_0.18.0         splines_4.5.2         </span></span>
<span><span class="co">#&gt; [10] systemfonts_1.3.1      textshaping_1.0.4      yaml_2.3.12           </span></span>
<span><span class="co">#&gt; [13] fastmap_1.2.0          lattice_0.22-7         R6_2.6.1              </span></span>
<span><span class="co">#&gt; [16] knitr_1.51             htmlwidgets_1.6.4      future_1.68.0         </span></span>
<span><span class="co">#&gt; [19] desc_1.4.3             bslib_0.9.0            rlang_1.1.7           </span></span>
<span><span class="co">#&gt; [22] cachem_1.1.0           xfun_0.55              fs_1.6.6              </span></span>
<span><span class="co">#&gt; [25] sass_0.4.10            cli_3.6.5              pkgdown_2.2.0         </span></span>
<span><span class="co">#&gt; [28] digest_0.6.39          grid_4.5.2             mvtnorm_1.3-3         </span></span>
<span><span class="co">#&gt; [31] lifecycle_1.0.5        lava_1.8.2             RcppArmadillo_15.2.3-1</span></span>
<span><span class="co">#&gt; [34] timereg_2.0.7          evaluate_1.0.5         data.table_1.18.0     </span></span>
<span><span class="co">#&gt; [37] numDeriv_2016.8-1.1    listenv_0.10.0         codetools_0.2-20      </span></span>
<span><span class="co">#&gt; [40] ragg_1.5.0             survival_3.8-3         parallelly_1.46.1     </span></span>
<span><span class="co">#&gt; [43] rmarkdown_2.30         tools_4.5.2            htmltools_0.5.9</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>

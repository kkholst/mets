<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysis of multivariate survival data • mets</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of multivariate survival data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/basic-dutils.html">dUtility data-frame manipulations</a></li>
    <li><a class="dropdown-item" href="../articles/binomial-family.html">Analysis of multivariate binomial data: family analysis</a></li>
    <li><a class="dropdown-item" href="../articles/binomial-twin.html">Analysis of bivariate binomial data: Twin analysis</a></li>
    <li><a class="dropdown-item" href="../articles/binreg-ate.html">Average treatment effect (ATE) for Competing risks and binary outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/binreg-TRS.html">Two-Stage Randomization for for Competing risks and Survival outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/binreg.html">Binomial Regression for Survival and Competing Risks Data</a></li>
    <li><a class="dropdown-item" href="../articles/cifreg.html">Cumulative Incidence Regression</a></li>
    <li><a class="dropdown-item" href="../articles/cooking-survival-data.html">WIP: Cooking survival data, 5 minute recipes</a></li>
    <li><a class="dropdown-item" href="../articles/cumulative-cost.html">IPCW Cumulative Cost</a></li>
    <li><a class="dropdown-item" href="../articles/glm-utility.html">GEE cluster standard errors and predictions for glm objects</a></li>
    <li><a class="dropdown-item" href="../articles/haplo-discrete-ttp.html">Haplotype Discrete Survival Models</a></li>
    <li><a class="dropdown-item" href="../articles/interval-discrete-survival.html">Discrete Interval Censored Survival Models</a></li>
    <li><a class="dropdown-item" href="../articles/marginal-cox.html">Marginal modelling of clustered survival data</a></li>
    <li><a class="dropdown-item" href="../articles/mediation-survival.html">Mediation Analysis for survival data</a></li>
    <li><a class="dropdown-item" href="../articles/phreg_rct.html">Randomization for Cox Type rate models </a></li>
    <li><a class="dropdown-item" href="../articles/quantitative-twin.html">Twin models</a></li>
    <li><a class="dropdown-item" href="../articles/recurrent-events.html">Recurrent events</a></li>
    <li><a class="dropdown-item" href="../articles/rmst-ate.html">Average treatment effect (ATE) for Restricted mean survival and years lost of Competing risks</a></li>
    <li><a class="dropdown-item" href="../articles/survival-ate.html">G-Computation or standardization for the Cox, Fine-Gray and binomial regression models for survival data</a></li>
    <li><a class="dropdown-item" href="../articles/time-to-event-family-studies-arev.html">A practical guide to Human Genetics with Lifetime Data</a></li>
    <li><a class="dropdown-item" href="../articles/twostage-survival.html">Analysis of multivariate survival data</a></li>
    <li><a class="dropdown-item" href="../articles/while-alive.html">While Alive estimands for Recurrent Events</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kkholst/mets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analysis of multivariate survival data</h1>
                        <h4 data-toc-skip class="author">Klaus Holst
&amp; Thomas Scheike</h4>
            
            <h4 data-toc-skip class="date">2026-01-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kkholst/mets/blob/main/vignettes/twostage-survival.Rmd" class="external-link"><code>vignettes/twostage-survival.Rmd</code></a></small>
      <div class="d-none name"><code>twostage-survival.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>When looking at multivariate survival data with the aim of learning
about the dependence that is present, possibly after correcting for some
covariates different approaches are available in the mets package</p>
<ul>
<li>Binary models and adjust for censoring with inverse probabilty of
censoring weighting
<ul>
<li>biprobit model</li>
</ul>
</li>
<li>Bivariate surival models of Clayton-Oakes type
<ul>
<li>With regression structure on dependence parameter</li>
<li>With additive gamma distributed random effects</li>
<li>Special functionality for polygenic random effects modelling such as
ACE, ADE ,AE and so forth.</li>
</ul>
</li>
<li>Plackett OR model model
<ul>
<li>With regression structure on OR dependence parameter</li>
</ul>
</li>
<li>Cluster stratified Cox</li>
</ul>
<p>Typically it can be hard or impossible to specify random effects
models with special structure among the parameters of the random
effects. This is possible for our specification of the random effects
models.</p>
<p>To be concrete about the model structure assume that we have paired
survival data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><msub><mi>δ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo>,</mo><msub><mi>δ</mi><mn>2</mn></msub><mo>,</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(T_1, \delta_1, T_2, \delta_2,  X_1, X_2)</annotation></semantics></math>
where the censored survival responses are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><msub><mi>δ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>T</mi><mn>2</mn></msub><mo>,</mo><msub><mi>δ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(T_1, \delta_1, T_2, \delta_2)</annotation></semantics></math>
and the covariates are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(X_1, X_2)</annotation></semantics></math>.</p>
<p>The basic models assumes that each subject has a marginal on Cox-form
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>,</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>X</mi><mrow><mi>k</mi><mi>i</mi></mrow><mi>T</mi></msubsup><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> 
\lambda_{s(k,i)}(t) \exp( X_{ki}^T \beta)
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>,</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">s(k,i)</annotation></semantics></math>
is a strata variable.</p>
<p>The constructed likelihood is a composite likehood based on</p>
<ul>
<li><p>all pairs within each cluster (when the pairs argument is not
used)</p></li>
<li><p>the specified pairs when the pairs argument is used.</p></li>
</ul>
<p>In addition to the clusters specified for the construction of the
composite likelihood these can be added further summed using the
se.clusters argument that sums the influence functions over the
se.clusters. When se.clusters are not specified it is the same as the
cluster argument.</p>
<p>When the clusters of the dependence parametaters are the same as
those of the marginal model and the phreg function is used then the
standard errors are corrected for the uncertainty from the marginal
models, otherwise the returned standard errors are computed as if the
marginals are known.</p>
</div>
<div class="section level2">
<h2 id="gamma-distributed-frailties">Gamma distributed frailties<a class="anchor" aria-label="anchor" href="#gamma-distributed-frailties"></a>
</h2>
<p>The focus of this vignette is describe how to work on bivariate
survival data using the addtive gamma-random effects models. We present
two different ways of specifying different dependence structures.</p>
<ul>
<li><p>Univariate models with a single random effect for each cluster
and with a regression design on the variance.</p></li>
<li><p>Multivariate models with multiple random effects for each
cluster.</p></li>
</ul>
<p>The univariate models are then given a given cluster random effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mi>k</mi></msub><annotation encoding="application/x-tex">Z_k</annotation></semantics></math>
with parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
the joint survival function is given by the Clayton copula and on the
form
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ψ</mi><mo stretchy="false" form="prefix">(</mo><mi>θ</mi><mo>,</mo><msup><mi>ψ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>,</mo><msub><mi>S</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><msub><mi>X</mi><mrow><mi>k</mi><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msup><mi>ψ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>,</mo><msub><mi>S</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><msub><mi>X</mi><mrow><mi>k</mi><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> 
  \psi(\theta, \psi^{-1}(\theta,S_1(t,X_{k1}) ) + \psi^{-1}(\theta, S_1(t,X_{k1}) ) 
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
is the Laplace transform of a gamma distributed random variable with
mean 1 and variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p>
<p>We then model the variance within clusters by a cluster specific
regression design such that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>z</mi><mi>j</mi><mi>T</mi></msubsup><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> 
  \theta = h(z_j^T \alpha)
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
is the regression design (specified by theta.des in the software), and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
is link function, that is either
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">exp</annotation></semantics></math>
or the identity.</p>
<p>This model can be fitted using a pairwise likelihood or the
pseudo-likelihood using either</p>
<ul>
<li><p>twostage</p></li>
<li><p>twostageMLE</p></li>
</ul>
<p>To make the twostage approach possible we need a model with specific
structure for the marginals. Therefore given the random effect of the
clusters the survival distributions within a cluster are independent and
on the form
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>j</mi></msub><mo>&gt;</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>j</mi></msub><mo>,</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>Z</mi><mo>⋅</mo><msup><mi>Ψ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ν</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> 
 P(T_j &gt; t| X_j,Z) = exp( -Z \cdot \Psi^{-1}(\nu^{-1},S(t|X_j)) )  
</annotation></semantics></math> with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ψ</mi><annotation encoding="application/x-tex">\Psi</annotation></semantics></math>
the laplace of the gamma distribution with mean 1 and variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mi>ν</mi></mrow><annotation encoding="application/x-tex">1/\nu</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="additive-gamma-frailties">Additive Gamma frailties<a class="anchor" aria-label="anchor" href="#additive-gamma-frailties"></a>
</h2>
<p>For the multivariate models we are given a multivarite random effect
each cluster
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>Z</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z=(Z_1,...,Z_d)</annotation></semantics></math>
with d random effects. The total random effect for each subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
in a cluster is then specified using a regression design on these random
effects, with a regression vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mi>j</mi></msub><annotation encoding="application/x-tex">V_j</annotation></semantics></math>
such that the total random effect is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><mi>j</mi><mi>T</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>Z</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">V_j^T (Z_1,...,Z_d)</annotation></semantics></math>.
The elements of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mi>J</mi></msub><annotation encoding="application/x-tex">V_J</annotation></semantics></math>
are 1/0. The random effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>Z</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(Z_1,...,Z_d)</annotation></semantics></math>
has associated parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>λ</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\lambda_1,...,\lambda_d)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mi>j</mi></msub><annotation encoding="application/x-tex">Z_j</annotation></semantics></math>
is Gamma distributed with</p>
<ul>
<li><p>mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>j</mi></msub><mi>/</mi><msubsup><mi>V</mi><mn>1</mn><mi>T</mi></msubsup><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda_j/V_1^T \lambda</annotation></semantics></math></p></li>
<li><p>variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>j</mi></msub><mi>/</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>V</mi><mn>1</mn><mi>T</mi></msubsup><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\lambda_j/(V_1^T \lambda)^2</annotation></semantics></math></p></li>
</ul>
<p>The key assumption to make the two-stage fitting possible is that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>ν</mi><mo>=</mo><msubsup><mi>V</mi><mi>j</mi><mi>T</mi></msubsup><mi>λ</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
   \nu =V_j^T \lambda
\end{align*}</annotation></semantics></math> is constant within
clusters. The consequence of this is that the total random effect for
each subject within a cluster,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><mi>j</mi><mi>T</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>Z</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">V_j^T (Z_1,...,Z_d)</annotation></semantics></math>,
is gamma distributed with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mi>ν</mi></mrow><annotation encoding="application/x-tex">1/\nu</annotation></semantics></math>.</p>
<p>The DEFAULT parametrization (var.par=1) uses the variances of the
random effecs
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>θ</mi><mi>j</mi></msub><mo>=</mo><msub><mi>λ</mi><mi>j</mi></msub><mi>/</mi><msup><mi>ν</mi><mn>2</mn></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
 \theta_j  = \lambda_j/\nu^2
\end{align*}</annotation></semantics></math> For alternative
parametrizations one can specify that the parameters are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>j</mi></msub><mo>=</mo><msub><mi>λ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\theta_j=\lambda_j</annotation></semantics></math>
with the argument var.par=0.</p>
<p>Finally the parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>θ</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\theta_1,...,\theta_d)</annotation></semantics></math>
are related to the parameters of the model by a regression construction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
(d x k), that links the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
parameters with the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
underlying
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
parameters
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>θ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>M</mi><mi>α</mi><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
 \theta &amp; = M  \alpha. 
\end{align*}</annotation></semantics></math> The default is a diagonal
matrix for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>.
This can be used to make structural assumptions about the variances of
the random-effects as is needed for the ACE model for example. In the
software $ M $ is called theta.des</p>
<p>Assume that the marginal survival distribution for subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
within cluster
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is given by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><msub><mi>X</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S_{X_{k,i}}(t)</annotation></semantics></math>
given covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{k,i}</annotation></semantics></math>.</p>
<p>Now given the random effects of the cluster
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mi>k</mi></msub><annotation encoding="application/x-tex">Z_k</annotation></semantics></math>
and the
covariates<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{k,i}</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>n</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">i=1,\dots,n_k</annotation></semantics></math>
we assume that subjects within the cluster are independent with survival
distributions
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>V</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><msub><mi>Z</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>Ψ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ν</mi><mo>,</mo><msub><mi>S</mi><msub><mi>X</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
  \exp(-  ( V_{k,i} Z_k)  \Psi^{-1} (\nu,S_{X_{k,i}}(t)) ).
\end{align*}</annotation></semantics></math></p>
<p>A consequence of this is that the hazards given the covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{k,i}</annotation></semantics></math>
and the random effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mi>k</mi></msub><annotation encoding="application/x-tex">Z_k</annotation></semantics></math>
are given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>λ</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><msub><mi>X</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>,</mo><msub><mi>Z</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>V</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><msub><mi>V</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>D</mi><mn>3</mn></msub><msup><mi>Ψ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ν</mi><mo>,</mo><msub><mi>S</mi><msub><mi>X</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>D</mi><mi>t</mi></msub><msub><mi>S</mi><msub><mi>X</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  \lambda_{k,i}(t;X_{k,i},Z_{k,i}) = ( V_{k,i} V_k) D_3 \Psi^{-1} (\nu,S_{X_{k,i}}(t))  D_t S_{X_{k,i}}(t) 
  \label{eq-cond-haz}
\end{align}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>t</mi></msub><annotation encoding="application/x-tex">D_t</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mn>3</mn></msub><annotation encoding="application/x-tex">D_3</annotation></semantics></math>
denotes the partial derivatives with respect to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
and the third argument, respectively.</p>
<p>Further, we can express the multivariate survival distribution as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>t</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>V</mi><mi>i</mi></msub><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>Ψ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>η</mi><mi>l</mi></msub><mo>,</mo><msub><mi>ν</mi><mi>l</mi></msub><mo>,</mo><msub><mi>S</mi><msub><mi>X</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∏</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mi>Ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>η</mi><mi>l</mi></msub><mo>,</mo><mi>η</mi><mo>,</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Q</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><msup><mi>Ψ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo>,</mo><mi>η</mi><mo>,</mo><msub><mi>S</mi><msub><mi>X</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  S(t_1,\dots,t_m) &amp; =  \exp( -\sum_{i=1}^m (V_i Z) \Psi^{-1}(\eta_l,\nu_l,S_{X_{k,i}}(t_i)) )  \nonumber \\
  &amp; =  \prod_{l=1}^p  \Psi(\eta_l,\eta , \sum_{i=1}^m Q_{k,i} \Psi^{-1}(\eta,\eta,S_{X_{k,i}}(t_i))).
  \label{eq-multivariate-surv}
\end{align}</annotation></semantics></math> In the case of considering
just pairs, we write this function as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>S</mi><mrow><mi>k</mi><mo>,</mo><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">C(S_{k,i}(t),S_{k,j}(t))</annotation></semantics></math>.</p>
<p>In addition to survival times from this model, we assume that we
independent right censoring present
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>U</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">U_{k,i}</annotation></semantics></math>
such that the given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mi>k</mi></msub><annotation encoding="application/x-tex">V_k</annotation></semantics></math>
and the
covariates<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>k</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">X_{k,i}</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>n</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">i=1,\dots,n_k</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>U</mi><mrow><mi>k</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>U</mi><mrow><mi>k</mi><mo>,</mo><msub><mi>n</mi><mi>k</mi></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(U_{k,1},\dots,U_{k,n_k})</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mrow><mi>k</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>k</mi><mo>,</mo><msub><mi>n</mi><mi>k</mi></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(T_{k,1},\dots,T_{k,n_k})</annotation></semantics></math>,
and the conditional censoring distribution do not depend on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mi>k</mi></msub><annotation encoding="application/x-tex">V_k</annotation></semantics></math>.</p>
<p>One consequence of the model strucure is that the Kendall’s can be
computed for two-subjects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math>
across two clusters <code>1'' and</code>2’’ as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>V</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><msub><mi>Z</mi><mn>1</mn></msub><mo>−</mo><msub><mi>V</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>Z</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>V</mi><mrow><mn>2</mn><mi>i</mi></mrow></msub><msub><mi>Z</mi><mn>1</mn></msub><mo>−</mo><msub><mi>V</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><msub><mi>Z</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>V</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><msub><mi>Z</mi><mn>1</mn></msub><mo>+</mo><msub><mi>V</mi><mrow><mn>2</mn><mi>i</mi></mrow></msub><msub><mi>Z</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>V</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>Z</mi><mn>1</mn></msub><mo>+</mo><msub><mi>V</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><msub><mi>Z</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
E( \frac{( V_{1i} Z_1-  V_{1j}Z_2)( V_{2i}Z_1 -  V_{2j}Z_2 )}{( V_{1i}Z_1 + V_{2i}Z_2 ) ( V_{1j}Z_1 + V_{2j}Z_2 )} ) 
\end{align}</annotation></semantics></math> under the assumption that
that we compare pairs with equivalent marginals,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><msub><mi>X</mi><mrow><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>S</mi><msub><mi>X</mi><mrow><mn>2</mn><mo>,</mo><mi>i</mi></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S_{X_{1,i}}(t)= S_{X_{2,i}}(t)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><msub><mi>X</mi><mrow><mn>1</mn><mo>,</mo><mi>j</mi></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>S</mi><msub><mi>X</mi><mrow><mn>2</mn><mo>,</mo><mi>j</mi></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S_{X_{1,j}}(t)= S_{X_{2,j}}(t)</annotation></semantics></math>,
and that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><msub><mi>X</mi><mrow><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>∞</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>S</mi><msub><mi>X</mi><mrow><mn>1</mn><mo>,</mo><mi>j</mi></mrow></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>∞</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">S_{X_{1,i}}(\infty)= S_{X_{1,j}}(\infty)=0</annotation></semantics></math>.
Here we also use that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>η</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
is the same across clusters. The Kendall’s tau would be the same for due
to the same additive structure for the frailty terms, and the random
effects thus have the same interpretation in terms of Kendall’s tau.</p>
</div>
<div class="section level2">
<h2 id="univariate-gamma-clayton-oakes-model-twostage-models">Univariate gamma (clayton-oakes) model twostage models<a class="anchor" aria-label="anchor" href="#univariate-gamma-clayton-oakes-model-twostage-models"></a>
</h2>
<p>We start by fitting simple Clayton-Oakes models for the data, that is
with an overall random effect that is Gamma distrubuted with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.
We can fit the model by a pseudo-MLE (twostageMLE) and a pairwise
composite likelihood approach (twostage).</p>
<p>The pseudo-liklihood and the composite pairwise likelhood should give
the same for this model since we have paired data. In addition the
log-parametrization is illustrated with the var.link=1 option. In
addition it is specified that we want a “clayton.oakes” model. We note
that the standard errors differs because the twostage does not include
the variance due to the baseline parameters for this type of modelling,
so here it is better to use the twostageMLE.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/mets/" class="external-link">mets</a></span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Marginal Cox model  with treat as covariate</span></span>
<span> <span class="va">margph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">treat</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">diabetes</span><span class="op">)</span></span>
<span> <span class="co"># Clayton-Oakes, MLE </span></span>
<span> <span class="va">fitco1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/twostageMLE.html">twostageMLE</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">diabetes</span>,theta<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitco1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.        SE       z       P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 0.9526614 0.3543033 2.68883 0.007170289    0.322645 0.08127892</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span> </span>
<span> <span class="co"># Clayton-Oakes</span></span>
<span> <span class="va">fitco2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">diabetes</span>,theta<span class="op">=</span><span class="fl">0.0</span>,</span>
<span>                  clusters<span class="op">=</span><span class="va">diabetes</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">1</span>,model<span class="op">=</span><span class="st">"clayton.oakes"</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitco2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;              log-Coef.        SE          z     P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 -0.0484957 0.3718487 -0.1304178 0.8962359    0.322645 0.08126576</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vargam</span></span>
<span><span class="co">#&gt;             Estimate Std.Err   2.5% 97.5%  P-value</span></span>
<span><span class="co">#&gt; dependence1   0.9527  0.3542 0.2584 1.647 0.007161</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span> <span class="va">fitco3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">diabetes</span>,theta<span class="op">=</span><span class="fl">1.0</span>,</span>
<span>                  clusters<span class="op">=</span><span class="va">diabetes</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">0</span>,model<span class="op">=</span><span class="st">"clayton.oakes"</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitco3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.     SE        z       P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 0.9526614 0.3543 2.688855 0.007169754    0.322645 0.08127816</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>Note, the standard errors are slightly different when comparing
fitco1 with fitco3 since the survival.twostage uses numerical
derivatives for the hessian and the derivative in the direction of the
marginal model.</p>
<p>The marginal models can be either structured Cox model or as here
with a baseline for each strata. This gives quite similar results to
those before.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># without covariates but marginal model stratified </span></span>
<span>  <span class="va">marg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">treat</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">diabetes</span><span class="op">)</span></span>
<span> <span class="va">fitco</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/twostageMLE.html">twostageMLE</a></span><span class="op">(</span><span class="va">marg</span>,data<span class="op">=</span><span class="va">diabetes</span>,theta<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitco</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.        SE        z       P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 0.9447446 0.3516204 2.686831 0.007213349    0.320824 0.08109776</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span></span>
<span>  <span class="va">fitcoa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">marg</span>,data<span class="op">=</span><span class="va">diabetes</span>,theta<span class="op">=</span><span class="fl">1.0</span>,clusters<span class="op">=</span><span class="va">diabetes</span><span class="op">$</span><span class="va">id</span>,</span>
<span>           model<span class="op">=</span><span class="st">"clayton.oakes"</span>,var.link<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitcoa</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.        SE        z       P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 0.9447446 0.3516129 2.686889 0.007212097    0.320824 0.08109601</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="piecewise-constant-clayton-oakes-model">Piecewise constant Clayton-Oakes model<a class="anchor" aria-label="anchor" href="#piecewise-constant-clayton-oakes-model"></a>
</h2>
<p>Let the cross-hazard ratio (CHR) be defined as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>η</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo>,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>λ</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mn>2</mn></msub><mo>=</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>λ</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mn>2</mn></msub><mo>≥</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><msub><mi>λ</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mn>1</mn></msub><mo>=</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>λ</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mn>1</mn></msub><mo>≥</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  \eta(t_1,t_2) =  \frac{ \lambda_1(t_1| T_2=t_2)}{ \lambda_1(t_1| T_2 \ge t_2)}
  =  \frac{ \lambda_2(t_2| T_1=t_1)}{ \lambda_2(t_2| T_1 \ge t_1)}
\end{align}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\lambda_2</annotation></semantics></math>
are the conditional hazard functions of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>1</mn></msub><annotation encoding="application/x-tex">T_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mn>2</mn></msub><annotation encoding="application/x-tex">T_2</annotation></semantics></math>
given covariates. For the Clayton-Oakes model this ratio is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo>,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>+</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">\eta(t_1,t_2) = 1+\theta</annotation></semantics></math>,
and as a consequence we see that if the co-twin is dead at any time we
would increase our risk assessment on the hazard scale with the constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo>,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta(t_1,t_2)</annotation></semantics></math>.
The Clayton-Oakes model also has the nice property that Kendall’s tau is
linked directly to the dependence parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
and is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><mi>/</mi><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1/(1+2/\theta)</annotation></semantics></math>.</p>
<p>A very useful extension of the model the constant cross-hazard ratio
(CHR) model is the piecewise constant cross-hazard ratio (CHR) for
bivariate survival data , and this model was extended to competing risks
in .</p>
<p>In the survival setting we let the CHR
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>η</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo>,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>∑</mo><msub><mi>η</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo>∈</mo><msub><mi>I</mi><mi>i</mi></msub><mo>,</mo><msub><mi>t</mi><mn>2</mn></msub><mo>∈</mo><msub><mi>I</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  \eta(t_1,t_2) &amp; = \sum \eta_{i,j} I(t_1 \in I_i, t_2 \in I_j)
\end{align}</annotation></semantics></math></p>
<p>The model lets the CHR by constant in different part of the plane.
This can be thought of also as having a separate Clayton-Oakes model for
each of the regions specified in the plane here by the cut-points
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0.5</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(0,0.5,2)</annotation></semantics></math>
thus defining 9 regions.</p>
<p>This provides a constructive goodness of fit test for the whether the
Clayton-Oakes model is valid. Indeed if valid the parameter should be
the same in all regions.</p>
<p>First we generate some data from the Clayton-Oakes model with
variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.5</mn><annotation encoding="application/x-tex">0.5</annotation></semantics></math>
and 2000 pairs. And fit the related model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simClaytonOakes.html">simClaytonOakes</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">2</span>,<span class="fl">0.5</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="va">margph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span>
<span> <span class="co"># Clayton-Oakes, MLE </span></span>
<span> <span class="va">fitco1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/twostageMLE.html">twostageMLE</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitco1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                Coef.        SE       z        P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 2.283394 0.3164797 7.21498 5.393463e-13   0.5330806 0.03449846</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>Now we cut the region at the cut-points
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0.5</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(0,0.5,2)</annotation></semantics></math>
thus defining 9 regions and fit a separate model for each region.<br>
We see that the parameter is indeed rather constant over the 9 regions.
A formal test can be constructed.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">udp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">piecewise.twostage</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">2</span><span class="op">)</span>,data<span class="op">=</span><span class="va">d</span>,id<span class="op">=</span><span class="st">"cluster"</span>,timevar<span class="op">=</span><span class="st">"time"</span>,status<span class="op">=</span><span class="st">"status"</span>,model<span class="op">=</span><span class="st">"clayton.oakes"</span>,silent<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; Data-set  1 out of  4</span></span>
<span><span class="co">#&gt;   Number of joint events: 55 of  200</span></span>
<span><span class="co">#&gt; Data-set  2 out of  4</span></span>
<span><span class="co">#&gt;   Number of joint events: 25 of  116</span></span>
<span><span class="co">#&gt; Data-set  3 out of  4</span></span>
<span><span class="co">#&gt;   Number of joint events: 28 of  120</span></span>
<span><span class="co">#&gt; Data-set  4 out of  4</span></span>
<span><span class="co">#&gt;   Number of joint events: 50 of  91</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">udp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model </span></span>
<span><span class="co">#&gt; log-coefficient for dependence parameter (SE) </span></span>
<span><span class="co">#&gt;          0 - 0.5        0.5 - 2      </span></span>
<span><span class="co">#&gt; 0 - 0.5  0.566 (0.222)  1.278 (0.223)</span></span>
<span><span class="co">#&gt; 0.5 - 2  0.519 (0.268)  1.092 (0.205)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Kendall's tau (SE) </span></span>
<span><span class="co">#&gt;          0 - 0.5        0.5 - 2      </span></span>
<span><span class="co">#&gt; 0 - 0.5  0.468 (0.055)  0.642 (0.051)</span></span>
<span><span class="co">#&gt; 0.5 - 2  0.457 (0.066)  0.598 (0.049)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="multivariate-gamma-twostage-models">Multivariate gamma twostage models<a class="anchor" aria-label="anchor" href="#multivariate-gamma-twostage-models"></a>
</h2>
<p>To illustrate how the multivariate models can be used, we first set
up some twin data with ACE structure. That is two shared random effects,
one being the genes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mi>g</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_g^2</annotation></semantics></math>
and one the environmental effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_e^2</annotation></semantics></math>.
Monozygotic twins share all genes whereas the dizygotic twins only share
half the genes. This can be expressed via 5 random effect for each twin
pair (for example). We start by setting this up.</p>
<p>The pardes matrix tells how the the parameters of the 5 random
effects are related, and the matrix her first has one random effect with
parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\theta_1</annotation></semantics></math>
(here the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mi>g</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_g^2</annotation></semantics></math>
), then the next 3 random effects have parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn><msub><mi>θ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">0.5 \theta_1</annotation></semantics></math>
(here
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn><msubsup><mi>σ</mi><mi>g</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">0.5 \sigma_g^2</annotation></semantics></math>
), and the last random effect that is given by its own parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\theta_2</annotation></semantics></math>
(here
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_e^2</annotation></semantics></math>
).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">simClaytonOakes.twin.ace</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">data</span>,id<span class="op">=</span><span class="st">"cluster"</span>,zyg<span class="op">=</span><span class="st">"DZ"</span>,zygname<span class="op">=</span><span class="st">"zyg"</span>,type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span></span>
<span> <span class="va">pardes</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">pardes</span></span>
<span> <span class="va">pardes</span> </span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]  1.0    0</span></span>
<span><span class="co">#&gt; [2,]  0.5    0</span></span>
<span><span class="co">#&gt; [3,]  0.5    0</span></span>
<span><span class="co">#&gt; [4,]  0.5    0</span></span>
<span><span class="co">#&gt; [5,]  0.0    1</span></span></code></pre></div>
<p>The last part of the model structure is to decide how the random
effects are shared for the different pairs (MZ and DZ), this is specfied
by the random effects design
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mn>1</mn></msub><annotation encoding="application/x-tex">V_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mn>2</mn></msub><annotation encoding="application/x-tex">V_2</annotation></semantics></math>)
for each pair. This is here specified by an overall designmatrix for
each subject (since they enter all pairs with the same random effects
design).</p>
<p>For an MZ pair the two share the full gene random effect and the full
environmental random effect. In contrast the DZ pairs share the 2nd
random effect with half the gene-variance and have both a non-shared
gene-random effect with half the variance, and finally a fully shared
environmental random effect.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">des.rv</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">des.rv</span></span>
<span> <span class="co"># MZ</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">des.rv</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;   MZ DZ DZns1 DZns2 env</span></span>
<span><span class="co">#&gt; 1  1  0     0     0   1</span></span>
<span><span class="co">#&gt; 2  1  0     0     0   1</span></span>
<span> <span class="co"># DZ </span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">des.rv</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;     MZ DZ DZns1 DZns2 env</span></span>
<span><span class="co">#&gt; 399  0  1     1     0   1</span></span>
<span><span class="co">#&gt; 400  0  1     0     1   1</span></span></code></pre></div>
<p>Now we call the twostage function. We see that we essentially recover
the true values, and note that the output also compares the sizes of the
genetic and environmental random effect. This number is sometimes called
the heritability. In addition the total variance for each subject is
also computed and is here around
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3</mn><annotation encoding="application/x-tex">3</annotation></semantics></math>,
as we indeed constructed.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### data &lt;- simClaytonOakes.twin.ace(2000,2,1,0,3)</span></span>
<span><span class="co">### out &lt;- twin.polygen.design(data,id="cluster",zyg="DZ",zygname="zyg",type="ace")</span></span>
<span> <span class="va">aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span>,data<span class="op">=</span><span class="va">data</span><span class="op">)</span></span>
<span> <span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/twostage.html" class="external-link">twostage</a></span><span class="op">(</span><span class="va">aa</span>,data<span class="op">=</span><span class="va">data</span>,clusters<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>      theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,var.link<span class="op">=</span><span class="fl">0</span>,random.design<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                Coef.        SE        z       P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 2.051732 0.6981882 2.938652 0.003296431   0.5063840 0.08505916</span></span>
<span><span class="co">#&gt; dependence2 1.025707 0.5674045 1.807717 0.070650519   0.3389974 0.12395643</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;      Estimate Std.Err     2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt; [1,]   0.6667    0.19  0.29431 1.0391 0.0004498</span></span>
<span><span class="co">#&gt; [2,]   0.3333    0.19 -0.03909 0.7057 0.0793902</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1    3.077  0.3982 2.297 3.858 1.092e-14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<ul>
<li>A nice feature of the procdure is that it scales linearly in the
number of observations
<ul>
<li>1 mill pairs had a running time of around 100 seconds.</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">run</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">simClaytonOakes.twin.ace</a></span><span class="op">(</span><span class="fl">1000000</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">twin.polygen.design</a></span><span class="op">(</span><span class="va">data</span>,id<span class="op">=</span><span class="st">"cluster"</span>,zyg<span class="op">=</span><span class="st">"DZ"</span>,zygname<span class="op">=</span><span class="st">"zyg"</span>,type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span></span>
<span> <span class="va">pardes</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">pardes</span></span>
<span> <span class="va">aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span>,data<span class="op">=</span><span class="va">data</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span> <span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/twostage.html" class="external-link">twostage</a></span><span class="op">(</span><span class="va">aa</span>,data<span class="op">=</span><span class="va">data</span>,clusters<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>      theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,var.link<span class="op">=</span><span class="fl">0</span>,random.design<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span><span class="op">)</span></span>
<span> <span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The estimates can be transformed into Kendall’s tau estimates for MZ
and DZ twins. The Kendall’s tau in the above output reflects how a gamma
distributed random effect in the normal Clayton-Oakes model is related
to the Kendall’s tau. In this setting the Kendall’s of MZ and DZ,
however, should reflect both random effects.</p>
<p>We do this based on simulations. The Kendall’s tau of the MZ is
around 0.60, and for DZ around 0.33. Both are quite high and this is due
to a large shared environmental effect and large genetic effect.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/internal.html">kendall.ClaytonOakes.twin.ace</a></span><span class="op">(</span><span class="va">ts</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">ts</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,K<span class="op">=</span><span class="fl">10000</span><span class="op">)</span> </span>
<span><span class="co">#&gt; $mz.kendall</span></span>
<span><span class="co">#&gt; [1] 0.6186546</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dz.kendall</span></span>
<span><span class="co">#&gt; [1] 0.3350827</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="family-data">Family data<a class="anchor" aria-label="anchor" href="#family-data"></a>
</h2>
<p>For family data, things are quite similar since we use only the
pairwise structure. We show how the designs are specified.</p>
<p>First we simulate data from an ACE model. 2000 families with
two-parents that share only the environment, and two-children that share
genes with their parents.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/mets/" class="external-link">mets</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">simClaytonOakes.family.ace</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;        time status x cluster   type   mintime lefttime truncated</span></span>
<span><span class="co">#&gt; 1 0.4139376      1 0       1 mother 0.4139376        0         0</span></span>
<span><span class="co">#&gt; 2 1.6435053      1 1       1 father 0.4139376        0         0</span></span>
<span><span class="co">#&gt; 3 1.2485275      1 0       1  child 0.4139376        0         0</span></span>
<span><span class="co">#&gt; 4 1.1079118      1 1       1  child 0.4139376        0         0</span></span>
<span><span class="co">#&gt; 5 3.0000000      0 0       2 mother 1.6718726        0         0</span></span>
<span><span class="co">#&gt; 6 2.0085566      1 1       2 father 1.6718726        0         0</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">child</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">number</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>To set up the random effects some functions can be used. We here set
up the ACE model that has 9 random effects with one shared environmental
effect (the last random effect) and 4 genetic random effects for each
parent, with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mi>g</mi><mn>2</mn></msubsup><mi>/</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">\sigma_g^2/4</annotation></semantics></math>.</p>
<p>The random effect is again set-up with an overall designmatrix
because it is again the same for each subject for all comparisons across
family members. We below demonstrate how the model can be specified in
various other ways.</p>
<p>Each child share 2 genetic random effects with each parent, and also
share 2 genetic random effects with his/her sibling.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">ace.family.design</a></span><span class="op">(</span><span class="va">data</span>,member<span class="op">=</span><span class="st">"type"</span>,id<span class="op">=</span><span class="st">"cluster"</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt;  [1,] 0.25    0</span></span>
<span><span class="co">#&gt;  [2,] 0.25    0</span></span>
<span><span class="co">#&gt;  [3,] 0.25    0</span></span>
<span><span class="co">#&gt;  [4,] 0.25    0</span></span>
<span><span class="co">#&gt;  [5,] 0.25    0</span></span>
<span><span class="co">#&gt;  [6,] 0.25    0</span></span>
<span><span class="co">#&gt;  [7,] 0.25    0</span></span>
<span><span class="co">#&gt;  [8,] 0.25    0</span></span>
<span><span class="co">#&gt;  [9,] 0.00    1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;      m1 m2 m3 m4 f1 f2 f3 f4 env</span></span>
<span><span class="co">#&gt; [1,]  1  1  1  1  0  0  0  0   1</span></span>
<span><span class="co">#&gt; [2,]  0  0  0  0  1  1  1  1   1</span></span>
<span><span class="co">#&gt; [3,]  1  1  0  0  1  1  0  0   1</span></span>
<span><span class="co">#&gt; [4,]  1  0  1  0  1  0  1  0   1</span></span></code></pre></div>
<p>Then we fit the model</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span>,data<span class="op">=</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make ace random effects design</span></span>
<span><span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/twostage.html" class="external-link">twostage</a></span><span class="op">(</span><span class="va">pa</span>,data<span class="op">=</span><span class="va">data</span>,clusters<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span>,var.par<span class="op">=</span><span class="fl">1</span>,var.link<span class="op">=</span><span class="fl">0</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>        random.design<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.        SE        z        P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 2.0094622 0.5369170 3.742594 0.0001821303   0.5011800 0.06679822</span></span>
<span><span class="co">#&gt; dependence2 0.6503464 0.2136795 3.043561 0.0023379628   0.2453817 0.06083976</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;      Estimate Std.Err    2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; [1,]   0.7555 0.09823 0.56297 0.948 1.458e-14</span></span>
<span><span class="co">#&gt; [2,]   0.2445 0.09823 0.05199 0.437 1.280e-02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1     2.66  0.4459 1.786 3.534 2.437e-09</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>The model can also be fitted by specifying the pairs that one wants
for the pairwise likelhood. This is done by specifying the pairs
argument. We start by considering all pairs as we also did before.</p>
<p>All pairs can be written up by calling the familycluster.index
function.</p>
<p>There are xx pairs to consider, and the first 6 pairs for the first
family is written out here.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># now specify fitting via specific pairs </span></span>
<span><span class="co"># first all pairs </span></span>
<span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/familycluster.index.html">familycluster.index</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mm</span><span class="op">$</span><span class="va">familypairindex</span>,n<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1 2 1 3 1 4 2 3 2 4 3 4</span></span>
<span><span class="va">pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">mm</span><span class="op">$</span><span class="va">familypairindex</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pairs</span>,n<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    2</span></span>
<span><span class="co">#&gt; [2,]    1    3</span></span>
<span><span class="co">#&gt; [3,]    1    4</span></span>
<span><span class="co">#&gt; [4,]    2    3</span></span>
<span><span class="co">#&gt; [5,]    2    4</span></span>
<span><span class="co">#&gt; [6,]    3    4</span></span></code></pre></div>
<p>Then fitting the model using only specified pairs</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/twostage.html" class="external-link">twostage</a></span><span class="op">(</span><span class="va">pa</span>,data<span class="op">=</span><span class="va">data</span>,clusters<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span>, theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,var.link<span class="op">=</span><span class="fl">0</span>,step<span class="op">=</span><span class="fl">1.0</span>,</span>
<span>        random.design<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>, theta.des<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span>,pairs<span class="op">=</span><span class="va">pairs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.        SE        z        P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 2.0094622 0.5369170 3.742594 0.0001821303   0.5011800 0.06679822</span></span>
<span><span class="co">#&gt; dependence2 0.6503464 0.2136795 3.043561 0.0023379628   0.2453817 0.06083976</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;      Estimate Std.Err    2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; [1,]   0.7555 0.09823 0.56297 0.948 1.458e-14</span></span>
<span><span class="co">#&gt; [2,]   0.2445 0.09823 0.05199 0.437 1.280e-02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err  2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1     2.66  0.4459 1.786 3.534 2.437e-09</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>Now we only use a random sample of the pairs by sampling these. The
pairs picked still refers to the data given in the data argument, and
clusters (families) are also specified as before.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">)</span>,<span class="fl">200</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tsd</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/twostage.html" class="external-link">twostage</a></span><span class="op">(</span><span class="va">pa</span>,data<span class="op">=</span><span class="va">data</span>,clusters<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>    theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>,var.link<span class="op">=</span><span class="fl">0</span>,random.design<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">des.rv</span>,</span>
<span>   theta.des<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">pardes</span>,pairs<span class="op">=</span><span class="va">pairs</span><span class="op">[</span><span class="va">ssid</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsd</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.        SE        z     P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 0.9237395 0.6070493 1.521688 0.1280873   0.3159445 0.14202885</span></span>
<span><span class="co">#&gt; dependence2 0.4087673 0.2660432 1.536469 0.1244233   0.1696998 0.09170489</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;      Estimate Std.Err    2.5%  97.5% P-value</span></span>
<span><span class="co">#&gt; [1,]   0.6932  0.2523  0.1987 1.1878 0.00601</span></span>
<span><span class="co">#&gt; [2,]   0.3068  0.2523 -0.1878 0.8013 0.22410</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err   2.5% 97.5% P-value</span></span>
<span><span class="co">#&gt; p1    1.333  0.4803 0.3912 2.274 0.00553</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>Sometimes one only has the data from the pairs in addition to for
example a cohort estimate of the marginal surival models. We now
demonstrate how this is dealt with. Everything is essentially as before
but need to organize the design differently compared to before we
specified the design<br>
for everybody in the cohort. In addition we do not here bring in the
uncertainty from the baseline in the estimates, even though this is
formally possible, but when the data of the marginal model and twostage
data are not the same, we have to specify that we do not want the
decomposition for the uncertainty due to the baseline
(baseline.iid=0).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">[</span><span class="va">ssid</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pairsids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">[</span><span class="va">ssid</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="va">pair.new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="../reference/fast.approx.html">fast.approx</a></span><span class="op">(</span><span class="va">ids</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">[</span><span class="va">ssid</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pair.new</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    2</span></span>
<span><span class="co">#&gt; [2,]    3    4</span></span>
<span><span class="co">#&gt; [3,]    3    6</span></span>
<span><span class="co">#&gt; [4,]    5    6</span></span>
<span><span class="co">#&gt; [5,]    7    8</span></span>
<span><span class="co">#&gt; [6,]    9   11</span></span>
<span></span>
<span><span class="co"># this requires that pair.new refers to id's in dataid (survival, status and so forth)</span></span>
<span><span class="co"># random.design and theta.des are constructed to be the array 3 dims via individual specfication from ace.family.design</span></span>
<span><span class="va">dataid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dsort.html">dsort</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">ids</span>,<span class="op">]</span>,<span class="st">"cluster"</span><span class="op">)</span></span>
<span><span class="va">outid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">ace.family.design</a></span><span class="op">(</span><span class="va">dataid</span>,member<span class="op">=</span><span class="st">"type"</span>,id<span class="op">=</span><span class="st">"cluster"</span><span class="op">)</span></span>
<span><span class="va">outid</span><span class="op">$</span><span class="va">pardes</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt;  [1,] 0.25    0</span></span>
<span><span class="co">#&gt;  [2,] 0.25    0</span></span>
<span><span class="co">#&gt;  [3,] 0.25    0</span></span>
<span><span class="co">#&gt;  [4,] 0.25    0</span></span>
<span><span class="co">#&gt;  [5,] 0.25    0</span></span>
<span><span class="co">#&gt;  [6,] 0.25    0</span></span>
<span><span class="co">#&gt;  [7,] 0.25    0</span></span>
<span><span class="co">#&gt;  [8,] 0.25    0</span></span>
<span><span class="co">#&gt;  [9,] 0.00    1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">outid</span><span class="op">$</span><span class="va">des.rv</span><span class="op">)</span></span>
<span><span class="co">#&gt;      m1 m2 m3 m4 f1 f2 f3 f4 env</span></span>
<span><span class="co">#&gt; [1,]  0  0  0  0  1  1  1  1   1</span></span>
<span><span class="co">#&gt; [2,]  1  0  1  0  1  0  1  0   1</span></span>
<span><span class="co">#&gt; [3,]  1  1  1  1  0  0  0  0   1</span></span>
<span><span class="co">#&gt; [4,]  0  0  0  0  1  1  1  1   1</span></span>
<span><span class="co">#&gt; [5,]  1  1  0  0  1  1  0  0   1</span></span>
<span><span class="co">#&gt; [6,]  1  0  1  0  1  0  1  0   1</span></span></code></pre></div>
<p>Now fitting the model using only the pair data.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsdid</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/twostage.html" class="external-link">twostage</a></span><span class="op">(</span><span class="va">pa</span>,data<span class="op">=</span><span class="va">dataid</span>,clusters<span class="op">=</span><span class="va">dataid</span><span class="op">$</span><span class="va">cluster</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>,var.link<span class="op">=</span><span class="fl">0</span>,baseline.iid<span class="op">=</span><span class="fl">0</span>,</span>
<span>          random.design<span class="op">=</span><span class="va">outid</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">outid</span><span class="op">$</span><span class="va">pardes</span>,pairs<span class="op">=</span><span class="va">pair.new</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsdid</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.        SE        z     P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 0.9237395 0.6040859 1.529153 0.1262266   0.3159445 0.14133553</span></span>
<span><span class="co">#&gt; dependence2 0.4087673 0.2590853 1.577732 0.1146271   0.1696998 0.08930652</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;      Estimate Std.Err    2.5%  97.5%  P-value</span></span>
<span><span class="co">#&gt; [1,]   0.6932  0.2487  0.2058 1.1807 0.005311</span></span>
<span><span class="co">#&gt; [2,]   0.3068  0.2487 -0.1807 0.7942 0.217376</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err   2.5% 97.5%  P-value</span></span>
<span><span class="co">#&gt; p1    1.333  0.4784 0.3949  2.27 0.005345</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span></span>
<span><span class="va">paid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span>,data<span class="op">=</span><span class="va">dataid</span><span class="op">)</span></span>
<span><span class="va">tsdidb</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/twostage.html" class="external-link">twostage</a></span><span class="op">(</span><span class="va">paid</span>,data<span class="op">=</span><span class="va">dataid</span>,clusters<span class="op">=</span><span class="va">dataid</span><span class="op">$</span><span class="va">cluster</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>,</span>
<span>  var.link<span class="op">=</span><span class="fl">0</span>,random.design<span class="op">=</span><span class="va">outid</span><span class="op">$</span><span class="va">des.rv</span>,theta.des<span class="op">=</span><span class="va">outid</span><span class="op">$</span><span class="va">pardes</span>,pairs<span class="op">=</span><span class="va">pair.new</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsdidb</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.        SE        z     P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 0.9405413 0.6151098 1.529062 0.1262490   0.3198531 0.14227484</span></span>
<span><span class="co">#&gt; dependence2 0.3381704 0.2557053 1.322501 0.1860015   0.1446303 0.09354431</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;      Estimate Std.Err    2.5%  97.5%  P-value</span></span>
<span><span class="co">#&gt; [1,]   0.7355  0.2499  0.2458 1.2253 0.003247</span></span>
<span><span class="co">#&gt; [2,]   0.2645  0.2499 -0.2253 0.7542 0.289925</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err   2.5% 97.5%  P-value</span></span>
<span><span class="co">#&gt; p1    1.279  0.4865 0.3251 2.232 0.008583</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">tsdid</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 Coef.        SE        z     P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 0.9237395 0.6040859 1.529153 0.1262266   0.3159445 0.14133553</span></span>
<span><span class="co">#&gt; dependence2 0.4087673 0.2590853 1.577732 0.1146271   0.1696998 0.08930652</span></span></code></pre></div>
<p>Estimates changed because we used either the marginal from the
full-data, in which case the standard errors did not reflect the
uncertainty from the baseline, or the marginal estimated from only the
sub-sample in which case the marginals were slightly different.</p>
<div class="section level3">
<h3 id="pairwise-specification-of-random-effects-and-variances">Pairwise specification of random effects and variances<a class="anchor" aria-label="anchor" href="#pairwise-specification-of-random-effects-and-variances"></a>
</h3>
<p>Now we illustrate how one can also directly specify the random.design
and theta.design for each pair, rather than taking an overall
specification that can be used for the whole family via the rows of the
des.rv for the relevant pairs. This can be much simpler in some
situations.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pair.types</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">dataid</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">pair.new</span><span class="op">)</span><span class="op">)</span>,<span class="st">"type"</span><span class="op">]</span>,byrow<span class="op">=</span><span class="cn">T</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pair.new</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    2</span></span>
<span><span class="co">#&gt; [2,]    3    4</span></span>
<span><span class="co">#&gt; [3,]    3    6</span></span>
<span><span class="co">#&gt; [4,]    5    6</span></span>
<span><span class="co">#&gt; [5,]    7    8</span></span>
<span><span class="co">#&gt; [6,]    9   11</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pair.types</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]     [,2]    </span></span>
<span><span class="co">#&gt; [1,] "father" "child" </span></span>
<span><span class="co">#&gt; [2,] "mother" "father"</span></span>
<span><span class="co">#&gt; [3,] "mother" "child" </span></span>
<span><span class="co">#&gt; [4,] "child"  "child" </span></span>
<span><span class="co">#&gt; [5,] "father" "child" </span></span>
<span><span class="co">#&gt; [6,] "mother" "child"</span></span>
<span></span>
<span><span class="va">theta.des</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">random.des</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mf</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">pair.types</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">==</span><span class="st">"mother"</span> <span class="op">&amp;</span> <span class="va">pair.types</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="st">"father"</span><span class="op">)</span></span>
<span><span class="co">##          pair, rv related to pairs,  theta.des related to pair </span></span>
<span><span class="va">pairs.new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pair.new</span>,<span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span><span class="op">+</span><span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="fl">3</span>,<span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span><span class="op">+</span><span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span>,<span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">1</span><span class="op">+</span><span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span>,<span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">3</span><span class="op">+</span><span class="op">(</span><span class="va">mf</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>pairs.new is matix with</p>
<ul>
<li><p>columns 1:2 giving the indeces of the data points</p></li>
<li><p>columns 3:4 giving the indeces of the random.design for the
different pairs</p></li>
<li><p>columns 5 giving the indeces of the theta.des written as
rows</p></li>
<li><p>columns 6 giving the number of random variables for this
pair</p></li>
</ul>
<p>Looking at the first three rows. We see that the composite likehood
is based on data-points (1,2), (3,4) and (5,6), these are (mother,
father), (mother, child), and (father, child), respectively.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pairs.new</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">#&gt; [1,]    1    2    3    4    2    4</span></span>
<span><span class="co">#&gt; [2,]    3    4    1    2    1    3</span></span>
<span><span class="co">#&gt; [3,]    3    6    3    4    2    4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataid</span><span class="op">)</span></span>
<span><span class="co">#&gt;       time status x cluster   type   mintime lefttime truncated number child</span></span>
<span><span class="co">#&gt; 2 1.643505      1 1       1 father 0.4139376        0         0      2     0</span></span>
<span><span class="co">#&gt; 4 1.107912      1 1       1  child 0.4139376        0         0      4     0</span></span>
<span><span class="co">#&gt; 5 3.000000      0 0       2 mother 1.6718726        0         0      1     0</span></span>
<span><span class="co">#&gt; 6 2.008557      1 1       2 father 1.6718726        0         0      2     0</span></span>
<span><span class="co">#&gt; 7 1.671873      1 1       2  child 1.6718726        0         0      3     1</span></span>
<span><span class="co">#&gt; 8 1.763022      1 1       2  child 1.6718726        0         0      4     0</span></span></code></pre></div>
<p>The random effects for these are specified from random effects with
design read from the random.design, using the rows (1,2), (3,4) and
(3,4), respecively, and with random effects that have variances given by
theta.des rows, 1,2, and 2 respectively in the three cases. For the
first pair (1,2), the random vectors and their variances are given by,
(mother, father) pair,</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">random.des</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="co">#&gt; [1] 1 0 1 0</span></span>
<span><span class="va">random.des</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0 1 1 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">theta.des</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    0</span></span>
<span><span class="co">#&gt; [2,]    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    1</span></span>
<span><span class="co">#&gt; [4,]    0    0</span></span></code></pre></div>
<p>thus sharing only the third random effect with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_e^2</annotation></semantics></math>
and having two non-shared random effects with variances
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mi>g</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_g^2</annotation></semantics></math>,
and finally a last 4th random effect with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
that thus could have been omitted.</p>
<p>The length of all rows of theta.des are the maximum number of random
effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>×</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math>
the number of parameters. These two numbers are given in the call. In
this case 4
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>×</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math>
2. So theta.des has rows of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>8</mn><annotation encoding="application/x-tex">8</annotation></semantics></math>,
possibly including some 0’s for rows not relevant due to fewer random
effects, as is the case here for pairs that do not share genetic
effects.</p>
<p>Now considering the parent and their child, they are thus sharing the
first random effect with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn><msubsup><mi>σ</mi><mi>g</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">0.5 \sigma_g^2</annotation></semantics></math>
then there are two non-shared random effects with variances
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn><msubsup><mi>σ</mi><mi>g</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">0.5 \sigma_g^2</annotation></semantics></math>,
and finally a shared environment with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_e^2</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataid</span><span class="op">)</span></span>
<span><span class="co">#&gt;       time status x cluster   type   mintime lefttime truncated number child</span></span>
<span><span class="co">#&gt; 2 1.643505      1 1       1 father 0.4139376        0         0      2     0</span></span>
<span><span class="co">#&gt; 4 1.107912      1 1       1  child 0.4139376        0         0      4     0</span></span>
<span><span class="co">#&gt; 5 3.000000      0 0       2 mother 1.6718726        0         0      1     0</span></span>
<span><span class="co">#&gt; 6 2.008557      1 1       2 father 1.6718726        0         0      2     0</span></span>
<span><span class="co">#&gt; 7 1.671873      1 1       2  child 1.6718726        0         0      3     1</span></span>
<span><span class="co">#&gt; 8 1.763022      1 1       2  child 1.6718726        0         0      4     0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">theta.des</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.5    0</span></span>
<span><span class="co">#&gt; [2,]  0.5    0</span></span>
<span><span class="co">#&gt; [3,]  0.5    0</span></span>
<span><span class="co">#&gt; [4,]  0.0    1</span></span>
<span><span class="va">random.des</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span></span>
<span><span class="co">#&gt; [1] 1 1 0 1</span></span>
<span><span class="va">random.des</span><span class="op">[</span><span class="fl">4</span>,<span class="op">]</span></span>
<span><span class="co">#&gt; [1] 1 0 1 1</span></span></code></pre></div>
<p>And fitting again the same model as before</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsdid2</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/twostage.html" class="external-link">twostage</a></span><span class="op">(</span><span class="va">pa</span>,data<span class="op">=</span><span class="va">dataid</span>,clusters<span class="op">=</span><span class="va">dataid</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>       theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>,var.link<span class="op">=</span><span class="fl">0</span>,step<span class="op">=</span><span class="fl">1.0</span>,random.design<span class="op">=</span><span class="va">random.des</span>,</span>
<span>       baseline.iid<span class="op">=</span><span class="fl">0</span>, theta.des<span class="op">=</span><span class="va">theta.des</span>,pairs<span class="op">=</span><span class="va">pairs.new</span>,dim.theta<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsdid2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.        SE        z     P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 0.9237395 0.6040859 1.529153 0.1262266   0.3159445 0.14133553</span></span>
<span><span class="co">#&gt; dependence2 0.4087673 0.2590853 1.577732 0.1146271   0.1696998 0.08930652</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;      Estimate Std.Err    2.5%  97.5%  P-value</span></span>
<span><span class="co">#&gt; [1,]   0.6932  0.2487  0.2058 1.1807 0.005311</span></span>
<span><span class="co">#&gt; [2,]   0.3068  0.2487 -0.1807 0.7942 0.217376</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err   2.5% 97.5%  P-value</span></span>
<span><span class="co">#&gt; p1    1.333  0.4784 0.3949  2.27 0.005345</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span><span class="va">tsd</span><span class="op">$</span><span class="va">theta</span></span>
<span><span class="co">#&gt;           [,1]</span></span>
<span><span class="co">#&gt; [1,] 0.9237395</span></span>
<span><span class="co">#&gt; [2,] 0.4087673</span></span>
<span><span class="va">tsdid2</span><span class="op">$</span><span class="va">theta</span></span>
<span><span class="co">#&gt;           [,1]</span></span>
<span><span class="co">#&gt; [1,] 0.9237395</span></span>
<span><span class="co">#&gt; [2,] 0.4087673</span></span>
<span><span class="va">tsdid</span><span class="op">$</span><span class="va">theta</span></span>
<span><span class="co">#&gt;           [,1]</span></span>
<span><span class="co">#&gt; [1,] 0.9237395</span></span>
<span><span class="co">#&gt; [2,] 0.4087673</span></span></code></pre></div>
<p>Finally the same model structure can be setup based on a Kinship
coefficient.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kinship</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pair.types</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">kinship</span><span class="op">[</span><span class="va">pair.types</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">==</span><span class="st">"mother"</span> <span class="op">&amp;</span> <span class="va">pair.types</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="st">"father"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kinship</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 0.5 0.0 0.5 0.5 0.5 0.5 0.5 0.0 0.5 0.0</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">make.pairwise.design</a></span><span class="op">(</span><span class="va">pair.new</span>,<span class="va">kinship</span>,type<span class="op">=</span><span class="st">"ace"</span><span class="op">)</span> </span></code></pre></div>
<p>Same output as before</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsdid3</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/twostage.html" class="external-link">twostage</a></span><span class="op">(</span><span class="va">pa</span>,data<span class="op">=</span><span class="va">dataid</span>,clusters<span class="op">=</span><span class="va">dataid</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>   theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>,var.link<span class="op">=</span><span class="fl">0</span>,step<span class="op">=</span><span class="fl">1.0</span>,random.design<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">random.design</span>,</span>
<span>   baseline.iid<span class="op">=</span><span class="fl">0</span>,theta.des<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">theta.des</span>,pairs<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">new.pairs</span>,dim.theta<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsdid3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.        SE        z     P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 0.9237395 0.6040859 1.529153 0.1262266   0.3159445 0.14133553</span></span>
<span><span class="co">#&gt; dependence2 0.4087673 0.2590853 1.577732 0.1146271   0.1696998 0.08930652</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;      Estimate Std.Err    2.5%  97.5%  P-value</span></span>
<span><span class="co">#&gt; [1,]   0.6932  0.2487  0.2058 1.1807 0.005311</span></span>
<span><span class="co">#&gt; [2,]   0.3068  0.2487 -0.1807 0.7942 0.217376</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err   2.5% 97.5%  P-value</span></span>
<span><span class="co">#&gt; p1    1.333  0.4784 0.3949  2.27 0.005345</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span><span class="va">tsdid2</span><span class="op">$</span><span class="va">theta</span></span>
<span><span class="co">#&gt;           [,1]</span></span>
<span><span class="co">#&gt; [1,] 0.9237395</span></span>
<span><span class="co">#&gt; [2,] 0.4087673</span></span>
<span><span class="va">tsdid</span><span class="op">$</span><span class="va">theta</span></span>
<span><span class="co">#&gt;           [,1]</span></span>
<span><span class="co">#&gt; [1,] 0.9237395</span></span>
<span><span class="co">#&gt; [2,] 0.4087673</span></span></code></pre></div>
<p>Now fitting the AE model without the “C” component for shared
environment:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outae</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">make.pairwise.design</a></span><span class="op">(</span><span class="va">pair.new</span>,<span class="va">kinship</span>,type<span class="op">=</span><span class="st">"ae"</span><span class="op">)</span> </span>
<span><span class="va">tsdid4</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/twostage.html" class="external-link">twostage</a></span><span class="op">(</span><span class="va">pa</span>,data<span class="op">=</span><span class="va">dataid</span>,clusters<span class="op">=</span><span class="va">dataid</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>   theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>,var.link<span class="op">=</span><span class="fl">0</span>,random.design<span class="op">=</span><span class="va">outae</span><span class="op">$</span><span class="va">random.design</span>,</span>
<span>   baseline.iid<span class="op">=</span><span class="fl">0</span>,theta.des<span class="op">=</span><span class="va">outae</span><span class="op">$</span><span class="va">theta.des</span>,pairs<span class="op">=</span><span class="va">outae</span><span class="op">$</span><span class="va">new.pairs</span>,dim.theta<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsdid4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                Coef.        SE        z        P-val Kendall tau        SE</span></span>
<span><span class="co">#&gt; dependence1 1.932485 0.5702673 3.388735 0.0007021583   0.4914157 0.0737521</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $h</span></span>
<span><span class="co">#&gt;      Estimate Std.Err 2.5% 97.5% P-value</span></span>
<span><span class="co">#&gt; [1,]        1       0    1     1       0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vare</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vartot</span></span>
<span><span class="co">#&gt;    Estimate Std.Err   2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; p1    1.932  0.5703 0.8148  3.05 0.0007022</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pairwise-dependence-modelling">Pairwise dependence modelling<a class="anchor" aria-label="anchor" href="#pairwise-dependence-modelling"></a>
</h3>
<p>We now illustate how to estimate all pairwise associations between
different family-members using the twostage function. They key is
specify the pairs for the composite likelihood directly and then the
associated design-matrix directly. This needs to be done looking at both
subjects in the pairs, and the design therefore follows the pairs and is
a matrix where its row is given as the third column in the pairs
argument.</p>
<p>First we get the pairs to be considered</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/mets/" class="external-link">mets</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">simClaytonOakes.family.ace</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;        time status x cluster   type   mintime lefttime truncated</span></span>
<span><span class="co">#&gt; 1 0.4139376      1 0       1 mother 0.4139376        0         0</span></span>
<span><span class="co">#&gt; 2 1.6435053      1 1       1 father 0.4139376        0         0</span></span>
<span><span class="co">#&gt; 3 1.2485275      1 0       1  child 0.4139376        0         0</span></span>
<span><span class="co">#&gt; 4 1.1079118      1 1       1  child 0.4139376        0         0</span></span>
<span><span class="co">#&gt; 5 3.0000000      0 0       2 mother 1.6718726        0         0</span></span>
<span><span class="co">#&gt; 6 2.0085566      1 1       2 father 1.6718726        0         0</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">child</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">number</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/familycluster.index.html">familycluster.index</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mm</span><span class="op">$</span><span class="va">familypairindex</span>,n<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1 2 1 3 1 4 2 3 2 4 3 4 5 6 5 7 5 8 6 7</span></span>
<span><span class="va">pairs</span> <span class="op">&lt;-</span> <span class="va">mm</span><span class="op">$</span><span class="va">pairs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1200    2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pairs</span>,<span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt;  [1,]    1    2</span></span>
<span><span class="co">#&gt;  [2,]    1    3</span></span>
<span><span class="co">#&gt;  [3,]    1    4</span></span>
<span><span class="co">#&gt;  [4,]    2    3</span></span>
<span><span class="co">#&gt;  [5,]    2    4</span></span>
<span><span class="co">#&gt;  [6,]    3    4</span></span>
<span><span class="co">#&gt;  [7,]    5    6</span></span>
<span><span class="co">#&gt;  [8,]    5    7</span></span>
<span><span class="co">#&gt;  [9,]    5    8</span></span>
<span><span class="co">#&gt; [10,]    6    7</span></span>
<span><span class="co">#&gt; [11,]    6    8</span></span>
<span><span class="co">#&gt; [12,]    7    8</span></span></code></pre></div>
<p>Now we construct the design matrix related to the pairs</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">dtypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span> <span class="va">data</span><span class="op">[</span><span class="va">pairs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="st">"type"</span><span class="op">]</span>, <span class="va">data</span><span class="op">[</span><span class="va">pairs</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="st">"type"</span><span class="op">]</span><span class="op">)</span></span>
<span> <span class="va">dtypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">dtypes</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dtypes</span><span class="op">)</span></span>
<span><span class="co">#&gt; dtypes</span></span>
<span><span class="co">#&gt;   child.child  father.child  mother.child mother.father </span></span>
<span><span class="co">#&gt;           200           400           400           200</span></span>
<span> <span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dtypes</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span></span>
<span><span class="co">#&gt;   factor(dtypes)child.child factor(dtypes)father.child</span></span>
<span><span class="co">#&gt; 1                         0                          0</span></span>
<span><span class="co">#&gt; 2                         0                          0</span></span>
<span><span class="co">#&gt; 3                         0                          0</span></span>
<span><span class="co">#&gt; 4                         0                          1</span></span>
<span><span class="co">#&gt; 5                         0                          1</span></span>
<span><span class="co">#&gt; 6                         1                          0</span></span>
<span><span class="co">#&gt;   factor(dtypes)mother.child factor(dtypes)mother.father</span></span>
<span><span class="co">#&gt; 1                          0                           1</span></span>
<span><span class="co">#&gt; 2                          1                           0</span></span>
<span><span class="co">#&gt; 3                          1                           0</span></span>
<span><span class="co">#&gt; 4                          0                           0</span></span>
<span><span class="co">#&gt; 5                          0                           0</span></span>
<span><span class="co">#&gt; 6                          0                           0</span></span></code></pre></div>
<p>Then we fit the model:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span>,<span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tsp</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://kkholst.github.io/lava/reference/twostage.html" class="external-link">twostage</a></span><span class="op">(</span><span class="va">pa</span>,data<span class="op">=</span><span class="va">data</span>,theta.des<span class="op">=</span><span class="va">dm</span>,pairs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pairs</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span><span class="op">)</span>,se.clusters<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">clust</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tsp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                               log-Coef.        SE           z       P-val</span></span>
<span><span class="co">#&gt; factor(dtypes)child.child    0.01865073 0.2087690  0.08933666 0.928814359</span></span>
<span><span class="co">#&gt; factor(dtypes)father.child  -0.29471237 0.2167688 -1.35956992 0.173966062</span></span>
<span><span class="co">#&gt; factor(dtypes)mother.child  -0.24879997 0.1949185 -1.27643105 0.201803188</span></span>
<span><span class="co">#&gt; factor(dtypes)mother.father -1.42550068 0.5159729 -2.76274312 0.005731786</span></span>
<span><span class="co">#&gt;                             Kendall tau         SE</span></span>
<span><span class="co">#&gt; factor(dtypes)child.child     0.3374907 0.04667882</span></span>
<span><span class="co">#&gt; factor(dtypes)father.child    0.2713351 0.04285787</span></span>
<span><span class="co">#&gt; factor(dtypes)mother.child    0.2805072 0.03933901</span></span>
<span><span class="co">#&gt; factor(dtypes)mother.father   0.1072975 0.04942234</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vargam</span></span>
<span><span class="co">#&gt;             Estimate Std.Err      2.5%  97.5%   P-value</span></span>
<span><span class="co">#&gt; dependence1   1.0188  0.2127  0.601943 1.4357 1.668e-06</span></span>
<span><span class="co">#&gt; dependence2   0.7447  0.1614  0.428334 1.0612 3.965e-06</span></span>
<span><span class="co">#&gt; dependence3   0.7797  0.1520  0.481851 1.0776 2.892e-07</span></span>
<span><span class="co">#&gt; dependence4   0.2404  0.1240 -0.002714 0.4835 5.261e-02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>We note that mother-father have the smallest correlation since they
only share the environmental random effect, whereas other pairs have a
similar correlation (in fact the same due to the way the data was
simulated) consisting of half the genetic effect and the environmental
effect that was also shared.</p>
</div>
</div>
<div class="section level2">
<h2 id="univariate-plackett-model-twostage-models">Univariate plackett model twostage models<a class="anchor" aria-label="anchor" href="#univariate-plackett-model-twostage-models"></a>
</h2>
<p>The copula known as the Plackett distribution, see , is on the form
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mfrac><mrow><mi>S</mi><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>S</mi><mn>2</mn></msup><mo>−</mo><mn>4</mn><mi>u</mi><mi>v</mi><mi>θ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> if </mtext><mspace width="0.333em"></mspace></mrow><mi>θ</mi><mo>≠</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>u</mi><mi>v</mi></mtd><mtd columnalign="left" style="text-align: left"><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> if </mtext><mspace width="0.333em"></mspace></mrow><mi>θ</mi><mo>=</mo><mn>1</mn></mtd></mtr></mtable></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  C(u,v; \theta) =
  \begin{cases}
    \frac{ S - (S^2 - 4 u v \theta (\theta-a))}{2 (\theta -1)} &amp; \mbox{ if } \theta \ne 1 \\
    u v &amp; \mbox{ if } \theta = 1
  \end{cases}
\end{align}</annotation></semantics></math> with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>1</mn><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>+</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S=1+(\theta-1) (u + v)</annotation></semantics></math>.
With marginals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mi>i</mi></msub><annotation encoding="application/x-tex">S_i</annotation></semantics></math>
we now define the bivariate survival function as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>u</mi><mn>1</mn></msub><mo>,</mo><msub><mi>u</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>S</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">C(u_1,u_2)=H(S_1(t_1),S_2(t_2))</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub><mo>=</mo><msub><mi>S</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">u_i=S_i(t_i)</annotation></semantics></math>.</p>
<p>The dependence parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
has the nice interpretation that the it is equivalent to the odds-ratio
of all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math>
tables for surviving past any cut of the plane
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo>,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(t_1,t_2)</annotation></semantics></math>,
that is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>&gt;</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mn>2</mn></msub><mo>&gt;</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mn>2</mn></msub><mo>&gt;</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>&gt;</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mn>2</mn></msub><mo>≤</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mn>2</mn></msub><mo>≤</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\theta = \frac{ P(T_1 &gt; t_1 | T_2 &gt;t_2) P(T_1 \leq t_1 | T_2&gt;t_2) }{P(T_1 &gt; t_1 | T_2 \leq t_2) P(T_1 \leq t_1 | T_2 \leq t_2 ) }.
</annotation></semantics></math></p>
<p>One additional nice feature of the odds-ratio measure it that it is
directly linked to the Spearman correlation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>,
that can be computed as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>θ</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi>θ</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mo>−</mo><mfrac><mrow><mn>2</mn><mi>θ</mi></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  \frac{\theta+1}{\theta -1} - \frac{2 \theta}{(\theta-1)^2} \log(\theta)
\end{align}</annotation></semantics></math> when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>≠</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\theta \ne 1</annotation></semantics></math>,
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\theta=1</annotation></semantics></math>
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho=0</annotation></semantics></math>.</p>
<p>This model has a more free parameter than the Clayton-Oakes
model.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kkholst.github.io/mets/" class="external-link">mets</a></span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span></span>
<span> </span>
<span> <span class="co"># Marginal Cox model  with treat as covariate</span></span>
<span> <span class="va">margph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">treat</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">diabetes</span><span class="op">)</span></span>
<span> <span class="co"># Clayton-Oakes, MLE </span></span>
<span> <span class="va">fitco1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/twostageMLE.html">twostageMLE</a></span><span class="op">(</span><span class="va">margph</span>,data<span class="op">=</span><span class="va">diabetes</span>,theta<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitco1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                 Coef.        SE       z       P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 0.9526614 0.3543033 2.68883 0.007170289    0.322645 0.08127892</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span> </span>
<span> <span class="co"># Plackett model</span></span>
<span> <span class="va">mph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">treat</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">diabetes</span><span class="op">)</span></span>
<span> <span class="va">fitp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">mph</span>,data<span class="op">=</span><span class="va">diabetes</span>,theta<span class="op">=</span><span class="fl">3.0</span>,</span>
<span>                clusters<span class="op">=</span><span class="va">diabetes</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">1</span>,model<span class="op">=</span><span class="st">"plackett"</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;             log-Coef.        SE        z        P-val Spearman Corr.         SE</span></span>
<span><span class="co">#&gt; dependence1   1.14188 0.3026537 3.772891 0.0001613666      0.3648216 0.08869229</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $or</span></span>
<span><span class="co">#&gt;             Estimate Std.Err  2.5% 97.5%   P-value</span></span>
<span><span class="co">#&gt; dependence1    3.133  0.9481 1.274 4.991 0.0009528</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "plackett"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span> </span>
<span> <span class="co"># without covariates but with stratafied </span></span>
<span> <span class="va">marg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phreg.html">phreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">treat</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,data<span class="op">=</span><span class="va">diabetes</span><span class="op">)</span></span>
<span> <span class="va">fitpa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">marg</span>,data<span class="op">=</span><span class="va">diabetes</span>,theta<span class="op">=</span><span class="fl">1.0</span>,</span>
<span>                 clusters<span class="op">=</span><span class="va">diabetes</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitpa</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;               log-Coef.        SE          z     P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 -0.05684062 0.3721207 -0.1527478 0.8785971    0.320824 0.08108359</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vargam</span></span>
<span><span class="co">#&gt;             Estimate Std.Err   2.5% 97.5%  P-value</span></span>
<span><span class="co">#&gt; dependence1   0.9447  0.3516 0.2557 1.634 0.007203</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span>
<span> </span>
<span> <span class="va">fitcoa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">marg</span>,data<span class="op">=</span><span class="va">diabetes</span>,theta<span class="op">=</span><span class="fl">1.0</span>,clusters<span class="op">=</span><span class="va">diabetes</span><span class="op">$</span><span class="va">id</span>,</span>
<span>                  model<span class="op">=</span><span class="st">"clayton.oakes"</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitcoa</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Clayton-Oakes model</span></span>
<span><span class="co">#&gt; Variance of Gamma distributed random effects </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;               log-Coef.        SE          z     P-val Kendall tau         SE</span></span>
<span><span class="co">#&gt; dependence1 -0.05684062 0.3721207 -0.1527478 0.8785971    0.320824 0.08108359</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vargam</span></span>
<span><span class="co">#&gt;             Estimate Std.Err   2.5% 97.5%  P-value</span></span>
<span><span class="co">#&gt; dependence1   0.9447  0.3516 0.2557 1.634 0.007203</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "clayton.oakes"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<p>With a regression design</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">adult</span><span class="op">)</span>,<span class="va">diabetes</span><span class="op">)</span></span>
<span> <span class="va">fitp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/survival.twostage.html">survival.twostage</a></span><span class="op">(</span><span class="va">mph</span>,data<span class="op">=</span><span class="va">diabetes</span>,theta<span class="op">=</span><span class="fl">3.0</span>,Nit<span class="op">=</span><span class="fl">40</span>,</span>
<span>                clusters<span class="op">=</span><span class="va">diabetes</span><span class="op">$</span><span class="va">id</span>,var.link<span class="op">=</span><span class="fl">1</span>,model<span class="op">=</span><span class="st">"plackett"</span>,</span>
<span>        theta.des<span class="op">=</span><span class="va">mm</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dependence parameter for Odds-Ratio (Plackett) model </span></span>
<span><span class="co">#&gt; With log-link</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;                log-Coef.        SE        z       P-val Spearman Corr.</span></span>
<span><span class="co">#&gt; factor(adult)1  1.098332 0.3630524 3.025272 0.002484097      0.3519987</span></span>
<span><span class="co">#&gt; factor(adult)2  1.231962 0.5233261 2.354100 0.018567607      0.3909504</span></span>
<span><span class="co">#&gt;                       SE</span></span>
<span><span class="co">#&gt; factor(adult)1 0.1074107</span></span>
<span><span class="co">#&gt; factor(adult)2 0.1501987</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $or</span></span>
<span><span class="co">#&gt;             Estimate Std.Err    2.5% 97.5% P-value</span></span>
<span><span class="co">#&gt; dependence1    2.999   1.089  0.8650 5.133 0.00588</span></span>
<span><span class="co">#&gt; dependence2    3.428   1.794 -0.0881 6.944 0.05602</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "plackett"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "summary.mets.twostage"</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># Piecewise constant cross hazards ratio modelling</span></span>
<span></span>
<span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="../reference/simClaytonOakes.html">simClaytonOakes</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">2</span>,<span class="fl">0.5</span>,<span class="fl">0</span>,stoptime<span class="op">=</span><span class="fl">2</span>,left<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,<span class="op">!</span><span class="va">truncated</span><span class="op">)</span></span>
<span> <span class="va">udp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/internal.html">piecewise.twostage</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">2</span><span class="op">)</span>,data<span class="op">=</span><span class="va">d</span>,id<span class="op">=</span><span class="st">"cluster"</span>,timevar<span class="op">=</span><span class="st">"time"</span>,</span>
<span>                           status<span class="op">=</span><span class="st">"status"</span>,model<span class="op">=</span><span class="st">"plackett"</span>,silent<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; Data-set  1 out of  4</span></span>
<span><span class="co">#&gt;   Number of joint events: 254 of  1000</span></span>
<span><span class="co">#&gt; Data-set  2 out of  4</span></span>
<span><span class="co">#&gt;   Number of joint events: 106 of  609</span></span>
<span><span class="co">#&gt; Data-set  3 out of  4</span></span>
<span><span class="co">#&gt;   Number of joint events: 136 of  640</span></span>
<span><span class="co">#&gt; Data-set  4 out of  4</span></span>
<span><span class="co">#&gt;   Number of joint events: 328 of  503</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">udp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; Dependence parameter for Plackett model </span></span>
<span><span class="co">#&gt; log-coefficient for dependence parameter (SE) </span></span>
<span><span class="co">#&gt;          0 - 0.5        0.5 - 2      </span></span>
<span><span class="co">#&gt; 0 - 0.5  1.794 (0.106)  1.888 (0.139)</span></span>
<span><span class="co">#&gt; 0.5 - 2  1.582 (0.141)  2.18  (0.109)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Spearman Correlation (SE) </span></span>
<span><span class="co">#&gt;          0 - 0.5        0.5 - 2      </span></span>
<span><span class="co">#&gt; 0 - 0.5  0.54  (0.026)  0.563 (0.033)</span></span>
<span><span class="co">#&gt; 0.5 - 2  0.487 (0.037)  0.628 (0.023)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sessioninfo">SessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] mets_1.3.9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] cli_3.6.5              knitr_1.51             rlang_1.1.7           </span></span>
<span><span class="co">#&gt;  [4] xfun_0.55              textshaping_1.0.4      jsonlite_2.0.0        </span></span>
<span><span class="co">#&gt;  [7] listenv_0.10.0         future.apply_1.20.1    lava_1.8.2            </span></span>
<span><span class="co">#&gt; [10] htmltools_0.5.9        ragg_1.5.0             sass_0.4.10           </span></span>
<span><span class="co">#&gt; [13] rmarkdown_2.30         grid_4.5.2             evaluate_1.0.5        </span></span>
<span><span class="co">#&gt; [16] jquerylib_0.1.4        fastmap_1.2.0          numDeriv_2016.8-1.1   </span></span>
<span><span class="co">#&gt; [19] yaml_2.3.12            mvtnorm_1.3-3          lifecycle_1.0.5       </span></span>
<span><span class="co">#&gt; [22] timereg_2.0.7          compiler_4.5.2         codetools_0.2-20      </span></span>
<span><span class="co">#&gt; [25] fs_1.6.6               htmlwidgets_1.6.4      Rcpp_1.1.1            </span></span>
<span><span class="co">#&gt; [28] future_1.68.0          lattice_0.22-7         systemfonts_1.3.1     </span></span>
<span><span class="co">#&gt; [31] digest_0.6.39          R6_2.6.1               parallelly_1.46.1     </span></span>
<span><span class="co">#&gt; [34] parallel_4.5.2         splines_4.5.2          Matrix_1.7-4          </span></span>
<span><span class="co">#&gt; [37] bslib_0.9.0            tools_4.5.2            RcppArmadillo_15.2.3-1</span></span>
<span><span class="co">#&gt; [40] globals_0.18.0         survival_3.8-3         pkgdown_2.2.0         </span></span>
<span><span class="co">#&gt; [43] cachem_1.1.0           desc_1.4.3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klaus K. Holst, Thomas Scheike.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
